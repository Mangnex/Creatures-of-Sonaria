!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Eventics=e()}}(function(){return function a(o,s,d){function l(t,e){if(!s[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[t]={exports:{}};o[t][0].call(r.exports,function(e){return l(o[t][1][e]||e)},r,r.exports,a,o,s,d)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<d.length;e++)l(d[e]);return l}({1:[function(e,t,n){t.exports=function(n){var r,a=["ironBeastEventicsProvider"],o=[],s={},d={},i=this,l=[],e=(n=n||1,"undefined"!=typeof jQuery?jQuery:{}),t=void 0!==window.angular?window.angular:{};function c(e){for(var t=o.length,n=0;n<t;n++)e(o[n])}function u(e){i.extend(d||{},e)}return i.extend=e.extend||t.extend||function(){for(var e,t,n=arguments.length,i=1,r=arguments[0]||{};i<n;i++)if(null!=(e=arguments[i]))for(t in e)void 0!==e[t]&&(r[t]=e[t]);return r},i.trackEvent=function(t,n,i){t&&(i=extend(i||{},d),r?c(function(e){e.trackEvent(t,n,i)}):l.push({eName:t,label:n,data:i,eType:"event"}))},i.trackTiming=function(t,n,i){t&&0<=parseInt(n)&&(i=extend(i||{},d),r?c(function(e){e.trackTiming(t,n,i)}):l.push({eName:t,time:n,data:i,eType:"timing"}))},{setProvidersHandlers:function(e){if(e){"string"==typeof e&&(e=[e]),a=[];for(var t=e.length,n=0;n<t;n++)a.push(e[n])}},setProvidersConfig:function(e){s=e},init:function(e){r||(e&&u(e),function(){o=[];for(var e=a.length,t=0;t<e;t++){var n=a[t];if("function"==typeof window[n]){var i=new window[n];i.init(s),o.push(i)}}}(),r=!0,function(){for(var e in l){var t=l[e]||{};"event"===t.eType?i.trackEvent(t.eName,t.label,t.data):"timing"===t.eType&&i.trackTiming(t.eName,t.time,t.data)}l=[]}())},updateBaseData:u,createEventic:function(e,t){return(e=e||{}).userChance=n,new f(i,e,t)},updateUserChance:function(e){n=e}}};var f=e("./eventicsHelper.js");window.ironBeastEventicsProvider=e("./providers/ironBeastEventicsProvider.js"),window.QAEventicsProvider=e("./providers/QAEventicsProvider.js"),window.KuduEventicsProvider=e("./providers/KuduEventicsProvider.js")},{"./eventicsHelper.js":2,"./providers/KuduEventicsProvider.js":3,"./providers/QAEventicsProvider.js":4,"./providers/ironBeastEventicsProvider.js":5}],2:[function(e,t,n){t.exports=function(e,t,a){var n=void 0!==(t=t||{}).productChance?t.productChance:1,i=void 0!==t.userChance?t.userChance:1,s=e||{},d=t.baseData||{},l={},c=s.extend,r={};function u(e){return e&&e.name&&e.id}return r.trackEvent=function(e,t,n){if(!u(e)||a.isEventDisabled(e))return!1;var i=e.name,r=e.id;n||(n={}),n.eventId=r,n=c({},d,n||{}),s.trackEvent(i,t,n)},r.trackTimingStart=function(e,t){if(!u(e))return!1;var n=e.name;return t=t||Date.now(),l[n]=t,!0},r.trackTimingStop=function(e,t){if(!u(e))return!1;var n,i,r=e.name;if(t||(t={}),t.eventId=e.id,t&&t.timeStamp?(i=t.timeStamp,delete t.timeStamp):i=Date.now(),t&&t.eNameStart&&t.eNameStart.name?(n=l[t.eNameStart.name],delete t.eNameStart):l[r]&&(n=l[r],l[r]=null),n){var a=i-n,o=c({},d);return t=c(o,t||{}),s.trackTiming(r,a,t),!0}},r.updateBaseData=function(e){for(var t in e)d[t]=e[t];return!0},r.resetBaseData=function(e){for(var t=0;t<e.length;t++)r.unsetParamFromBaseData(e[t])},r.unsetParamFromBaseData=function(e){d.hasOwnProperty(e)&&delete d[e]},r.incrementSessionNumber=function(){return d.sessionDepth?d.sessionDepth++:d.sessionDepth=1,!0},0<i&&i<=n?r:function(){var e={};for(var t in r)"function"==typeof r[t]&&(e[t]=function(){});return e}()}},{}],3:[function(e,t,n){t.exports=function(){var n,i,r="https://logs.ironsrc.mobi/logs",a={table:"supersonic.adunitanalytics.ad_unit_events"},o=["generalmessage","emptyowreason","landingid","callfailreason","rvnomoreoffersreason"];function s(e,t){switch(e){case"landingid":t=parseInt(t);break;case"generalmessage":case"emptyowreason":t=n=void 0===(n=t)?"undefined":null===n?"null":n.toString()}var n;return t}function d(e){if(e){e=function(e){if(!e)return e;for(var t=Object.keys(e),n=t.length;n--;){var i=t[n],r=i.toLowerCase(),a=e[i];-1!==o.indexOf(r)&&(a=s(r,a)),e[r]=a,i!==r&&delete e[i]}return e}(e);var t={table:a.table,data:e};i(t)}}function t(e){var t=new XMLHttpRequest;t.open("POST",n,!0),t.onerror=function(){e&&0<=e.retry&&e.retry<2&&(e.retry++,i(e))},t.send(JSON.stringify(e))}function l(t){var n;try{n=btoa(JSON.stringify(t))}catch(e){t.data.applicationUserId="badName",t.data.userId="badName",t.data.eventName="errorEvent",n=btoa(JSON.stringify(t))}var e=r+"?data="+n,i=new XMLHttpRequest;i.open("GET",e,!0),i.send()}return{init:function(e){i=e&&"POST"===e.method?(n="https://postlog.supersonic.com/logs",t):(n=r,l)},trackEvent:function(e,t,n){if(e){if(t&&"object"==typeof t){var i=Object.keys(t)[0];i&&(n[i]=t[i])}n.eventName=e,d(n)}},trackTiming:function(e,t,n){e&&0<=parseInt(t)&&(n.eventName=e,n.timingValue=t,d(n))}}}},{}],4:[function(e,t,n){t.exports=function(){var i,r={};function a(e){if(e){r.data=e;var t=function e(t,n){var i=[];for(var r in t)if(t.hasOwnProperty(r)){var a=n?n+"["+r+"]":r,o=t[r];i.push("object"==typeof o?e(o,a):encodeURIComponent(a)+"="+encodeURIComponent(o))}return i.join("&")}(r);delete r.data,(n=i+"?"+t)&&((new Image).src=n)}var n}return{init:function(e){i="http://qa.eventics.qa"},trackEvent:function(e,t,n){if(e){if(t&&"object"==typeof t){var i=Object.keys(t)[0];i&&(n[i]=t[i])}n.eventName=e,a(n)}},trackTiming:function(e,t,n){e&&0<=parseInt(t)&&(n.eventName=e,n.timingValue=t,a(n))}}}},{}],5:[function(e,t,n){t.exports=function(){var i,r={table:"supersonic.adunitanalytics.ad_unit_events"};function a(e){if(e){var t;r.data=e;try{t=btoa(JSON.stringify(r))}catch(e){r.data.applicationUserId="badName",r.data.userId="badName",r.data.eventName="errorEvent",t=btoa(JSON.stringify(r))}delete r.data,(n=i+"?data="+t)&&((new Image).src=n)}var n}return{init:function(e){i=e.isSecured?"https://secure.ironbeast.io":"http://supersonic.ironbeast.io"},trackEvent:function(e,t,n){if(e){if(t&&"object"==typeof t){var i=Object.keys(t)[0];i&&(n[i]=t[i])}n.eventName=e,a(n)}},trackTiming:function(e,t,n){e&&0<=parseInt(t)&&(n.eventName=e,n.timingValue=t,a(n))}}}},{}]},{},[1])(1)}),function a(o,s,d){function l(t,e){if(!s[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[t]={exports:{}};o[t][0].call(r.exports,function(e){return l(o[t][1][e]||e)},r,r.exports,a,o,s,d)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<d.length;e++)l(d[e]);return l}({1:[function(e,t,n){t.exports=function(e){var t={v:1,controllerId:1,applicationKey:1,applicationUserId:0,debug:0,language:0,disableCache:0,applicationUserGender:0,applicationUserAgeGroup:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,att:0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,campaignId:0,customParams:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,appVersion:0,batteryLevel:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:0,timezoneOffset:0,itemSignature:0,showDeliveryLimitationsLog:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,mraid:0,numOfCampaigns:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,omidSupported:0,omidVersion:0,omidPartnerVersion:0,mediationType:0};return{init:function(){"android"===e.getConfig().mobileSDKSettings.deviceOs&&(t.deviceApiLevel=0)},getCommonRequiredData:function(){return t}}}},{}],2:[function(e,t,n){"use strict";n.__esModule=!0;var i=function(){function e(e,t,n,i,r,a){this.core=e,this.controller=t,this.constants=n,this.jQuery=i,this.dsConfig=r,this.isBidding=a}return e.prototype.parse=function(e){var t=e.seatbid.ext;return this.extendControllerConfigSettings(t),this.extendDSConfigSettings(t),this.extendNetworkConfigSettings(t),this.extendMicroJobGeneralSettings(t),this.extendMicroJobLandingIDSettings(t),this.extendBannerCacheSettings(t),t},e.prototype.extendControllerConfigSettings=function(e){e.shouldStartMuted=this.controller.AdUtils.isCampaignShouldStartMuted(this.controller.getConfig().controllerConfig,this.dsConfig.productType);var t=this.controller.AdUtils.delayUntilCloseVisible(this.controller.getConfig().controllerConfig,this.dsConfig.productType),n=this.controller.AdUtils.delayUntilTimerVisible(this.controller.getConfig().controllerConfig,this.dsConfig.productType),i=this.controller.AdUtils.endScreenSettings(this.controller.getConfig().controllerConfig,this.dsConfig.productType);this.core.Utils.isDefined(t)&&(e.DEC=t),this.core.Utils.isDefined(n)&&(e.DECT=n),this.core.Utils.isDefined(i)&&this.jQuery.extend(e,{"2EC":i})},e.prototype.extendDSConfigSettings=function(e){this.jQuery.extend(!0,e,this.dsConfig.overrideFeedSettings)},e.prototype.extendNetworkConfigSettings=function(e){this.jQuery.extend(!0,e,this.controller.SupplyConfigurations.getFeaturesConfigByAdSource(e.adSource))},e.prototype.extendMicroJobGeneralSettings=function(e){var t=this.controller.getApplicationExternalConfig().getGeneralConfig();t&&t.hasOwnProperty("sOE")&&this.jQuery.extend(e,{sOE:t.sOE})},e.prototype.extendMicroJobLandingIDSettings=function(e){this.jQuery.extend(!0,e,this.controller.getApplicationExternalConfig().getABTestConfiguration(this.controller[this.dsConfig.productType].getProductType(),e.landingId))},e.prototype.extendBannerCacheSettings=function(e){this.isBidding||this.dsConfig.productType!==this.constants.BN||(e.numOfBannersToInitSuccess=0,e.numOfBannersToCache=0)},e}();t.exports=i},{}],3:[function(e,t,n){"use strict";n.__esModule=!0,t.exports=function(d,l,c){var e=l.appInfo.orientation,u=e.portrait,f=e.landscape,g={android:function(e,t,n){return e.ext.forceOrientation.toLowerCase()},ios:function(e,t,n){return i=e,r=t.getABTestConfiguration(i.productType,i.ext.landingId).ignoreAppOrientationInForceCampaigns||!1,d.log("shouldIgnoreAppOrientationInForcedCampaign: "+Boolean(r),d.LogLevels.verbose),!r&&c.getOrientation()&&c.isAppOrientation(e.ext.forceOrientation.toLowerCase())?(d.log("forced campaign | application is locked on the same orientation - sending  default: "+n,d.LogLevels.verbose),n):e.ext.forceOrientation.toLowerCase();var i,r}};function p(t){return t&&t.controllerConfig&&["499b4845","406ff65d"].some(function(e){return e===t.controllerConfig.applicationKey})}return{getAdDisplayOrientation:function(e,t,n){if(n){var i,r,a,o="undefined",s=l.defaultOrientation[n.productType];return p(e)&&n.settings&&(n.settings.orientation=u),r=e,(a=n).ext&&a.ext.forceOrientation&&(!p(r)||p(r)&&a.ext.forceOrientation.toLowerCase()===f)?o=s=g[e.mobileSDKSettings.deviceOs](n,t,s):s=(i=n).settings&&i.settings.orientation?n.settings.orientation:c.getOrientation(),"string"==typeof s&&s.toLowerCase()===l.appInfo.orientation.none&&(s=l.defaultOrientation[n.productType]),d.log("adOrientation | forceByCampaign:"+o+" , forceBySession:"+n.settings.orientation+" ,forceByNative:"+c.getOrientation()+" , ChosenOrientation:"+s,d.LogLevels.info),s?s.toLowerCase():""}}}}},{}],4:[function(e,t,n){"use strict";n.__esModule=!0;var x=e("./Constants");t.exports=function(o,n,r){var s="MRAID",d="VAST",l="EXTERNAL",c="INTERNAL",u="AT_MP",f="PLAYABLE",g="IMAGE_INTERSTITIAL",p="STATIC_BANNER",v="OTHER",i={};function a(e){if(e)return e.id||b(e,m(e)||"",h(e)||""),e.id&&e.id.toString()}function m(e){if(e){var t=e.crid||e.bannerId||e.bannerID;return t&&t.toString()}}function h(e){if(e)return(e.creativeId||"0").toString()}function b(e,t,n){e.id=t+"_"+n}function S(e,t){if(!e)return"";var n=y(e,t);return i[n]||i.other}i[s]="MR",i[d]="VA",i[l]="EX",i[c]="AT",i[u]="AT_MP",i[f]="PL",i[g]="IM",i[p]="SB",i[v]="OT";var y=function(e,t){var n,i,r=e&&e.ext,a="";return r?a=(i=r)&&i.type&&"imageInterstitial"===i.type?g:o.VastUtils.isVastCampaign(e)?d:A(r)?f:C(r)?s:D(r)?u:I(r)?l:w(r)?c:(n=r)&&n.type&&"staticBanner"===n.type?p:v:a};function A(e){return e&&e.type&&"playableAd"===e.type}function C(e){return e&&e.type&&"MRAID"===e.type}function D(e){return e&&e.type&&"AT_MP"===e.type}function I(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-external-video-player"===e.videoData.videoType}function w(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-internal-video-player"===e.videoData.videoType}function P(e){var t={};return t.id=a(e),t.title="",t.credits=e.credits,t.staticContent=o.AdAssets.extractStaticFiles(e,T(e)),t.lastUpdateTime=e.lastUpdateTime,t.inventoryIndex=e.inventoryIndex,t.isCacheable=e.isCacheable=0<t.staticContent.length,t}function T(e){var t=e.ext;return A(t)&&t.videoData&&t.videoData.videoSource&&t.videoData.videoSource.html&&-1<t.videoData.videoSource.html.indexOf(o.AdAssets.getPlayableCacheFlag())}function O(e){var t=n.getApiData({deviceOs:1}).deviceOs;e.standaloneView=t===x.deviceOs.ios,e.translucentView=t===x.deviceOs.android}function F(e,t){var n={};return t&&t.ext&&t.ext.opportunityID&&(n.opportunityId=t.ext.opportunityID),e&&e.requestID&&(n.requestId=e.requestID),n}return{getAdId:a,getAdIdsOfAds:function(e){if(!e||!Array.isArray(e))return[];for(var t=[],n=0;n<e.length;n++)t.push(a(e[n]));return t},generateUniqueAdId:function(e){return e.productType+"."+e.demandSourceName+"."+a(e)+"."+Date.now()},getBannerId:m,getCreativeId:h,getAdType:S,formatParamsToAdId:function(e){if(e){if(!e.id){var t=m(e);t&&b(e,t,x.legacyCreativeId.toString())}return e}},formatAdsForPrecache:function(e){return e.map(function(e,t){return P(e)}).filter(function(e){return e.isCacheable})},isCacheableAd:function(e){return e&&e.hasOwnProperty("isCacheable")},getStoreAppId:function(e){if(e.ext.clickTags.storeAppId)return e.ext.clickTags.storeAppId;var t,n,i="",r=e.ext.clickTags.clickURL;return r&&(t=r.match(/id\d+/g),n="",t&&(t=(t=t[t.length-1]).match(/\d+/g),n=Array.isArray(t)?t[0]:""),i=n||"")&&(e.ext.clickTags.storeAppId=i),i},formatVastAdForPrecache:function(e,t){var n;return(n=P(e)).preProcessing=t,n.isCacheable=e.isCacheable=!0,n},setViewType:function(e,t,n){var i;t&&t.ext&&(i=t.ext)&&i.layoutData&&(i.layoutData.portrait&&i.layoutData.portrait.frameUrl&&i.layoutData.portrait.closeButtonUrl||i.layoutData.landscape&&i.layoutData.landscape.frameUrl&&i.layoutData.landscape.closeButtonUrl)&&O(e),n&&(e.viewType=n)},removeViewTypeFromSetting:function(e){e.viewType&&delete e.viewType},getViewType:function(e){return e&&e.settings?e.settings.viewType:null},getRequestOppParams:F,updateEventWithAdParams:function(e,t,n){return t&&(r.extend(n,F(e,t)),n.bannerId=m(t),n.creativeId=h(t),n.campaignType=S(t,e)),n},isPlayableCampaign:A,isPlayablePrecachedAd:T,isInternalCampaign:w,isAppTrailerMarketPlaceCampaign:D,isMRAIDCampaign:C,isExternalCampaign:I,isCampaignShouldStartMuted:function(e,t){return!(!e||!e[x.sspProductNames[t]]||!0!==e[x.sspProductNames[t]].startVideoOnMute)},delayUntilCloseVisible:function(e,t){if(e&&e[x.sspProductNames[t]]&&o.Utils.isDefined(e[x.sspProductNames[t]].DEC))return e[x.sspProductNames[t]].DEC},endScreenSettings:function(e,t){var n;return null===(n=null==e?void 0:e[x.sspProductNames[t]])||void 0===n?void 0:n["2EC"]},delayUntilTimerVisible:function(e,t){if(e&&e[x.sspProductNames[t]]&&o.Utils.isDefined(e[x.sspProductNames[t]].DECT))return e[x.sspProductNames[t]].DECT},extendAdObjectWithConfig:function(e,t,n,i){t.settings=r.extend(!0,t.settings,i),t.ext&&t.ext.forceOrientation&&(t.settings.orientation=t.ext.forceOrientation.toLowerCase()),r.extend(!0,t,n,{url:e})},extendSettingsWithStandaloneViewSupport:O,extractEventData:function(e){return e&&e.ext?{requestId:e.requestID,opportunityId:e.ext.opportunityID,bannerId:m(e),creativeId:h(e),campaignType:S(e,e.ext),rvPlayMethod:e.displayMode,displayStrategy:e.displayStrategy,dynamicDemandSource:e.ext.dynamicDemandSource,auctionId:e.ext.auctionId,adunitVersion:e.adunitVersion,adunitbn:e.adunitbn,isBiddingInstance:e.isInAppBidding,productType:e.productType,demandSourceName:e.originalDemandSourceName,sessionDepth:e.settings&&e.settings.sessionDepth,strategyId:e.settings&&e.settings.strategyId,landingId:e.settings&&e.settings.landingId,adSource:e.settings&&e.settings.adSource}:{}}}}},{"./Constants":13}],5:[function(e,t,n){t.exports=function(i,r,a){return{decideOnAdvertisingId:function(e,t){var n;r.isIOS()&&(-1===i.Utils.versionCompare(e.deviceOSVersion,"10")||(n=e)["deviceIds[IFA]"]&&n["deviceIds[IFA]"]!==a.advertisingId.invalidAdvertisingId)&&(void 0===t.sid||t.sid||(e["deviceIds[IDFV]"]=null))}}}},{}],6:[function(t,e,n){e.exports=function(n,i,e){var r="AndroidLifeCycleEventHandlers | ",a=t("./NativeLifeCycleEventsConstants.js"),o=i.jQuery(),s={};function d(e){var t={};e&&(t.eventParams=e),n.PubSub.publish(a.serviceCallback+"."+a.AndroidEvents.onDestroy,[t])}function l(e){}function c(e){}function u(e){}function f(e,t){var n;return n="_isEventSupported: "+e+" supportedEvents: "+t,i.log(r+n),e&&-1<o.inArray(e,t)}return{publishEvent:function(e,t){s[a.AndroidEvents.onDestroy]=d,s[a.AndroidEvents.onStop]=l,s[a.AndroidEvents.onStart]=c,s[a.AndroidEvents.onResume]=u,f(e,Object.keys(s))&&s[e](t)}}}},{"./NativeLifeCycleEventsConstants.js":37}],7:[function(e,t,n){t.exports={eventicsCategories:{nomediaFileDownloadFail:{name:"nomediaFileDownloadFail",id:210},nomediaFileDownloadSuccess:{name:"nomediaFileDownloadSuccess",id:211}},noMediaFileUrl:"/users/android/.nomedia",logMessage:{tag:"AndroidNomediaFileHandler | ",fileInCache:"nomedia file already in cache",saveFileToCache:"save nomedia file to cache"},errorMessage:{fileAlreadyExist:"file_already_exist"}}},{}],8:[function(e,t,n){t.exports=function(r){var a,o=e("./AndroidNomediaFileConstants.js"),s=o.noMediaFileUrl;return{init:function(e){a=e},updateNomediaFileToCache:function(){var e,t=r.getConfig(),n=r.Cache.getRootCacheStructure(),i=(e=t).mobileSDKSettings.protocol+"//"+e.mobileSDKSettings.cdn+s;n&&-1!==r.Cache.getFileIndexInCache(n.cache,i)?r.log(o.logMessage.tag+o.logMessage.fileInCache):(r.log(o.logMessage.tag+o.logMessage.saveFileToCache),r.saveFileToCache("./",i).then(function(){a.trackEvent(o.eventicsCategories.nomediaFileDownloadSuccess)},function(e){e!==o.errorMessage.fileAlreadyExist&&a.trackEvent(o.eventicsCategories.nomediaFileDownloadFail,{generalMessage:e})}))}}}},{"./AndroidNomediaFileConstants.js":7}],9:[function(e,t,n){t.exports={NativeAPI:{getAUIDFailed:"getAUIDFailed",getAUIDSuccess:"getAUIDSuccess",setAUIDFailed:"setAUIDFailed",setAUIDSuccess:"setAUIDSuccess"}}},{}],10:[function(e,t,n){t.exports=function(u,f,g){var n,l,p="AppUserIdService | ",c=!1,t=e("../modules/SDKController/EventCategories")(),v=e("./AppUserIdConstants");function m(e){var t,n,i,r,a,o,s,d,l,c=new jQuery.Deferred;return(t=e)&&!jQuery.isEmptyObject(t)&&"{}"!==t?c.resolve(e):(n=u.Utils.generateIdentifier(1),i=c,s=[],d=v.NativeAPI.setAUIDSuccess,l=v.NativeAPI.setAUIDFailed,n&&i&&(s.push(u.PubSub.subscribe(g.CB+"."+d,function(e){if(clearTimeout(o),!(r=f.isIOS()?e&&e.key&&e.key===S()&&e.value&&decodeURIComponent(e.value):e&&e[S()]&&decodeURIComponent(e[S()]))||jQuery.isEmptyObject(r)||"{}"===r)return i.reject("Invalid set AUID response."),void u.PubSub.clearHandlers(s);f.log(p+"_setAUIDKeyInNative succeeded, response: "+r,f.LogLevels.info),i.resolve(r),u.PubSub.clearHandlers(s)})),s.push(u.PubSub.subscribe(g.CB+"."+l,function(e){clearTimeout(o),a=e&&!f.checkRequiredCallbackParams(["errMsg"],e,l).didSucceed?f.checkRequiredCallbackParams(["errMsg"],e,l).errMsg:e&&e.errMsg,f.log(p+"_setAUIDKeyInNative failed, errorMsg: "+a,f.LogLevels.info),i.reject(l+": "+a),u.PubSub.clearHandlers(s)})),o=setTimeout(function(){f.log(p+"_setAUIDFromNative failed, errorMsg: timeout",f.LogLevels.info),i.reject(l+": timeout"),u.PubSub.clearHandlers(s)},4e3),f.callSDKFunction("setUserData",{key:S(),value:n},d,l))),c.promise()}function h(e,t){n=e,u.Eventics.updateBaseData({auid:n}),t||f.getTokenService().updateToken({auid:n})}function b(e){l.trackEvent(t.auidFail,{},{callfailreason:e})}function S(){var e=f.SupplyConfigurations.getNetworkConfigValueByKey("auid_key");return e||"auid"}return{init:function(e){var t,n,i,r,a,o,s,d;c||(l=e,(t=f.SupplyConfigurations.getValueByKey("auid"))?h(t,!0):(a=[],o=new jQuery.Deferred,s=v.NativeAPI.getAUIDSuccess,d=v.NativeAPI.getAUIDFailed,a.push(u.PubSub.subscribe(g.CB+"."+s,function(e){if(clearTimeout(r),!(n=e&&e[S()]&&decodeURIComponent(e[S()])))return o.reject("Invalid get AUID response"),void u.PubSub.clearHandlers(a);f.log(p+"_getAUIDFromNative succeeded, response: "+n,f.LogLevels.info),o.resolve(n),u.PubSub.clearHandlers(a)})),a.push(u.PubSub.subscribe(g.CB+"."+d,function(e){clearTimeout(r),i=e&&!f.checkRequiredCallbackParams(["errMsg"],e,d).didSucceed?f.checkRequiredCallbackParams(["errMsg"],e,d).errMsg:e&&e.errMsg,f.log(p+"_getAUIDFromNative failed, errorMsg: "+i,f.LogLevels.info),o.reject(d+": "+i),u.PubSub.clearHandlers(a)})),r=setTimeout(function(){f.log(p+"_getAUIDFromNative failed, errorMsg: timeout",f.LogLevels.info),o.reject(d+": timeout"),u.PubSub.clearHandlers(a)},4e3),f.callSDKFunction("getUserData",{key:S()},s,d),o.promise()).then(m).then(h).fail(b),c=!0)},getAUID:function(){return n}}}},{"../modules/SDKController/EventCategories":142,"./AppUserIdConstants":9}],11:[function(e,t,n){t.exports=function(t){var r={},n=!1;function a(e,t){var n=r[e],i=[];return n&&n[t]?i=n[t]:n[t]=i,i}return{init:function(e){n||(r[t.RV]={},r[t.IS]={},r[t.BN]={},n=!0)},addToBlacklistedCampaigns:function(e,t,n){if(e&&t&&n){var i=a(e,t);i&&-1===i.indexOf(n)&&i.push(n)}},getBlacklistedCampaigns:function(e,t){var n=[];return e&&t&&(n=a(e,t)),n},isEmpty:function(e,t){var n=a(e,t);return!n||0===n.length}}}},{}],12:[function(e,t,n){t.exports=function(l,u,c){var n,f,g="FilterCampaigns | ",i={deviceOs:1,"deviceIds[IFA]":0,"deviceIds[AID]":0},p=1500,v=l.Utils,a={};function o(e){var t,n,i,r=new jQuery.Deferred,a="checkInstalledAppsSuccess",o="checkInstalledAppsFailed",s={appIds:e,requestId:Date.now().toString()},d=function(){l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n)};return t=l.PubSub.subscribe(c.CB+"."+a,function(e){e.requestId===s.requestId&&(clearTimeout(i),d(),u.log(g+"successfully check apps installed "+JSON.stringify(e.result)),r.resolve(e.result))}),n=l.PubSub.subscribe(c.CB+"."+o,function(e){clearTimeout(i),d(),u.log(g+"failed to check apps installed"+JSON.stringify(e)),r.reject()}),i=setTimeout(function(){d(),r.reject("SDK check apps installed timeout request")},p),u.callSDKFunction("checkInstalledApps",s,a,o),r.promise()}function s(e){var a={deviceId:"ios"===(n=u.getApiData(i)).deviceOs?n["deviceIds[IFA]"]:n["deviceIds[AID]"],os:n.deviceOs,campaignIds:{}},t=f.urlPaths&&f.urlPaths.campaignsStatus;t?(jQuery.each(e,function(e,t){var n,i,r;a.campaignIds[t.campaignId]=(n=t.isInstalled,r=n?(i=50,100):(i=0,50),Math.floor(Math.random()*(r-i))+i)}),jQuery.ajax({url:t,data:a,type:"GET",dataType:"jsonp",success:function(e){u.log("Success update campaigns status to server",u.LogLevels.verbose)},error:function(e,t){u.log("Success update campaigns status to server: response:"+e+".status: "+t,u.LogLevels.verbose)}})):u.log("No url in settings to update server on campaigns status",u.LogLevels.verbose)}function m(e,t){var n=!0;return e||(u.log("filter apps installed flag is false",u.LogLevels.verbose),n=!1),t&&0!==t.length||(u.log("get 0 campaigns to filter",u.LogLevels.verbose),n=!1),u.isLegacy({ios:"5.14",android:"5.16"})&&(u.log("NewController: Old controller version. filter campaigns by app installed is not supported in this version of SDK.",u.LogLevels.verbose),n=!1),n}function h(e,t,n){var i,r=new jQuery.Deferred;return jQuery.isEmptyObject(t)?r.resolve():(i=n,u.isAppsInstalledInfoRestricted()?l.Utils.returnResolvedPromise(a):o(i)).then(function(e,i,t,n){jQuery.each(n,function(e,t){var n=i[e];n&&(t.bannerIds=n)});var o,r,s,a=(o=e,r=n,s=[],jQuery.each(r,function(e,t){if(t.isInstalled){for(var n=[],i=0;i<o.length;i++){var r=u.AdUtils.getAdId(o[i]);t.bannerIds&&-1===t.bannerIds.indexOf(r)?n.push(o[i]):s.push(o[i])}for(var a=o.length=0;a<n.length;a++)o.push(n[a])}}),u.log(g+"after ads filtering"),{newCampaigns:o,installedCampaigns:s});return e=a.newCampaigns,t.resolve(a.installedCampaigns),n}.bind(null,e,t,r)).then(s).fail(function(e){u.log("failed filter campaigns by app installed. "+e,u.LogLevels.verbose),r.resolve()}),r.promise()}return{filterByAppInstalled:function(e,t,n){if(n=n||[],!m((f=t).filterAppsInstalled,e))return v.returnResolvedPromise();for(var i={},r=e.length,a=[],o=0;o<r;o++){var s=e[o],d=u.AdUtils.getAdId(s),l=s&&s.ext,c=l&&l.appData;l&&c&&c.appId&&(0===n.length||-1===n.indexOf(l.type))&&(i[c.appId]||(i[c.appId]=[]),i[c.appId].push(d),-1===a.indexOf(c.appId)&&a.push(c.appId))}return h(e,i,a)},filterByAppInstalledOW:function(e,t){if(f=t,!m(!0,e))return v.returnResolvedPromise();for(var n={},i=e.length,r=[],a=0;a<i;a++){var o=e[a],s=u.AdUtils.getAdId(o),d=o.appData;d&&d.filterIfInstalled&&d.appId&&(n[d.appId]||(n[d.appId]=[]),n[d.appId].push(s),-1===r.indexOf(d.appId)&&r.push(d.appId))}return h(e,n,r)},checkIfAppInstallOnDevice:o}}},{}],13:[function(e,t,n){var i=e("../constants/featureCompatibilityMap");t.exports={CB:"NativeCallback",WebControls:"WebControls",RV:"RewardedVideo",OW:"OfferWall",IS:"Interstitial",BN:"Banner",RIS:"RIS",taskManager:"TaskManagerDS",libs:"libs",fakeOWLoader:"fakeOWLoader",timeunit:6e4,closeAndBackDisabledTimer:1e4,closeAndBackDisabledTimerOW:8e3,vastResponseTimeout:8e3,vastMinimumResponseTimeout:500,legacyCreativeId:0,domainUrls:{local:"local.ssacdn.com",prod:"www.supersonicads.com"},environment:{develop:"dev",production:"prod",stage:"stage"},errors:{missing:"Missing required parameter: ",invalid:"Invalid parameter: ",unknown:"Unknown parameter: ",appInfo:"Failed to retrieve application info",device:"Failed to retrieve device status",filemap:"Failed to retrieve file map",showAdFailedReasons:{preloadNoAd:"No ad on preload function",showNoAd:"No ad on show function",taskManagerPreload:"taskManager failed to preload",taskManagerEngage:"taskManager failed to engage"},noFill:"We did not receive any campaigns in inventory"},noMoreOffersReason:{refreshFeedAfterClosingAd:"Refresh Feed after closing ad",noMoreOffersToShowInFeed:"Finish view all campaigns (engageEnd)"},DebugLevels:{0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"},videoStates:{none:0,play:1,stop:2},confirmCloseMsg:{close:"Are you sure you want to quit the offer?",yes:"OK",no:"Cancel"},confirmCloseMsgMap:{0:"during",1:"after"},protocol:{http:"http:",https:"https:",file:"file:"},styleAccordingToProtocol:{secured:"secured",unsecured:"unsecured"},labels:{noInternet:"No internet connection. Please connect and try again.",noOffers:"Sorry, There are no offers at the moment"},closeButtonStates:{close:"close",confirm:"confirm",back:"back",confirmNextFrame:"confirmNextFrame",nextFrame:"nextFrame",ignore:"ignore",closeBanner:"closeBanner"},openUrlMethods:{storeKit:"storeKit",external_browser:"external_browser",store:"store",webview:"webview"},deviceOs:{android:"android",ios:"ios"},deviceOEM:{amazon:"amazon"},nativeInterfaceMethod:{displayWebView:"displayWebView"},nativeCallBacks:{hideSuccess:"onHideSuccess",hideFailed:"onHideFailed",displayWebviewSuccess:"onDisplayWebviewSuccess",displayWebviewFailed:"onDisplayWebviewFailed:"},offerWallSetting:{immersive:"immersive",OLXD:"OLXD",OWVersion:"OWVersion",defaultOWVersion:"1.12.183"},appInfo:{orientation:{landscape:"landscape",portrait:"portrait",none:"none"}},sspProductNames:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",OfferWall:"offerWall",Banner:"banner"},demandSourceType:{demandSource:"demandSource",instance:"instance"},demandSourceStates:{notInitiated:0,initFail:1,initiated:2,available:3,notAvailable:4,exhausted:5,cappedPerSession:6,initPending:7,loadPending:8},templateStyle:{template4:{minDialogBtnWidth:187,baseDialogBtnWidth:187,maxDialogBtnWidth:187,maxDialogBtnTextWidth:165},defaultTemplate:{minDialogBtnWidth:75,baseDialogBtnWidth:100,maxDialogBtnWidth:133,maxDialogBtnTextWidth:115}},viewsStates:{normal:0},baseDataKeys:["bannerId","creativeId","campaignType","opportunityId","requestId","adSource"],keysToResetOnAdClosed:["rvPlayMethod","dynamicDemandSource","sessionDepth","adunitbn","adunitVersion","feedCampaignOrder","feedSize","strategyId"],iphoneXDeviceModels:["iPhone10,3","iPhone10,6","iPhone11,6","iPhone11,4","iPhone11,2","iPhone11,8","iPhone12,1","iPhone12,3","iPhone12,5","iPhone13,1","iPhone13,2","iPhone13,3","iPhone13,4","iPhone14,2","iPhone14,3","iPhone14,4","iPhone14,5"],iphoneXDeviceResolution:{type1:{width:375,height:812},type2:{width:414,height:896},type3:{width:390,height:844},type4:{width:428,height:926}},notchSettings:{safeAreaInsetsMin:24,viewportCounter:10},requiredDeviceInfo:["appOrientation","connectionType","deviceOs","SDKVersion","deviceOSVersion","deviceModel","diskFreeSize"],requiredAppInfo:["applicationKey","applicationUserId"],optionalAppInfo:["campaignId","showDeliveryLimitationsLog","numOfCampaigns","disableCache","disableSession","country","language","itemName","itemCount","itemSignature","timestamp","demoCampaigns","mraid","admin","page","pageSize","landingId","maxVideoLength","minimumOfferCommission","minimumOfferCommissionSignature","useClientSideCallbacks","applicationUserGender","applicationUserAgeGroup","applicationUserCreationDate","applicationUserCreationDateSignature","placementId","SDKPluginType","skd"],abTests:{CnCcCdn:"CC2",CnNonCcCdn:"NCC2",CnUser:"CN",NonCnUser:"NCN",WithoutCC:"WOCC",abt:"abt",controllerConfigGroup:"controllerConfigGroup"},xCodeVersion:"xCodeVersion",abtParamByProductType:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",Banner:"banner",OfferWall:"offerwall"},deviceLimitations:["iPod5,1","iPad2,1","iPad4,8","iPad3,5","iPad3,6","iPad4,5","iPhone4,1","iPhone7,1","iPad4,4","iPad4,2","iPad2,2","iPad2,5","iPad4,1","iPad3,4","iPad3,3","iPad4,7","iPad3,1","iPad2,4"],applicationsLimitations:["49726195"],testAppBundleIds:["com.supersonic.mediation.test","com.ironsrcmobile.UltraApp","com.ironsrcmobile.UltraApp-enterprise","com.supersonic.automationapp","com.ironsrcmobile.Bridge","com.ironsource.othermediationtester","com.ironsrc.ISMedAdapters"],defaultOrientation:{RewardedVideo:"application",Interstitial:"application",OfferWall:"application",Banner:"application",general:"device",undefined:"application"},vastRequestPlaceholders:{moatEnabled:"{MT_ENABLED}",requestId:"{REQ_ID}",opportunityId:"{OPP_ID}"},featureCompatibilityMap:i,blockedProductsPerApiLevel:{RewardedVideo:{android:/^10/,ios:/^7/},OfferWall:{android:/^10/,ios:/^7/},Interstitial:{android:/^10/,ios:/^7/},Banner:{android:/^10/,ios:/^7|8|9/}},storeSearchKeys:{ios:["itunes.apple.com"],android:["market://","play.google.com"]},gatewayDestinationMap:{RV:{production:"//rv-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-rv-gateway.sonic-us.supersonicads.com/gateway/sdk/request"},IS:{production:"//is-gateway.supersonicads.com/gateway/sdk/request/",staging:"//staging-is-gateway.sonic-us.supersonicads.com/gateway/sdk/request/"},OW:{production:"//ow-gateway.supersonicads.com/gateway/offerwall/request",staging:"//staging-ow-gateway.sonic-us.supersonicads.com/gateway/offerwall/request"},BN:{production:"//banner-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-banner-gateway.sonic-us.supersonicads.com/gateway/sdk/admin/request"}},appExtConfigPath:"/users/microjob/sdkconfig.json",appExtConfigPathStaging:"/users/microjob/sdkconfig_staging.json",requiredSDKDataKeys:{applicationKey:"applicationKey",applicationUserId:"applicationUserId",appOrientation:"appOrientation",deviceLanguage:"deviceLanguage",bundleId:"bundleId",sdkAbName:"sdkAbName"},HTTPMethods:{GET:"GET",POST:"POST"},adClosedErrorReason:{unexpectedCloseActivityDestroy:"unexpectedClose_ActivityDestroy"},viewTypes:{externalView:"external"},assetType:{adunitAsset:"adunitAsset",adAsset:"adAsset"},adViewIdString:"adViewId",bannerAdViewId:"Banner.SupersonicAds",DEFAULT_AMOUNT_OF_INVENTORIES:1,iOS_UIModalPresentationFullScreen:0,adTypes:{CPVI:"CPVI",customEndCard:"customEndCard",imageInterstitial:"imageInterstitial",MRAID:"MRAID",playableAd:"playableAd"},extraOffers:{minimalAndroidApiLevel:21,fetchTimeout:1e4,minimumAdsForExtraOffersInventory:2},viewableChangeReasons:{storeKitOpen:"storeKitOpen",storeKitClose:"storeKitClose"},storeKit:{minimalSupportedOSVersion:11,loadFailuresToPreventRetry:["Invalid Parameters","Unsupported Orientation"],loadingTimeoutMessage:"StoreKit load timeout"},authorizationStatus:"att",advertisingId:{invalidAdvertisingId:"00000000-0000-0000-0000-000000000000"},advertiserIdParamsToUpdate:["deviceIds[IFA]","deviceIds[IDFV]","isLimitAdTrackingEnabled","att","idfa","idfv","lat"],cacheAdsDirectory:"ads",numOfBannersToInitSuccess:"numOfBannersToInitSuccess",numOfBannersToCache:"numOfBannersToCache",cacheConfiguration:"cacheConfig",defaultTimeoutForCachingAds:3e4,isBNAutoRemove:"isBNAutoRemove",bnAutoDestroy:"bnAutoDestroy"}},{"../constants/featureCompatibilityMap":92}],14:[function(e,t,n){t.exports=function(i,r,t){function n(e){return!(e&&e.productType)}function a(e,t){return t=t||{},e&&e.demandSourceName&&(t.demandSourceName=e.demandSourceName,t.demandSourceId=e.demandSourceId,t.isInAppBidding=e.isInAppBidding),t}return{isLegacy:n,extendCallbackParamsWithDemandConfig:a,extendCallbackParamsWithProductConfig:function(e,t){return t=a(e,t),e&&e.productType&&(t.productType=e.productType),t},extendCallbackParamsWithParentProductConfig:function(e,t){if(t=a(e,t),e&&e.productType){var n=r[e.productType];n&&(t.productType=i.Utils.isFunction(n.getProductType)?n.getProductType():e.productType)}return t},shouldReceiveMessage:function(e,t){return!(!e||!t)&&!(!e.productType||!e.demandSourceName)&&t.productType===e.productType&&(n(e)||t.demandSourceName===e.demandSourceName)},setManualRewardedVideoTypeForNative:function(e){return e&&e.productType&&e.productType===t.RV&&(e.productType=t.IS),e}}}},{}],15:[function(e,t,n){t.exports={CB:"NativeCallback",deviceDataNativeFunction:"deviceDataAPI",getDeviceData:"getDeviceData",failCallback:"handleDeviceDataFailed",successCallback:"handleDeviceDataSuccess",sdkNotSupportedErrMsg:"DeviceDataService | module not supported by SDK",notInitiatedErrMsg:"DeviceDataService | module not initiated or not supported by SDK",alreadyInitiatedErrMsg:"DeviceDataService | init | module is already initiated",intervalAlreadySet:"DeviceDataService | _startPullingDataWithInterval | interval already set",notValidInterval:"DeviceDataService | _startPullingDataWithInterval | interval is not valid, must be higher than 15 seconds",minimumIntervalAllow:5}},{}],16:[function(e,t,n){t.exports=function(n,i){var r,a,o=e("./DeviceDataConstants"),s=e("../constants/featureCompatibilityMap"),d=!1,t={},l=!1;function c(){i.callSDKFunction(o.deviceDataNativeFunction,{deviceDataFunction:o.getDeviceData},o.successCallback,o.failCallback)}function u(e){var t=e&&e.errMsg?e.errMsg:"";i.log("DeviceDataService |  getDeviceData fail, params : "+JSON.stringify(e)+"with errorMessage: "+t)}function f(e){i.log("DeviceDataService |  getDeviceData success, params :"+JSON.stringify(e)),e&&(t=e)}function g(){d?(clearInterval(r),r=void 0):i.log(o.notInitiatedErrMsg)}function p(e){if(i.log("DeviceDataService | _startPullingDataWithInterval | interval:"+e),d){var t=(n=parseInt(e),isNaN(n)?-1:n);t<o.minimumIntervalAllow?i.log(o.notValidInterval):r?i.log(o.intervalAlreadySet):r=setInterval(c,1e3*(a=t))}else i.log(o.notInitiatedErrMsg);var n}return{init:function(e){if(i.isLegacy(s.pullingNativeDeviceData))i.log(o.sdkNotSupportedErrMsg);else if(d)i.log(o.alreadyInitiatedErrMsg);else{var t=i.getConfig().controllerConfig||{};n.PubSub.subscribe(o.CB+"."+o.successCallback,f),n.PubSub.subscribe(o.CB+"."+o.failCallback,u),n.PubSub.subscribe(o.CB+".enterBackground",function(e){i.log("DeviceDataService | entered BG | should pause interval"),g()}),n.PubSub.subscribe(o.CB+".enterForeground",function(e){i.log("DeviceDataService | entered FG | should resume interval"),p(a)}),c(),d=!0,p(t.pullingDeviceDataInterval)}},getDeviceData:function(){return d||i.log(o.notInitiatedErrMsg),t},pullData:c,startPullingDataWithInterval:p,stopPullingData:g,setPullDataOnLoadAd:function(e){e&&!l&&(l=!0)},shouldPullDataOnLoadAd:function(){return l}}}},{"../constants/featureCompatibilityMap":92,"./DeviceDataConstants":15}],17:[function(e,t,n){t.exports=function(e,t,n,i){var r=e.AdUtils,a=null;return{set:function(e){e&&e.productType===i.BN&&a&&a.productType!==i.BN?t.trackEvent(n.setAdDisplayAlreadyAdShown,{},{productType:e.productType,generalMessage:a.productType+" | "+e.productType}):a=e},get:function(){return a||null},reset:function(){a=null},getDisplayedAdType:function(){return a?a.productType:null},getDisplayedAdDemandName:function(){return a?a.demandSourceName:null},getDisplayedAdSettings:function(){return a?a.settings:null},isDisplayed:function(){return null!==a},isAdDisplayed:function(e){return a&&e&&r.getAdId(a)===r.getAdId(e)}}}},{}],18:[function(e,t,n){t.exports=function(n){return{isEventDisabled:function(e){if(n.SupplyConfigurations.isNetworkConfigEmpty())return"noFill"===e.name;var t=n.SupplyConfigurations.getNetworkConfigValueByKey("events");return!(!t||!t.disabledEvents)&&-1!==t.disabledEvents.indexOf(e.name)}}}},{}],19:[function(e,t,n){t.exports=function(){var a={};return{getABTestConfiguration:function(e,t){var n=a[e]&&a[e].abtest&&a[e].abtest.default,i=a[e]&&a[e].abtest&&a[e].abtest[n]||{},r=a[e]&&a[e].abtest&&a[e].abtest[t]||{};return jQuery.extend(i,r)},setConfig:function(e){a=e||{}},getExtConfig:function(){return a},getGeneralConfig:function(){return a.general},reset:function(){a={}}}}},{}],20:[function(require,module,exports){function ExtraOffers(constants,fetcherService,environmentConfiguration){var minimumAdsForExtraOffersInventory=constants.extraOffers.minimumAdsForExtraOffersInventory,supportedProductTypes=[constants.RV,constants.IS],supportedAdTypes=[constants.adTypes.CPVI,constants.adTypes.customEndCard,constants.adTypes.imageInterstitial];function _isEnabled(e){return!!(e&&e.extraOffers&&e.extraOffers.enabled)}function _isProductTypeSupported(e){return-1!==supportedProductTypes.indexOf(e)}function _isAdTypeSupported(e){return-1!==supportedAdTypes.indexOf(e)}function _isSupported(e,t,n,i){return!(e===constants.deviceOs.android&&t<constants.extraOffers.minimalAndroidApiLevel)&&(_isEnabled(i)&&_isProductTypeSupported(n.productType)&&_isAdTypeSupported(n.ext.type))}function _fetchExtraOffersInventory(e,t,n,i,r){var a=_buildRequiredDataForExtraOffersRequest(t,n,i,r);e=jQuery.extend({},e,a);var o=new jQuery.Deferred;return fetcherService.fetchFeed(environmentConfiguration().getConfig().schema+constants.gatewayDestinationMap.BN.production,e,constants.extraOffers.fetchTimeout).done(function(e){if(_isInvalidExtraOffersResponse(e))o.reject(e.errorCode.toString());else if(_isInventoryEligible(e))o.resolve(e);else{var t="Invalid extra offers inventory, length: "+e.seatbid.bid.length;o.reject(t)}}).fail(function(e,t){o.reject(t)}),o.promise()}function _isInvalidExtraOffersResponse(e){return!(!e||!e.hasOwnProperty("errorCode"))}function _buildRequiredDataForExtraOffersRequest(e,t,n,i){return{extraOffers:!0,currProductType:e||"",blacklistedCampaigns:t||"",currReqId:n||"",currOppId:i||""}}function _isInventoryEligible(e){return!!(e&&e.seatbid&&e.seatbid.bid&&e.seatbid.bid.length>=minimumAdsForExtraOffersInventory)}function _test(){var re=/(\(\))$/,args=[].slice.call(arguments),name=args.shift(),is_method=re.test(name),target;return name=name.replace(re,""),target=eval(name),is_method?target.apply(this,args):target}return{isSupported:_isSupported,fetchExtraOffersInventory:_fetchExtraOffersInventory,test:_test}}module.exports=ExtraOffers},{}],21:[function(e,t,n){t.exports=function(n){return{isFeatureSupportedInNativeSDK:function(e){var t=!1;return e&&n&&n.nativeFeatures&&(t=Array.isArray(n.nativeFeatures)&&-1<n.nativeFeatures.indexOf(e)),t}}}},{}],22:[function(e,t,n){t.exports=function(e,i,t){var r,a=e||"",o=t||6e4,s="Invalid API response",d=function(t){var n=!0;return jQuery.each(i,function(e){n=n&&void 0!==t[e]}),n};return{getInventory:function(e,t,n){r=new jQuery.Deferred;var i=t||a;return jQuery.ajax({url:i,data:e,type:"GET",dataType:n||"jsonp",timeout:o}).then(function(e){e&&e.errorCode&&e.errorMessage?r.reject({errorMessage:e.errorMessage,errorCode:e.errorCode}):d(e)?r.resolve(e):r.reject({errorMessage:s})},function(e,t,n){var i={errorMessage:"Error fetching inventory. Error data: "+t};r.reject(i)}),r.promise()},isValidResponseStructure:d}}},{}],23:[function(e,t,n){t.exports=function(o,s){var d,i={hit:1,miss:2,eventResult:"eventResult",resultReason:"resultReason"};function t(e){function a(e,t){var n;return e&&e.url&&(n={url:function(e,t){if(!e)return"";if(t)for(var n=t.length,i=0;i<n;i++)e=e.replace("{{"+t[i].key+"}}",encodeURIComponent(t[i].value));return e=e.replace(/\{\{[\w\d\s]*\}\}/g,"ok")}(e.url,t),type:e.type}),n}function n(e,t){var n,i,r=d[e];"object"==typeof r&&(0<r.length&&(r=r[0]),(n=a(r,t))&&(i=n,s.firePixel(i),o.log("Callback: "+JSON.stringify(i),o.LogLevels.info)))}return d=e,{track:function(e){var t;if(e&&d)switch(e.trackingType){case"request":n("requestTracking",null);break;case"responseHit":n("responseTracking",[{key:i.eventResult,value:i.hit}]);break;case"responseMiss":t=e.data,n("responseTracking",[{key:i.eventResult,value:i.miss},{key:i.resultReason,value:t}])}}}}return{init:function(e){return new t(e)}}}},{}],24:[function(e,t,n){t.exports=function(){var t=[];return{addToFilteredListCampaigns:function(e){e&&-1===t.indexOf(e)&&t.push(e)},getFilteredListCampaigns:function(){return t}}}},{}],25:[function(e,t,n){t.exports=function(i,t){function n(){var e=t("#displayedFrame");return e&&0<e.length?e:null}return{getDisplayedAdFrame:n,isFrameDisplayed:function(e){var t=n();return e&&t&&e[0]===t[0]},getAdUnitClassObj:function(e){var t="ssaAdUnit",n={class:t+" ",selector:"."+t};return e&&e.productType?(n.class+=e.productType+" ",n.selector+="."+e.productType,e.demandSourceName&&(n.class+=e.demandSourceName+" ",n.selector+="."+e.demandSourceName)):i.log("In getAdUnitClass with no ad",i.LogLevels.error),n},hideFrame:function(){var e=n();e&&e.addClass("hidden")},displayFrame:function(){var e=n();e&&e.removeClass("hidden")}}}},{}],26:[function(e,t,n){t.exports={NativeAPI:{updateConsentInfo:".updateConsentInfo"}}},{}],27:[function(s,e,t){e.exports=function(e,t,n){var i=s("./GDPRConstants.js"),r=!1,a=n.CB;function o(e){"string"!=typeof e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(t.getConfig().applicationSettings.consent=e)}return{init:function(){r||(e.PubSub.subscribe(a+i.NativeAPI.updateConsentInfo,function(e){if(e&&e.gdprConsentStatus)return t.log("updateConsentInfo | controller | params: "+JSON.stringify(e),t.LogLevels.info),void o(e.gdprConsentStatus);t.log("updateConsentInfo | controller | without params or gdprConsentStatus key",t.LogLevels.info)}),r=!0)},setConsent:o,getConsent:function(){return t.getConfig().applicationSettings.consent}}}},{"./GDPRConstants.js":26}],28:[function(e,t,n){function i(r,o){var e="NativeCallback",t=!1,a=[],n={GET:"GET",POST:"POST"},s={requestUnknown:"requestUnknown",requestStarted:"requestStarted",responseReceived:"responseReceived",requestError:"requestError"};function i(){r.PubSub.subscribe(e+".httpRequestStatusChanged",function(e){o.checkRequiredCallbackParams(["identifier","status"],e,"httpRequestStatusChanged").didSucceed&&d(e)})}function d(e){o.log("HTTPService - request status changed",o.LogLevels.verbose);var t=g(e.identifier,a);if(t)if(e.status===s.requestStarted)l(t);else if(e.status===s.responseReceived){var n={headers:e.responseParams.headers,statusCode:e.responseParams.statusCode,ranOnNative:!0},i=e.data;e.data&&(i=decodeURIComponent(i)),c(t,i,n)}else u(t,e.errMsg)}function l(e){o.log("onRequestStarted "+e.identifier,o.LogLevels.verbose),r.Utils.isFunction(e.onRequestStarted)&&e.onRequestStarted()}function c(e,t,n){o.log("_onResponseReceived "+e.identifier,o.LogLevels.verbose),f(e),r.Utils.isFunction(e.onResponseReceived)&&e.onResponseReceived(t,n)}function u(e,t){o.log("onRequestError "+t,o.LogLevels.verbose),f(e),r.Utils.isFunction(e.onRequestError)&&e.onRequestError(t)}function f(e){if(e){var t=a.indexOf(e);-1<t&&a.splice(t,1)}}function g(t,e){var n=jQuery.grep(e,function(e){return e.identifier===t});return 1!==n.length?null:n[0]}function p(){return+new Date+""+Math.random()}function v(e){return(!r.Utils.isDefined(e.allowNative)||e.allowNative)&&t}function m(e,t){return jQuery.extend(t,{url:e},{identifier:p()}),r.Utils.isDefined(t.background)||(t.background=!1),t}function h(e){o.log("_sendNativeEngineRequest",o.LogLevels.verbose);var i={};jQuery.each(e,function(e,t){if(!r.Utils.isFunction(t)){var n={};n[e]=t,jQuery.extend(i,n)}}),o.callSDKFunction("sendHttpRequest",i,"httpRequestStatusChanged","httpRequestStatusChanged")}function b(i){var r;o.log("_sendWebEngineRequest",o.LogLevels.verbose);var e=i;l(i);var a=function(e,t){var n={headers:e.getAllResponseHeaders(),statusCode:e.status,ranOnNative:!1};c(i,t,n)},t=jQuery.ajax(e);t.done(function(e,t,n){var i=n.responseText;a(n,i)}),t.fail(function(e,t,n){r=n,0===e.status?u(i,r&&""!==r?r:"unknown error"):a(e)})}function S(e){a.push(e),v(e)?h(e):b(e)}function y(e,t){t||(t={}),t.type=n.GET,S(m(e,t))}function A(e,t){t||(t={}),t.type=n.POST,S(m(e,t))}function C(){return a}function D(){return t}function I(){t=!0,i()}var w={GETRequest:y,POSTRequest:A,getPendingRequests:C,getIsNativeEngineExist:D,init:I};return w}t.exports=i},{}],29:[function(e,t,n){var S=e("./containers/ContainerCreationStateHandler");t.exports=function(a,o,s,d){var l="IframeManager | ",c=a.jQuery(),u=a.AdUtils;function f(e,t,n,i){u.extendAdObjectWithConfig(t,e,n,i),a.getNotchService().onSetConfig(e)&&(b("Extend ad object isTransparentLayout=true"),e.settings.isTransparentLayout=!0),a.RingerSwitchService.isInitiated()&&(b("Extend ad object ringerMuteOnStart=true"),e.settings.ringerMuteOnStart=!0)}function g(e){var t,n=e.adViewId,i=null;return t=s.getAdUnitClassObj(e).selector,c.each(c(t),function(){return c(this).data("id")!=n||(i=c(this),!1)}),i}function p(e,t,n,i){var r,a;b("createAndLoadAdFrame"),f(e,t,n,i),a=(r=e).productType===o.OW?u.getAdId(r):u.generateUniqueAdId(r),r.adViewId=a,g(e)||function(e,t){var n=e.adViewId;b("loading ad to frame: "+n+" "+e.productType);var i=s.getAdUnitClassObj(e).class;t&&(i+="hidden "),c("<iframe />",{class:i,src:e.url}).data("id",n).data("close",!0).appendTo("body")}(e,i.preload)}function r(e){var t=!!g(e);return b("isContainerLoaded: "+t),t}function v(e){var t=c(".loaderOW");t.addClass("loaderOWFadeOut"),setTimeout(function(){b("hideLoader - enter timeOut"),c(".loaderOW").addClass("hidden"),t[0].offsetWidth=t[0].offsetWidth},600),c("#ssaLoaderWrap").addClass("hidden")}function m(e,t,n,i){v(),n(!1),d.set(t),e.removeClass("hidden").attr("id","displayedFrame"),i()}function h(e,t){e===o.OW?c(".loaderOW").removeClass("loaderOWFadeOut hidden"):c("#ssaLoaderWrap").removeClass("hidden")}function n(e,t,n){t&&(n=n||parent).postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}function b(e){a.log(l+e)}return{createAndLoadAdFrame:p,updateAdUnitUrl:function(e,t,n,i){var r;f(e,t,n,i),(r=g(e))?(b("updated iframe url for product "+n.productType),r[0].src=e.url):i.forceCreation?(b("cannot find iframe to update, creating new one"),p(e,t,n,i)):a.log(l+"cannot find iframe to update url")},displayAdView:function(e,t,n,i){var r=g(e);r.data("loaded")?(b("display frame"),c.when(i(e,!1)).done(function(){m(r,e,t,n)})):(b("display frame with loader"),d.set(e),c.when(i(e,!0)).done(function(){!function(e,t,n,i){if(e.data("loaded"))return m(e,t,n,i);n(!0),a.log(l+"display with loader, frame "+e.data("id")),t&&t.productType&&(h(t.productType),e.attr("id","displayedFrame"))}(r,e,t,n)}))},handleScreenVisible:function(e,t){e&&h(t.productType);var n=s.getDisplayedAdFrame();n&&(b("ad unit open error"),n.addClass("hidden").attr("id",""))},unloadAdView:function(n){var i=n.adViewId;b("unloading ad from frame | id:"+i+" pt: "+n.productType),c.each(c(s.getAdUnitClassObj(n).selector),function(e,t){return c(t).data("id")!==i||(n.engaged&&t.removeAttribute("id"),n.productType===o.OW?setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0):t&&t.parentNode&&t.parentNode.removeChild(t),!1)})},displayLoader:h,hideLoader:v,hideView:s.hideFrame,displayView:s.displayFrame,isContainerLoaded:r,onAdUnitLoaded:function(e,t,n){var i=g(e);if(i)if(i.data("loaded"))b("already received the loaded event for frame");else{i.data("loaded",!0);var r=s.isFrameDisplayed(i);b("ad loaded: "+a.AdUtils.getAdId(e)+" | "+r?"frame Displayed: true":"frame Displayed: false|"+s.getAdUnitClassObj(e).selector),r&&m(i,e,t,n)}},getAdViewByAd:g,sendMessageToDisplayedAdView:function(e){var t=s.getDisplayedAdFrame();t&&n(JSON.stringify(e),"*",t[0].contentWindow)},sendMessageToAllAdViews:function(e){c.each(c(".ssaAdUnit"),function(){n(JSON.stringify(e),"*",this.contentWindow)})},getDisplayedAdView:s.getDisplayedAdFrame,isViewDisplayed:s.isFrameDisplayed,getContainerID:function(){return"1"},getContainerCreationHandler:function(e){b("_getContainerCreationHandler: ");var t=new S(c,a.log),n=t.getCreationStates(),i=r(e)?n.createdSuccessfully:n.notCreated;return t.setState(i),t}}}},{"./containers/ContainerCreationStateHandler":71}],30:[function(e,t,n){t.exports=function(r){var e=[];function a(t){return function(e){return e.demandSourceName===s(t)&&e.productType===t.productType}}function n(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].counter;return t}function o(e){var t;return n(d().filter((t=e,function(e){return e&&e.productType===t})))}function t(e){var t;return n(d().filter((t=e,function(e){return e&&e.productType===t&&!0===e.isBiddingInstance})))}function s(e){return e.originalDemandSourceName||e.demandSourceName}function i(e){var t,n,i=d().filter(a(e));return 0<i.length?i[0]:(n={demandSourceName:s(t=e),productType:t.productType,isBiddingInstance:t.isInAppBidding,counter:0},d().push(n),n)}function d(){return e}return{getCountersByProduct:function(e){return{bidding:t(e),totalSessionImpressions:o(e)}},getTokenCounters:function(){return{biddingRVImpressions:t(r.RV),biddingISImpressions:t(r.IS),totalRVSessionImpressions:o(r.RV),totalISSessionImpressions:o(r.IS)}},getPayloadCounters:function(e){return{instanceImpressions:(t=e,n=0,i=d().filter(a(t)),0<i.length&&(n=i[0].counter),n),totalRVSessionImpressions:o(r.RV),totalISSessionImpressions:o(r.IS)};var t,n,i},setInstanceImpressionsCounter:function(e){var t=i(e);t&&t.counter++}}}},{}],31:[function(e,t,n){function i(e){var t=e,r=[],i=-1;function a(){return r.length}function n(){return r}function o(e){Array.isArray(e)&&(i=0,r=e)}function s(){return r[i]}function d(e){var t,n=u(e);return-1<n&&(t=r.splice(n,1)[0])&&(g()?i=-1:i<n?i=(i+1)%a():n<i&&i--),t}function l(e){var t=u(e);if(-1<t)return r[t]}function c(e,t){var n=u(t);if(-1<n)return r[n]=e,r[n]}function u(e){if(void 0===e)return-1;for(var t=0,n=a(),i=e.toString();t<n&&e;t++)if(r[t].id===i)return t;return-1}function f(){return!g()&&(i+1)%a()!==i}function g(){return 0===a()}function p(){r=[],i=-1}var v={getOffers:n,getCurrentOffer:s,getOfferById:l,setOffers:o,removeOfferById:d,replaceOfferById:c,isNextOfferAvailable:f,isEmpty:g,size:a,reset:p};return v}t.exports=i},{}],32:[function(e,t,n){t.exports=function(i,r){var a=0,o=0;function t(){return a}return{setLastDisplayedAdCampaignId:function(e,t,n){i.getApplicationExternalConfig().getABTestConfiguration(n,t).sendLastCampaignId&&n===r.IS&&(a=e,o=t)},getLastDisplayedAdCampaignId:t,shouldAddLastDisplayedAdCampaignIdToPayload:function(e){return i.getApplicationExternalConfig().getABTestConfiguration(e,o).sendLastCampaignId&&e===r.IS&&0!==t()}}}},{}],33:[function(e,t,n){function i(a){var o,s,d,l,c,u,r={none:0,error:1,info:2,verbose:3},f={0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"};function g(e,t){var n=a.isDefined(e)?e:"Controller",i=a.isDefined(t)?f[t]:f[d];return d?"SupersonicAds "+n+" ["+i+"] :":""}return{init:function(e,t,n,i){c=window.console||{},o=e,l=t,u=i,(d=n)?(s=c.log,c.log=function(e){this.log(e,r.verbose)}):c.log=function(){}},log:function(e,t,n){var i,r;(window.productionDebug&&u&&u({url:"http://iron-debug-controller.com?log="+e,type:"pixel"}),t&&d<t)||(a.isString(e)||(e=JSON.stringify(e)),a.isFunction(s)&&"android"===o?s.call(c,g(n,t)+e):"android"!==o&&(i=g(n,t)+e,(r={eventName:"log",prefix:"logmessage"}).parameters={message:i,acknowledgeWith:"acknowledgeMessage",declineWith:"errorTest"},l&&l.postMessage(r)))},debugMsg:g,LogLevels:r,DebugLevels:f}}var r;t.exports=function(e){return r||(r=new i(e)),r}},{}],34:[function(e,t,n){function i(){var e,t={init:function(t,n,e){return this.receiveMessage(function(e){n.call(t,e)},e),this},postMessage:function(e,t,n){t&&(n=n||parent).postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))},receiveMessage:function(t,n){t&&(e=function(e){"string"==typeof n&&e.origin!==n||"[object Function]"===Object.prototype.toString.call(n)&&!1===n(e.origin)||("function"!=typeof n||n(e.data))&&t(e)}),window.addEventListener?window[t?"addEventListener":"removeEventListener"]("message",e,!1):window[t?"attachEvent":"detachEvent"]("onmessage",e)}};return t}t.exports=i},{}],35:[function(T,e,t){function n(){var e=T("./Inventory.js"),r={},t=[],n,i;function a(){i=4}function o(){if(C())return Math.max(1,n-1)}function s(){if(0!==Object.keys(r).length)return r[o()]}function d(e){return C()&&D()?e?r[e].size():r[o()].size():0}function l(e){return C()&&D()?e?r[e].getOffers():r[o()].getOffers():[]}function c(){Array.isArray(t)&&t.length>i&&delete r[t.shift()]}function u(e,t){if(Array.isArray(e)&&0!==e.length){var n=void 0!==t?t:A();void 0===r[n]&&(n=A());for(var i=0;i<e.length;i++)e[i].inventoryId=n;return r[n].setOffers(e),n}}function f(e){if(C()&&D())return e?r[e].getCurrentOffer():r[o()].getCurrentOffer()}function g(e,t){if(C()&&D())return t?r[t].removeOfferById(e):r[o()].removeOfferById(e)}function p(e,t){if(C()&&D())return t?r[t].getOfferById(e):r[o()].getOfferById(e)}function v(e,t,n){if(C()&&D())return n?r[n].replaceOfferById(e,t):r[o()].replaceOfferById(e,t)}function m(e){return!(!C()||!D())&&(e?r[e].isNextOfferAvailable():r[o()].isNextOfferAvailable())}function h(e){return!C()||!D()||(e?r[e].isEmpty():r[o()].isEmpty())}function b(){t=[],r={},n=void 0}function S(e){var t=void 0!==e?e:o();t&&r[t]&&delete r[t]}function y(){return r}function A(){return r[n=n||1]=new e(n),t.push(n),n++,c(),n-1}function C(){return 0!==t.length&&void 0!==n}function D(){return void 0!==r[o()]}function I(){return i}function w(){return n}a();var P={getOffers:l,getCurrentOffer:f,getOfferById:p,setOffers:u,removeOfferById:g,replaceOfferById:v,isNextOfferAvailable:m,isEmpty:h,size:d,reset:b,getActiveInventoryId:o,getActiveInventory:s,removeInventory:S,getInventories:y,getAmountOfInventoriesAllowed:I,getAvailableInventoryId:w};return P}e.exports=n},{"./Inventory.js":31}],36:[function(e,t,n){t.exports=function(l,c,u,f){var g={successCallbackPrefix:"scallback_",failureCallbackPrefix:"fcallback_",ssaSchemePrefix:"supersonicads",acknowledgeMessage:"acknowledgeMessage",CB:"NativeCallback"};function d(e,t,n,i){if(c.Utils.isString(e)&&""!==e&&l){l.DemandUtils&&l.RewardedVideo&&t&&(t=l.DemandUtils.setManualRewardedVideoTypeForNative(t));var r=c.Utils.isDefined(n)&&c.Utils.isString(n)?n:"",a=c.Utils.isDefined(i)&&c.Utils.isString(i)?i:"";(o={eventName:e,parameters:f.extend({success:r,fail:a},t)}).prefix=g.ssaSchemePrefix,c.Utils.isDefined(o.parameters)||(o.parameters={}),f.extend(o.parameters,{acknowledgeWith:c.Utils.isDefined(s)?s:g.acknowledgeMessage,declineWith:c.Utils.isDefined(d)?d:"errorTest"}),u.postMessage(o)}var o,s,d}function p(){return Date.now()+""+Math.random()}return{callSDKFunction:d,callSDKService:function(e,t,n,i,r){n&&(n.functionName=t),d(e,n,i,r)},callSDKFunctionWithCallback:function(t,e,n,i){if(l.log("NativeAPIAdapter | _callSDKFunctionWithCallback | Native API: "+t),c.Utils.isFunction(n)||c.Utils.isFunction(i)){var r=g.successCallbackPrefix+p(),a=g.failureCallbackPrefix+p(),o=c.PubSub.subscribe(g.CB+"."+r,function(e){c.PubSub.unsubscribe(o),c.PubSub.unsubscribe(s),n(e)}),s=c.PubSub.subscribe(g.CB+"."+a,function(e){l.log("NativeAPIAdapter | callSDKFunctionWithCallback | received failure callback for function: "+a),e&&e.errMsg&&l.log("Error calling "+t,l.LogLevels.error),c.PubSub.unsubscribe(s),c.PubSub.unsubscribe(o),i(e)});d(t,e,r,a)}else l.log("NativeAPIAdapter | failed to call sdk function - no callbacks parameters")},acknowledgeMessage:function(e){u.acknowledgeMessage(e)}}}},{}],37:[function(e,t,n){t.exports={CB:"NativeCallback",serviceCallback:"serviceCallback",NativeAPI:{onNativeLifeCycleEvent:"onNativeLifeCycleEvent"},AndroidEvents:{onStart:"onStart",onResume:"onResume",onPause:"onPause",onStop:"onStop",onDestroy:"onDestroy"}}},{}],38:[function(c,e,t){e.exports=function(e,i,t){var r="LifeCycleEventsService | ",n=c("./NativeLifeCycleEventsConstants.js"),a=i.jQuery(),o=[],s=new(c("./AndroidLifeCycleEventHandlers.js"))(e,i,t);function d(){e.PubSub.subscribe(n.CB+"."+n.NativeAPI.onNativeLifeCycleEvent,function(e){var t,n;i.log(r+"received new event: "+JSON.stringify(e)),e&&(t=e.lifeCycleEvent,n=e,l(t)&&s.publishEvent(t,n))})}function l(e){return e&&-1<a.inArray(e,o)}return{init:function(){d()},startNotify:function(e){i.log(r+"startNotify | event: "+e),l(e)||o.push(e)},stopNotify:function(e){i.log(r+"stopNotify | event: "+e),l(e)&&o.splice(a.inArray(e,o),1)}}}},{"./AndroidLifeCycleEventHandlers.js":6,"./NativeLifeCycleEventsConstants.js":37}],39:[function(r,e,t){e.exports=function(n,i){return{create:function(e){var t=e.deviceOs;return t===i.deviceOs.ios&&null===e.safeAreaInsets?new(r("../patches/PatchesIphoneX.js"))(n,e,i):new(r("./NotchService.js"))(n,e.safeAreaInsets,i,t)}}}},{"../patches/PatchesIphoneX.js":169,"./NotchService.js":40}],40:[function(e,t,n){t.exports=function(e,t,n,i){var r=!1;function a(){return i!==n.deviceOs.android&&r}return function(){if(i!==n.deviceOs.android){var e=n.notchSettings.safeAreaInsetsMin;r=t.top>e||t.bottom>e||t.right>e||t.left>e}}(),{hasNotch:a,onEngageEnd:function(){i!==n.deviceOs.android&&a()},onSetConfig:function(e){return i!==n.deviceOs.android&&a()&&(t=e).settings&&t.settings.standaloneView;var t},className:"NotchService"}}},{}],41:[function(e,t,n){t.exports={omidControllerFunction:"omidAPIController",omidNativeFunction:"omidAPI",activateSuccessKey:"omidActivateSuccess",activateFailKey:"omidActivateFail",startSessionSuccessKey:"omidStartSessionSuccess",startSessionFailKey:"omidStartSessionFail",finishSessionSuccessKey:"omidFinishSessionSuccess",finishSessionFailKey:"omidFinishSessionFail",impressionOccurredSuccessKey:"omidimpressionOccurredSuccess",impressionOccurredFailKey:"omidimpressionOccurredFail",getOmidDataSuccessKey:"omidGetDataSuccess",getOmidDataFailKey:"omidGetDataFail",startSession:"startSession",finishSession:"finishSession",impressionOccurred:"impressionOccurred",omidFailedToLoadBundleMessage:"Failed to load OMID JS Bundle",omidFailedToDownloadMessage:"Failed to download and cache OMID JS Bundle",omidFailureInStartSession:"Failure in starting session",omidFailureInFinishSession:"Failure in finishing session",omidFailureInImpressionOccurred:"Failure in impression occurred",omidAdIdNotFound:" omidParams no contain adViewId. ",omidPromiseIsPending:"promise is still pending",omidStartSessionAlreadyStarted:"omid ad session is already started",omidSessionNotStarted:"session not started",omidProductTypeNotSupported:" omidParams container unsupported product type = ",omidproductTypeNotFound:" omidParams no contain product type. ",omidBundleFilePrefix:"omid-daemon-",omidBundleFileType:".js",stopOMIDServiceDelay:1e3,omidPartnerName:"Ironsrc",omidPartnerVersion:"6",omidServiceName:"omid",omidBundleDefaultVersionKey:"default",omidVersionMapping:{"1.2.22-Ironsrc":"1.0.0","1.3.12-Ironsrc":"1.3.12",default:"1.0.0"},omidVersionRequiresWebviewPerAd:{"1.2.22-Ironsrc":!1,"1.3.12-Ironsrc":!0,default:!1},omidVersionIsControllerDownloadOMSDK:{"1.2.22-Ironsrc":!0,"1.3.12-Ironsrc":!1,default:!1}}},{}],42:[function(O,e,t){O("./OMIDConstants");e.exports=function(d,l,c){var r,e=O("./OmidHelper"),u=O("./OmidAdSession"),f=new e(d,l,c),a=O("./Constants.js"),g=O("./OMIDConstants"),p=!1,v="",o=a.omidPartnerVersion,s="",t=null,m=null,i=null,h={};function n(){if(!p){if(m&&"pending"===m.state())return m;m=new c.Deferred,l.log("OMIDService - activate",l.LogLevels.verbose);var n=d.PubSub.subscribe(a.CB+"."+g.activateSuccessKey,function(e){var t;v=e&&e.omidVersion?e.omidVersion:"",o=e&&e.omidPartnerVersion?e.omidPartnerVersion:a.omidPartnerVersion,p=!0,d.PubSub.clearHandlers([n,i]),d.PubSub.subscribe("SDKController.OMIDStartSession",function(e){!f.isSupportingMultipleAdSession()&&e.adViewId&&(e.webViewid=e.adViewId),function(e){f.fireNonFailureEvent("SDKController.onOmidStartSessionRequired",e,v);var t=new c.Deferred,n=f.isActivated(A(),p,g.startSession,v);if(!n.result)return this.core.PubSub.publish("SDKController.onOmidServiceFailure",[n.reason]),t.reject(n.reason);var i=f.validateStartSessionParams(e,v);if(!i.result)return this.core.PubSub.publish("SDKController.onOmidServiceFailure",[i.reason]),t.reject(i.reason);var r=f.validateAdViewId(e,g.impressionOccurred,v);if(!r.result)return this.core.PubSub.publish("SDKController.onOmidServiceFailure",[r.reason]),t.reject(r.reason);var a=e&&e.adViewId,o=h[a],s="";o&&"pending"===o.getStartPromise().state()?(s=f.getErrorMsgPromiseIsPending(g.startSession,v,e),d.PubSub.publish("SDKController.onOmidServiceFailure",[s]),o.getStartPromise()):o&&o.isSessionStarted()?(s=f.getErrorStartSessionAlreadyStarted(g.startSession,v,e),d.PubSub.publish("SDKController.onOmidServiceFailure",[s]),d.Utils.returnRejectedPromise(s)):function(e,t,n,i){l.log("OMIDService - startSession",l.LogLevels.verbose);var r=new u(d,l,c,t,e);!f.isSupportingMultipleAdSession()&&i.webViewid&&(r.setWebViewId(i.webViewid),i.adViewId=r.webViewId),(h[e]=r).setStartPromise(n),l.callSDKFunction(g.omidNativeFunction,{omidFunction:g.startSession,omidParams:i},g.startSessionSuccessKey,g.startSessionFailKey),r.getStartPromise()}(a,e.productType,t,e)}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe("SDKController.OMIDImpressionOccurred",function(e){!function(e){var t=new c.Deferred,n=f.isActivated(A(),p,g.impressionOccurred,v);if(!n.result)return t.reject(n.reason);var i=S(e,g.impressionOccurred,v);if(!i.adSession)return d.PubSub.publish("SDKController.onOmidServiceFailure",[i.reason]),t.reject(i.reason);var r=i.adSession;if(r.getImpressionPromise()&&"pending"===r.getImpressionPromise().state()){var a=f.getErrorMsgPromiseIsPending(g.impressionOccurred,v,e);return d.PubSub.publish("SDKController.onOmidServiceFailure",[a]),r.getImpressionPromise()}r.setImpressionPromise(t),l.callSDKFunction(g.omidNativeFunction,{omidFunction:g.impressionOccurred,omidParams:e},g.impressionOccurredSuccessKey,g.impressionOccurredFailKey),r.getImpressionPromise()}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe("SDKController.OMIDFinishSession",function(e){b(e=f.setAdViewIdForOldOmidVersions(e,v))}),t=C(v),s=r.getExternalLibrariesUrl()+g.omidServiceName+"/"+t+"/"+g.omidServiceName+g.omidBundleFileType,l.log(g.omidNativeFunction+" activate success: "+JSON.stringify(e),l.LogLevels.verbose),m.resolve()}),i=d.PubSub.subscribe(a.CB+"."+g.activateFailKey,function(e){d.PubSub.clearHandlers([n,i]);var t=e&&e.errMsg?e.errMsg:"";l.log(g.omidNativeFunction+" activate session fail: "+JSON.stringify(e),l.LogLevels.verbose),d.PubSub.publish("SDKController.onOmidServiceFailure",[t]),m.reject()});return l.callSDKFunction(g.omidNativeFunction,{omidFunction:"activate",omidParams:{}},g.activateSuccessKey,g.activateFailKey),m.promise()}l.log("OMIDService - activate OMID is already initialized",l.LogLevels.verbose)}function b(e){f.fireNonFailureEvent("SDKController.onOmidFinishSessionRequired",e,v),l.log("OMIDService - finishSession",l.LogLevels.verbose);var t=new c.Deferred,n=f.isActivated(A(),p,g.finishSession,v);if(!n.result)return t.reject(n.reason),t;var i=S(e,g.finishSession,v);if(!i.adSession)return d.PubSub.publish("SDKController.onOmidServiceFailure",[i.reason]),t.reject(i.reason),t;var r=i.adSession;if(!r.isSessionStarted()){var a=f.getErrorMsgSessionNotStarted(g.finishSession,v,e);return d.PubSub.publish("SDKController.onOmidServiceFailure",[a]),t.reject(a),t}if(r.getFinishPromise()&&"pending"===r.getFinishPromise().state()){var o=f.getErrorMsgPromiseIsPending(g.finishSession,v,e);return d.PubSub.publish("SDKController.onOmidServiceFailure",[o]),r.getFinishPromise()}return r.setFinishPromise(t),l.callSDKFunction(g.omidNativeFunction,{omidFunction:g.finishSession,omidParams:e},g.finishSessionSuccessKey,g.finishSessionFailKey),r.getFinishPromise()}function S(e,t,n){var i=f.validateAdViewId(e,g.impressionOccurred,n);if(!i.result)return{reason:i.reason};var r=e.adViewId,a=h[r];return a?{adSession:a,reason:null}:{reason:"adSession not found for adViewId = "+r}}function y(){return g.omidVersionIsControllerDownloadOMSDK[v]?g.omidVersionIsControllerDownloadOMSDK[v]:g.omidVersionIsControllerDownloadOMSDK[g.omidBundleDefaultVersionKey]}function A(){return!y()||window.OmidDaemon&&"function"==typeof window.OmidDaemon.start&&"function"==typeof window.OmidDaemon.stop}function C(e){var t=g.omidVersionMapping[e];return t||(t=g.omidVersionMapping[g.omidBundleDefaultVersionKey],l.log("OMID.Service.Warnnig: version from mapping not found .choose.default - "+t)),t}function D(){return p?s:""}function I(){d.PubSub.subscribe(a.CB+"."+g.startSessionSuccessKey,function(e){!function(e){if(h[e.adViewId]){var t=h[e.adViewId];t.getStartPromise().resolve(),l.log(g.omidNativeFunction+" Start session success | adViewId = "+t.adViewId,l.LogLevels.verbose),f.fireNonFailureEvent("SDKController.onOmidStartSessionSuccess",t.getDescription(),v)}else l.log("Error: missing adViewId in start session success callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe(a.CB+"."+g.startSessionFailKey,function(e){!function(e){if(e.adViewId||(e.adViewId="1"),h[e.adViewId]){var t=e&&e.errMsg?e.errMsg:"";h[e.adViewId].getStartPromise().reject(t),T(),l.log(g.omidNativeFunction+" Start session fail: "+JSON.stringify(e),l.LogLevels.verbose),d.PubSub.publish("SDKController.onOmidServiceFailure",[t])}else l.log("Error: missing adViewId in start session success callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe(a.CB+"."+g.impressionOccurredSuccessKey,function(e){var t;e=f.setAdViewIdForOldOmidVersions(e,v),t=e,l.log(g.omidNativeFunction+" Impression Occurred success: "+JSON.stringify(t),l.LogLevels.verbose),t.adViewId||(t.adViewId="1"),h[t.adViewId]?h[t.adViewId].getImpressionPromise().resolve():l.log("Error: missing adViewId in impression Occurred success session callback")}),d.PubSub.subscribe(a.CB+"."+g.impressionOccurredFailKey,function(e){!function(e){l.log(g.omidNativeFunction+" Impression Occurred fail: "+JSON.stringify(e),l.LogLevels.verbose);var t=e&&e.errMsg?e.errMsg:"";d.PubSub.publish("SDKController.onOmidServiceFailure",[t]),e.adViewId||(e.adViewId="1"),h[e.adViewId]?h[e.adViewId].getImpressionPromise().reject():l.log("Error: missing adViewId in impression Occurred fail session callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe(a.CB+"."+g.finishSessionSuccessKey,function(e){!function(e){if(l.log(g.omidNativeFunction+" Finish session success: "+JSON.stringify(e),l.LogLevels.verbose),e.adViewId||(e.adViewId="1"),h[e.adViewId]){var t=h[e.adViewId];t.getFinishPromise().resolve(),f.fireNonFailureEvent("SDKController.onOmidFinishSessionSuccess",t.getDescription(),v),delete h[t.adViewId]}else l.log("Error: missing adViewId in finish session success callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe(a.CB+"."+g.finishSessionFailKey,function(e){!function(e){if(l.log(g.omidNativeFunction+" Finish session fail: "+JSON.stringify(e),l.LogLevels.verbose),e.adViewId||(e.adViewId="1"),h[e.adViewId]){var t=h[e.adViewId];T();var n=e&&e.errMsg?e.errMsg:"";d.PubSub.publish("SDKController.onOmidServiceFailure",[n]),t.getFinishPromise().reject(n),delete h[t.adViewId]}else l.log("Error: missing adViewId in finish session success callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))})}function w(){l.log("SDKController.onLoadSuccessOmidBundle"),window.OmidDaemon&&window.OmidDaemon.start({partnerName:g.omidPartnerName,partnerVersion:o})}function P(){l.log("SDKController.onLoadFailureOmidBundle"),d.PubSub.publish("SDKController.onOmidServiceFailure",[g.omidFailedToLoadBundleMessage])}function T(){window.OmidDaemon&&window.OmidDaemon.reset()}return{isSupported:function(e,t){return(n=e)&&n.omidEnabled;var n},isNativeServiceActivated:function(){return p},getVersionData:function(){return{omidVersion:v,omidPartnerVersion:o}},finishSession:function(e){e=f.setAdViewIdForOldOmidVersions(e,v);var t=c.Deferred();return h[e.adViewId]?b(e).then(function(){t.resolve(!0)}).fail(t.reject):t.resolve(!1),t.promise()},isAdOmidSupported:function(e,t){return!!((n=e)&&n.ext&&n.ext.ivt&&n.ext.ivt.omid)&&f.isProductSupported(e.productType||t);var n},downloadOmidJsBundle:function(){if(!p)return d.Utils.returnResolvedPromise();if(y()&&A())return d.Utils.returnResolvedPromise();if(t&&"rejected"!==t.state())return t;t=new c.Deferred;var e=D();return l.libsManager.updateFileVersionByFilePathForThirdPartyLibraries(g.omidServiceName,e,C(v)).then(l.libsManager.manageDownloadLibsFileByFiletype.bind(null,g.omidServiceName)).then(function(){!function(){var e=r.getCacheLibsPath()+g.omidServiceName+g.omidBundleFileType,t=y();if(A()||!o||!t)return d.Utils.returnResolvedPromise();d.Utils.getScript(e,w,P)}(),t.resolve()},function(){d.PubSub.publish("SDKController.onOmidServiceFailure",[g.omidFailedToDownloadMessage]),t.reject()}),d.Utils.returnResolvedPromise()},init:function(e){r=e,I(),n()},getOmidBundleUrl:D,getOmidData:function(){if(i=new c.Deferred,!p)return l.log("cannot get omid data beacuse omid service not activated"),i.reject(),i;var t=d.PubSub.subscribe(a.CB+"."+g.getOmidDataSuccessKey,function(e){d.PubSub.clearHandlers([t,n]),i.resolve(e)}),n=d.PubSub.subscribe(a.CB+"."+g.getOmidDataFailKey,function(e){l.log("_onGetOmidDataFail: "+JSON.stringify(e),l.LogLevels.verbose),d.PubSub.clearHandlers([t,n]),i.reject()});return l.callSDKFunction(g.omidNativeFunction,{omidFunction:"getOmidData",omidParams:{}},g.getOmidDataSuccessKey,g.getOmidDataFailKey),i.promise()}}}},{"./Constants.js":13,"./OMIDConstants":41,"./OmidAdSession":44,"./OmidHelper":45}],43:[function(e,t,n){t.exports=function(){var i,r={iframe:"#adSandbox",url:"",adData:"",templateClass:"obfuscationIframe",src:"{{url}}",frameBorder:"0",scrolling:"no",style:{},id:""},a={};return{init:function(e,t){if((a=jQuery.extend(r,e)).adData&&""!==a.adData){var n=a.src.replace("{{url}}",a.url);(i=jQuery("<iframe />",{id:a.id,class:a.templateClass,src:n,scrolling:a.scrolling,frameborder:a.frameBorder}).css(a.style)).on("load",function(){t(i)}),document.documentElement.appendChild(i[0])}},removeIframe:function(e){if(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}}}}},{}],44:[function(e,t,n){var i=function(){function e(e,t,n,i,r){void 0===i&&(i=""),void 0===r&&(r="1"),this.core=e,this.controller=t,this.jQuery=n,this.productType=i,this.adViewId=r,this.startPromise=null,this.finishPromise=null,this.impressionPromise=null,this.webViewId=""}return e.prototype.setWebViewId=function(e){this.webViewId=e},e.prototype.setStartPromise=function(e){this.startPromise=e},e.prototype.setImpressionPromise=function(e){this.impressionPromise=e},e.prototype.setFinishPromise=function(e){this.finishPromise=e},e.prototype.getImpressionPromise=function(){return this.impressionPromise},e.prototype.getFinishPromise=function(){return this.finishPromise},e.prototype.isSessionStarted=function(){return this.startPromise&&"resolved"===this.startPromise.state()},e.prototype.isSessionFinished=function(){return this.finishPromise&&"resolved"===this.finishPromise.state()},e.prototype.getStartPromise=function(){return this.startPromise},e.prototype.getDescription=function(){return{productType:this.productType,adViewId:this.adViewId}},e}();t.exports=i},{}],45:[function(e,t,n){var i=e("./Constants.js"),a=e("./OMIDConstants"),r=e("../constants/SDKFeatureNames"),o=function(){function e(e,t,n){this.core=e,this.controller=t,this.jQuery=n}return e.prototype.validateStartSessionParams=function(e,t){var n={result:!0};return e.adType||(n={result:!1,reason:a.omidControllerFunction+" | "+a.omidFailureInStartSession+" | "+a.omidproductTypeNotFound+" | omidVersion= "+t}),this.isProductSupported(e.adType)||(n={result:!1,reason:a.omidControllerFunction+" | "+a.omidFailureInStartSession+" | "+a.omidProductTypeNotSupported+e.adType+" | omidVersion= "+t}),n},e.prototype.setAdViewIdForOldOmidVersions=function(e,t){return this.isSupportingMultipleAdSession()||((e=e||{}).adViewId="1"),e},e.prototype.isSupportingMultipleAdSession=function(){return this.controller.CompatibilityService.isFeatureSupportedInNativeSDK(r.bannersOpenMeasurement)},e.prototype.validateAdViewId=function(e,t,n){var i={result:!0};if(!e||!e.adViewId){var r=this.getFlowMsg(t);i={result:!1,reason:a.omidControllerFunction+" | "+r+" | "+a.omidAdIdNotFound+" | omidVersion= "+n}}return i},e.prototype.getFlowMsg=function(e){var t,n=((t={})[a.startSession]=a.omidFailureInStartSession,t[a.finishSession]=a.omidFailureInFinishSession,t[a.impressionOccurred]=a.omidFailureInImpressionOccurred,t.default="unknown flow: ",t);return n[e]||n.default+e},e.prototype.getErrorStartSessionAlreadyStarted=function(e,t,n){return a.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+a.omidStartSessionAlreadyStarted+" | omidVersion= "+t+" | productType= "+n.productType||""},e.prototype.getErrorMsgPromiseIsPending=function(e,t,n){return a.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+a.omidPromiseIsPending+" | omidVersion= "+t+" | productType= "+n.productType||""},e.prototype.getErrorMsgSessionNotStarted=function(e,t,n){return a.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+a.omidSessionNotStarted+" | omidVersion= "+t+" | productType= "+n.productType||""},e.prototype.isActivated=function(e,t,n,i){var r={result:!0};e&&t||(r={result:!1,reason:a.omidControllerFunction+" | "+this.getFlowMsg(n)+" |  didLoadOMSDKService "+e+" omidServiceActivated "+t+" | omidVersion= "+i});return r},e.prototype.fireNonFailureEvent=function(e,t,n){var i="adViewId= "+(a.omidVersionRequiresWebviewPerAd[n]?"1":t.adViewId||"")+" | productType= "+(t.productType||"");this.core.PubSub.publish(e,[i])},e.prototype.isProductSupported=function(e){return!!e&&(e!==i.BN||this.controller.CompatibilityService.isFeatureSupportedInNativeSDK(r.bannersOpenMeasurement))},e}();t.exports=o},{"../constants/SDKFeatureNames":91,"./Constants.js":13,"./OMIDConstants":41}],46:[function(e,t,n){t.exports=function(o){var s=e("./Constants.js");return{open:function(e){if(e&&e.type){if("openUrl"!==e.type)return!1;var t,n=e.callback;e.method||(o.getApiData({deviceOs:1}).deviceOs===s.deviceOs.ios?e.appId?e.method=s.openUrlMethods.storeKit:e.method=s.openUrlMethods.external_browser:e.method=s.openUrlMethods.store);var i=(r=e,(a={default:{}})[s.openUrlMethods.storeKit]={appId:r.appId,viewUniqueId:o.StoreKitService.getViewUniqueId(r)},a[s.openUrlMethods.external_browser]={},a[s.openUrlMethods.store]={},a[s.openUrlMethods.webview]={controls:!0},a[r.method]||a.default);return t=jQuery.extend({url:e.url,method:e.method},i),o.openUrl(t,n),!0}var r,a;return!1},openForOW:function(e){if(e&&e.type&&"openUrl"===e.type){var t={},n=e.callback;return t=e.externalBrowser?{url:e.url,controls:!0,method:"external_browser"}:e.method===s.openUrlMethods.external_browser?{url:e.url,method:"external_browser"}:e.install?"ios"===o.getApiData({deviceOs:1}).deviceOs?{url:e.url,controls:!0,method:"external_browser"}:{url:e.url,controls:!0,method:"store"}:{url:e.url,controls:!0,method:"webview"},o.openUrl(t,n),!0}return!1}}}},{"./Constants.js":13}],47:[function(e,t,n){t.exports={NativeAPI:{failCallback:"handleAppOrientationDataFailed",successCallback:"handleAppOrientationDataSuccess",oldApiSuccessCallback:"getOrientationSuccess"},ControllerNativeAPI:{getAppOrientationData:"getAppOrientationData",oldSetOrientation:"setOrientation",oldGetOrientation:"getOrientation",setAppOrientation:"setAppOrientation"},eventicsCategories:{failCallback:{name:"AppOrientationFailed",id:263},successCallback:{name:"AppOrientationSuccess",id:264}},iosOrientationsMap:{UIInterfaceOrientationPortrait:2,UIInterfaceOrientationPortraitUpsideDown:4,UIInterfaceOrientationLandscapeLeft:16,UIInterfaceOrientationLandscapeRight:8},iosOrientations:{2:"Portrait",4:"PortraitUpsideDown",16:"LandscapeLeft",8:"LandscapeRight"},appOrientationAPI:"appOrientationAPI"}},{}],48:[function(e,t,n){t.exports=function(a,t,o){var n,s=e("./OrientationConstants.js"),i=!1,d=o.CB;function r(e){t.log("_setAppOrientation | send orientation: "+e,t.LogLevels.info),t.callSDKFunction(s.ControllerNativeAPI.setAppOrientation,{appOrientation:e})}return{init:function(e){i||(a.PubSub.subscribe(d+"."+s.NativeAPI.successCallback,function(e){n.trackEvent(s.eventicsCategories.successCallback),e||(t.log("getAppOrientationData | Orientation data structure not exist.",t.LogLevels.info),n.trackEvent(s.eventicsCategories.failCallback))}),a.PubSub.subscribe(d+"."+s.NativeAPI.failCallback,function(e){t.log("getAppOrientationData failed, errorMsg:"+e.errMsg,t.LogLevels.info),n.trackEvent(s.eventicsCategories.failCallback)}),a.PubSub.subscribe("AppOrientationManager.appOrientationChanged",function(e){e&&e.appOrientation&&(t.log("appOrientationChanged | updating native with orientation: "+e.appOrientation,t.LogLevels.info),r(e.appOrientation))}),n=e,i=!0)},getAppOrientationData:function(){t.callSDKFunction(s.ControllerNativeAPI.getAppOrientationData,{},s.NativeAPI.successCallback,s.NativeAPI.failCallback)},setOrientation:function(e){t.callSDKFunction(s.ControllerNativeAPI.oldSetOrientation,{orientation:e})},oldGetOrientation:function(){var n=new jQuery.Deferred,i=a.PubSub.subscribe(d+"."+s.NativeAPI.oldApiSuccessCallback,function(e){if(a.PubSub.unsubscribe(i),"resolved"!==n.state()){clearTimeout(r);var t=e&&e.orientation||o.appInfo.orientation.portrait;n.resolve(t)}}),r=setTimeout(function(){n.resolve(o.appInfo.orientation.portrait)},2e3);return t.callSDKFunction(s.ControllerNativeAPI.oldGetOrientation,null,s.NativeAPI.oldApiSuccessCallback,s.NativeAPI.oldApiSuccessCallback),n.promise()},setAppOrientation:r}}},{"./OrientationConstants.js":47}],49:[function(e,t,n){t.exports=function(){var a=e("./OrientationConstants.js");function o(e){var t=parseInt(e.replace(/^"|"$/g,"")),n=[],i=t.toString(2);if(i.length>Object.keys(a.iosOrientations).length+1||"0"!==i.substr(i.length-1,1))return[];for(var r in a.iosOrientations)(t|r)===t&&n.push(a.iosOrientations[r]);return n}var t=function(t,e){return e.some(function(e){return 0<=t.indexOf(e)})};return{convertOrientationsArrayToNumber:function(e){var i=0;return e.forEach(function(e){var t,n;i+=Number((t=a.iosOrientations,n=e,Object.keys(t).filter(function(e){return t[e]===n})))}),i},convertNumberToOrientations:o,isContainPortrait:function(e){return t(o(e),[a.iosOrientations[2],a.iosOrientations[4]])},isContainLandscape:function(e){return t(o(e),[a.iosOrientations[8],a.iosOrientations[16]])},sharedOrientationBetweenOrientations:function(e,t){var n=o(e),i=o(t),r=n.filter(function(e){return-1<i.indexOf(e)});return r||(r=[]),r}}}},{"./OrientationConstants.js":47}],50:[function(e,t,n){t.exports=function(r,a){var i,o=e("./Constants.js"),s=e("./PermissionsConstants.js"),d=s.nativeFunction,l={};return{getPermissions:function(){if(i&&"pending"===i.status)return i;i=new jQuery.Deferred;var e,t=r.PubSub.subscribe(o.CB+"."+s.handleGetPermissionsSuccess,function(e){a.log(s.handleGetPermissionsSuccess+": "+JSON.stringify(e)),r.PubSub.unsubscribe(t),r.PubSub.unsubscribe(n),i.resolve(e)}),n=r.PubSub.subscribe(o.CB+"."+s.handleGetPermissionsFailure,function(e){a.log(s.handleGetPermissionsFailure+": "+JSON.stringify(e)),r.PubSub.unsubscribe(n),r.PubSub.unsubscribe(t),i.reject(e)});return a.callSDKFunction(s.nativeFunction,{functionName:s.NativeAPI.getPermissions,functionParams:(e=a.getConfig().mobileSDKSettings.deviceOs===o.deviceOs.ios?o.deviceOs.ios:o.deviceOs.android,{permissions:s.supportedPermissions[e]})},s.handleGetPermissionsSuccess,s.handleGetPermissionsFailure),i.promise()},isPermissionGranted:function(e){if(!e)return!1;if(l[e]&&"pending"===l[e].status)return l[e];l[e]=new jQuery.Deferred;var n=r.PubSub.subscribe(o.CB+"."+s.handleIsPermissionGrantedSuccess,function(e){if(e&&e.permission){var t=e.permission;l[t]?(a.log(s.handleIsPermissionGrantedSuccess+": "+JSON.stringify(e)),r.PubSub.unsubscribe(n),r.PubSub.unsubscribe(i),l[t].resolve(e)):a.log("Unrecognised permission name "+t,a.LogLevels.error)}}),i=r.PubSub.subscribe(o.CB+"."+s.handleIsPermissionGrantedFailure,function(e){if(e&&e.permission){a.log(d+s.NativeAPI.isPermissionGranted+JSON.stringify(e),a.LogLevels.verbose);var t=e.permission;l[t]?(r.PubSub.unsubscribe(i),r.PubSub.unsubscribe(n),l[t].reject(e)):a.log("Unrecognised permission name "+t,a.LogLevels.error)}else e&&e.errMsg&&a.log("Error calling isPermissionGranted "+e.errMsg,a.LogLevels.error)});return a.callSDKFunction(s.nativeFunction,{functionName:s.NativeAPI.isPermissionGranted,functionParams:{permission:e}},s.handleIsPermissionGrantedSuccess,s.handleIsPermissionGrantedFailure),l[e].promise()}}}},{"./Constants.js":13,"./PermissionsConstants.js":51}],51:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{getPermissions:"getPermissions",isPermissionGranted:"isPermissionGranted"},nativeFunction:"permissionsAPI",supportedPermissions:{ios:["NSCameraUsageDescription","NSLocationAlwaysUsageDescription","NSLocationWhenInUseUsageDescription","NSLocationAlwaysAndWhenInUseUsageDescription","NSMicrophoneUsageDescription"],android:[]},handleGetPermissionsSuccess:"handleGetPermissionsSuccess",handleGetPermissionsFailure:"handleGetPermissionsFailure",handleIsPermissionGrantedSuccess:"handleIsPermissionGrantedSuccess",handleIsPermissionGrantedFailure:"handleIsPermissionGrantedFailure"}},{}],52:[function(e,t,n){t.exports=function(n){return{firePixel:function(e){if(void 0!==e.url&&""!==e.url){if("pixel"===e.type){var t=new Image;""===e.at||isNaN(parseInt(e.at))?t.src=e.url:(t.src=e.url,t.time=e.at)}}else n.log("Missing callback data. At: directive ssaPixel"+(new Date).getTime(),n.LogLevels.info)}}}},{}],53:[function(e,t,n){function i(r){var a={},n,o,e={init:function(){o=jQuery,n=this},publish:function(t,e){o=o||jQuery;try{var n=o.extend(!0,[],a[t]);o.each(n,function(){this.apply(o,e||[])})}catch(e){if(r.Utils.isDefined(e)){r.log({type:"in PubSub "+t,data:e.message,trace:e.stack});var i={name:e.name,message:e.stack};window.onerror(e.name+": "+e.message,null,null,null,i)}}},subscribe:function(e,t){return a[e]||(a[e]=[]),a[e].push(t),[e,t]},unsubscribe:function(t){if(t){var n=t[0];a[n]&&o.each(a[n],function(e){a[n][e]===t[1]&&a[n].splice(e,1)})}},subscribeOnce:function(e,t){var n=this,i=this.subscribe(e,function(){t(),n.unsubscribe(i)})},clearHandlers:function(e){jQuery.each(e,function(e,t){n.unsubscribe(t)})}};return e}t.exports=i},{}],54:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{startListenerSuccessKey:"startListenerSuccess",startListenerFailKey:"startListenerFailed",stopListenerSuccessKey:"stopListenerSuccess",stopListenerFailKey:"stopListenerFailed",initSuccessKey:"initSuccess",initFailKey:"initFailed",statusChanged:"ringerSwitchStatusChanged"},ControllerNativeAPI:{startListener:"startListener",stopListener:"stopListener",init:"init"},eventicsCategories:{startListenerFail:{name:"startListenerFail",id:263},stopListenerFail:{name:"stopListenerFail",id:264},initFail:{name:"initRingerFail",id:265}},notifyAdunitOnState:"ringerSwitchState",ringerNativeFunction:"ringerSwitchAPI"}},{}],55:[function(e,t,n){t.exports=function(t,n){var i,r,a,o=e("./RingerSwitchConstants.js"),s=!0,d=!1,l=1e3,c=!1;function u(e){n.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:e})}return{init:function(){var e;d||(t.PubSub.subscribe(o.CB+"."+o.NativeAPI.statusChanged,function(e){e&&(s=e.ringerSwitchSilent,c&&!s?r=setTimeout(function(){u(s)},i):(r&&clearTimeout(r),u(s)))}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerSuccessKey,function(e){n.log("Ringer | start detecting function performed successfully.",n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerFailKey,function(e){a.trackEvent(o.eventicsCategories.startListenerFail),e&&n.log("Ringer start detecting failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerSuccessKey,function(e){n.log("Ringer stop detecting successfully.",n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerFailKey,function(e){a.trackEvent(o.eventicsCategories.stopListenerFail),e&&n.log("Ringer stop detecting failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.initSuccessKey,function(e){n.log("Ringer prepare detector successfully.",n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.initFailKey,function(e){a.trackEvent(o.eventicsCategories.initFail),e&&n.log("Ringer prepare detector failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)}),n.log("Ringer | calling init native function",n.LogLevels.info),n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.init},o.NativeAPI.initSuccessKey,o.NativeAPI.initFailKey),e={productChance:(n.getEnv(),1),baseData:{}},a=t.Eventics.createEventic(e,n.EventsManager),d=!0)},startListener:function(e){n.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:s}),c=e&&e.shouldSetRingerUpdateDelay,i=e&&e.ringerUpdateDelay||l,n.log("Ringer | Set listener config to should delay?"+c+", with delay "+i,n.LogLevels.verbose),n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.startListener},o.NativeAPI.startListenerSuccessKey,o.NativeAPI.startListenerFailKey)},stopListener:function(){c=!1,i=l,n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.stopListener},o.NativeAPI.stopListenerSuccessKey,o.NativeAPI.stopListenerFailKey)},isInitiated:function(){return d}}}},{"./RingerSwitchConstants.js":54}],56:[function(e,t,n){t.exports=function(s,r,d){var a=e("../storeKit/SKANModel")(),l=e("../storeKit/SKANConstants"),o=e("../../constants/SDKFeatureNames");function c(e){if(!r.isIOS())return!1;var t,n=parseFloat(r.getConfig().mobileSDKSettings.deviceOSVersion)>=l.SKAdImpression.minimalSupportedIOSVersion,i=r.CompatibilityService.isFeatureSupportedInNativeSDK(o.SKAdImpression);return!!(n&&i&&(t=e).ext&&t.ext.SKANData&&t.ext.SKANData.VTA)}function u(e,t,n,i){r.callSDKService(l.SKAdImpression.jsInterface,e,{impressionData:a.extractDataForSKAdImpression(t)},n,i)}return{startImpression:function(e,t,n){if(e&&c(e)){var i=e.adViewId||Date.now(),r=l.SKAdImpression.startImpressionSuccess+"."+i,a=l.SKAdImpression.startImpressionFailed+"."+i,o=[];o.push(s.PubSub.subscribe(d.CB+"."+r,function(){s.PubSub.clearHandlers(o),s.Utils.isFunction(t)&&t()})),o.push(s.PubSub.subscribe(d.CB+"."+a,function(e){s.PubSub.clearHandlers(o),s.Utils.isFunction(n)&&n(e)})),u(l.SKAdImpression.startImpression,e,r,a)}},endImpression:function(e,t,n){if(e&&c(e)){var i=e.adViewId||Date.now(),r=l.SKAdImpression.endImpressionSuccess+"."+i,a=l.SKAdImpression.endImpressionFailed+"."+i,o=[];o.push(s.PubSub.subscribe(d.CB+"."+r,function(){s.PubSub.clearHandlers(o),s.Utils.isFunction(t)&&t()})),o.push(s.PubSub.subscribe(d.CB+"."+a,function(e){s.PubSub.clearHandlers(o),s.Utils.isFunction(n)&&n(e)})),u(l.SKAdImpression.endImpression,e,r,a)}}}}},{"../../constants/SDKFeatureNames":91,"../storeKit/SKANConstants":85,"../storeKit/SKANModel":86}],57:[function(e,t,n){var h=e("./SKOverlayConstants"),b=h.configKeys;t.exports=function(e,t,n,i,r,a,o){if(e&&t){var s,d=e,l=t,c=n||h.position.bottom,u=r||{},f=!!i,g=a||((s={})[h.delayConfigKeys.initialDelay]=0,s[h.delayConfigKeys.subsequentDelay]=0,s),p=o||h.flow.presentOnSKClose,v=null,m=null;return{getOverlayId:function(){return d},getAdvertisedAppId:function(){return l},getConfigObjectForSDK:function(){var e={};return e[b.overlayId]=d,e[b.advertisedAppId]=l,e[b.position]=c,e[b.userDismissible]=f,e[b.SKANData]=u,e},isQualityClickTriggered:function(){return v},setQualityClickTriggered:function(){v=!0},getDismissInitiatedSource:function(){return m},setDismissInitiatedSource:function(e){m=e},getPresentationDelay:function(e){return e?g[h.delayConfigKeys.initialDelay]:g[h.delayConfigKeys.subsequentDelay]},getFlow:function(){return p}}}}},{"./SKOverlayConstants":58}],58:[function(e,t,n){var i=e("../../components/Constants");t.exports={minimalSupportedIOSVersion:14,supportedProductTypes:[i.RV,i.IS],configKeys:{overlayId:"overlayId",advertisedAppId:"advertisedAppId",position:"position",userDismissible:"userDismissible",SKANData:"SKANData"},position:{bottom:0,bottomRaised:1},flow:{presentOnSKClose:0,presentOnSKCloseAndQC:1,presentOnAdVisible:2},externalConfigKeys:{enableSKOverlay:"enableSKOverlay",SKOverlayPosition:"SKOverlayPosition",SKOverlayUserDismissible:"SKOverlayUserDismissible",delayInSecToPresentSKOverlay:"delayInSecToPresentSKOverlay",SKOverlayFlow:"SKOverlayFlow"},delayConfigKeys:{initialDelay:"initialDelay",subsequentDelay:"subsequentDelay"},overlayDismissInitiatedType:{user:0,SKOpen:1,adClose:2},messages:{SDK:{incoming:{overlayCreated:"overlayCreated",overlayCreateFailed:"overlayCreateFailed",overlayLoadFailed:"overlayLoadFailed",overlayWillStartPresentation:"overlayWillStartPresentation",overlayDidFinishPresentation:"overlayDidFinishPresentation",overlayWillStartDismissal:"overlayWillStartDismissal",overlayDidFinishDismissal:"overlayDidFinishDismissal",overlayRemoved:"overlayRemoved",overlayDismissFailure:"overlayDismissFailure",overlayRemovalFailure:"overlayRemovalFailure"},outgoing:{jsInterface:"SKOverlayAPI",createOverlay:"createOverlay",presentOverlay:"presentOverlay",dismissOverlay:"dismissOverlay",removeOverlay:"removeOverlay"}},adunit:{outgoing:{overlayCreateCalled:"overlayCreateCalled",overlayCreateSuccess:"overlayCreateSuccess",overlayCreateFailed:"overlayCreateFailed",overlayVisibleCalled:"overlayVisibleCalled",overlayVisibleSuccess:"overlayVisibleSuccess",overlayVisibleFailed:"overlayVisibleFailed",overlayDismissed:"overlayDismissed"}}}}},{"../../components/Constants":13}],59:[function(p,e,t){e.exports=function(e,t,n){var i=null,r=0,a=null,o=null,s=p("./SKOverlayConstants"),d=new(p("../../modules/DemandSource/EventCategories.js"));function l(e){o=window.timerService.startTimer(),i.trackEvent(d.overlayWillStartPresentation_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r})}function c(e){i.trackEvent(d.overlayDidFinishPresentation_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r,custom_c:o?window.timerService.stopTimer(o):-1,timingvalue:a?window.timerService.stopTimer(a):-1}),a=o=null}function u(e){i.trackEvent(d.presentOverlayFailed_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r,callfailreason:e.errMsg,timingvalue:a?window.timerService.stopTimer(a):-1}),a=null}function f(e){i.trackEvent(d.overlayWillStartDismissal_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r})}function g(e){i.trackEvent(d.overlayDidFinishDismissal_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r}),r++}return{init:function(){i=e.Eventics.createEventic({productChance:1,baseData:{}},t.EventsManager),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayWillStartPresentation,l),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayDidFinishPresentation,c),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayLoadFailed,u),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayWillStartDismissal,f),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayDidFinishDismissal,g)},onPresentOverlay:function(){a&&i.trackEvent(d.presentOverlayDuringPendingPresent,{},{timingvalue:window.timerService.stopTimer(a)}),a=window.timerService.startTimer()}}}},{"../../modules/DemandSource/EventCategories.js":115,"./SKOverlayConstants":58}],60:[function(M,e,t){e.exports=function(f,g,p){var v="SKOverlayManager | ",m=M("../../components/SKOverlay/SKOverlay"),h=M("./SKOverlayConstants"),s=M("../../components/storeKit/SKANModel")(),e=M("../../constants/SDKFeatureNames"),d=new(M("../../modules/DemandSource/EventCategories.js")),t=!1,b=[],n=null,o=null,i=null,r=null,l=null,S=null,y=!1,a=!1,c=null;function u(){return g.isIOS()&&g.getConfigurationHelper().getDeviceApiLevel()>=h.minimalSupportedIOSVersion&&g.CompatibilityService.isFeatureSupportedInNativeSDK(e.SKOverlay)}function A(e,t,n,i,r,a,o){var s=[],d=e,l=new m(d,t,n,i,r,a,o);if(l){var c=h.messages.SDK.incoming.overlayCreated+V(),u=h.messages.SDK.incoming.overlayCreateFailed+V();return s.push(f.PubSub.subscribe(p.CB+"."+c,function(e){var t;g.log(v+"_createOverlay | "+c+"   "+JSON.stringify(e)),function(e){if(!e)return g.log(v+"Failed to add overlay to overlays array");b.push(e)}(l),F(h.messages.adunit.outgoing.overlayCreateSuccess,e),l.getFlow()===h.flow.presentOnSKCloseAndQC&&(t=d,S=f.PubSub.subscribe("SDKController.qcTriggered",function(){var e=T(t);e&&e.setQualityClickTriggered()})),l.getFlow()===h.flow.presentOnAdVisible&&O(l,!0),y=!1,f.PubSub.clearHandlers(s)})),F(h.messages.adunit.outgoing.overlayCreateCalled,l.getConfigObjectForSDK()),x(h.messages.SDK.outgoing.createOverlay,l.getConfigObjectForSDK(),c,u),l}g.log(v+"_createOverlay | Failed to create an overlay - missing overlayId")}function C(n){var i=T(n);i||(g.log(v+"_dismissOverlay | Failed to dismiss an overlay with missing overlay"),l.trackEvent(d.overlayMissing,{},{custom_b:1}));var e=h.messages.SDK.incoming.overlayDismissFailure+V(),r=f.PubSub.subscribe(p.CB+"."+e,function(e){var t={generalmessage:i?i.getAdvertisedAppId():-1,custom_a:n};l.trackEvent(d.overlayDismissFailure,{},t),f.PubSub.unsubscribe(r)});l.trackEvent(d.dismissOverlay_c,{},{generalmessage:i?i.getAdvertisedAppId():-1,custom_a:n,custom_b:0}),x(h.messages.SDK.outgoing.dismissOverlay,{overlayId:n},null,e)}function D(e){return e?T(e.adViewId):null}function I(e){n=e}function w(){return n}function P(){return!!w()}function T(e){if(!e)return l.trackEvent(d.overlayMissing,{},{custom_b:3}),null;for(var t in Object.keys(b))if(b[t].getOverlayId()===e)return b[t];return l.trackEvent(d.overlayMissing,{},{custom_b:4}),null}function O(e,t){var n=e.getPresentationDelay(t);r=setTimeout(function(){!function(t){if(t){var n=[],i=h.messages.SDK.incoming.overlayDidFinishPresentation,r=h.messages.SDK.incoming.overlayLoadFailed;n.push(f.PubSub.subscribe(p.CB+"."+i,function(e){g.log(v+"_presentOverlay |"+i+"   "+JSON.stringify(e)),g.getCurrentDisplayedAd()&&g.getCurrentDisplayedAdType()!==p.BN&&a?(I(t),f.PubSub.clearHandlers(n),F(h.messages.adunit.outgoing.overlayVisibleSuccess,e)):N(e.overlayId)})),n.push(f.PubSub.subscribe(p.CB+"."+r,function(e){g.log(v+"_presentOverlay | "+r+"   "+JSON.stringify(e)),f.PubSub.clearHandlers(n),F(h.messages.adunit.outgoing.overlayVisibleFailed,e)})),F(h.messages.adunit.outgoing.overlayVisibleCalled,{advertisedAppId:t.getAdvertisedAppId()}),l.trackEvent(d.presentOverlay_c,{},{generalmessage:t.getAdvertisedAppId(),custom_a:t.getOverlayId()});var e={};e[h.configKeys.overlayId]=t.getOverlayId(),g.SKOverlayEventDispatcher.onPresentOverlay(),x(h.messages.SDK.outgoing.presentOverlay,e,i,r)}else g.log(v+"_presentOverlay | Failed to present an overlay")}(e)},1e3*n)}function F(e,t){g.postAdUnitEvent(g.jQuery().extend({name:e},t))}function x(e,t,n,i){var r={};t&&0!==Object.keys(t).length&&(r={functionParams:t}),g.callSDKService(h.messages.SDK.outgoing.jsInterface,e,r,n,i)}function L(){r&&clearTimeout(r),r=void 0}function N(e){C(e),function(n){var i=T(n);i||(g.log(v+"_removeOverlay | Failed to remove an overlay with missing overlay"),l.trackEvent(d.overlayMissing,{},{custom_b:2}));var r=h.messages.SDK.incoming.overlayRemoved+V(),e=h.messages.SDK.incoming.overlayRemovalFailure+V(),a=f.PubSub.subscribe(p.CB+"."+r,function(e){if(g.log(v+"_removeOverlay | "+r+"   "+JSON.stringify(e)),i){var t=b.indexOf(i);-1!==t&&b.splice(t,1)}f.PubSub.unsubscribe(a),f.PubSub.unsubscribe(o)}),o=f.PubSub.subscribe(p.CB+"."+e,function(e){var t={callfailreason:e.errMsg,custom_a:n};l.trackEvent(d.overlayRemovalFailure,{},t),f.PubSub.unsubscribe(a),f.PubSub.unsubscribe(o)}),t={};t[h.configKeys.overlayId]=n,x(h.messages.SDK.outgoing.removeOverlay,t,r,e)}(e)}function U(e){return-1!==[p.RV,p.IS].indexOf(e)}function V(){return(new Date).getTime()+Math.random()}return{init:function(){u()&&!t&&(t=!0,l=f.Eventics.createEventic({productChance:1,baseData:{}},g.EventsManager),g.SKOverlayEventDispatcher.init(),f.PubSub.subscribe("SDKController.AdVisible",function(e){var t;e&&U(e.productType)&&(a=!0),(t=e)&&t.settings&&(!t.productType||-1!==h.supportedProductTypes.indexOf(t.productType))&&t.ext&&t.ext.clickTags&&t.ext.clickTags.storeAppId&&(t.settings.hasOwnProperty(h.externalConfigKeys.enableSKOverlay)?t.settings[h.externalConfigKeys.enableSKOverlay]:!t.ext.features||!t.ext.features.hasOwnProperty(h.externalConfigKeys.enableSKOverlay)||t.ext.features[h.externalConfigKeys.enableSKOverlay])&&(clearTimeout(c),c=void 0,function(e){if(e&&e.settings&&e.ext){var t=e.ext.clickTags&&e.ext.clickTags.storeAppId,n=e.settings[h.externalConfigKeys.SKOverlayPosition],i=!e.settings.hasOwnProperty(h.externalConfigKeys.SKOverlayUserDismissible)||e.settings[h.externalConfigKeys.SKOverlayUserDismissible],r=e.settings[h.externalConfigKeys.delayInSecToPresentSKOverlay],a=e.settings[h.externalConfigKeys.SKOverlayFlow]||0,o=s.extractDataForSKOverlay(e);g.log(v+"_createOverlay : "+JSON.stringify(o)),A(e.adViewId,t,n,i,o,r,a)}}(e),o=e)}),f.PubSub.subscribe("SDKController.adClosed",function(e){e.ad&&U(e.ad.productType)&&(a=!1),t&&function e(t){if(t){var n=t&&t.hasOwnProperty("timeInterval")?t.timeInterval:700,i=t&&t.hasOwnProperty("attempts")?t.attempts:1;i<=0||(c=setTimeout(function(){x(h.messages.SDK.outgoing.dismissOverlay,{},null,null),l.trackEvent(d.dismissOverlay_c,{},{custom_b:1}),e(jQuery.extend(t,{attempts:i-1}))},n))}}(e.ad.settings.dismissOverlayOnAdClose),b&&0!==b.length&&(L(),S&&(f.PubSub.unsubscribe(S),S=null),N(b[0].getOverlayId()))}),f.PubSub.subscribe(p.CB+"."+h.messages.SDK.incoming.overlayDidFinishDismissal,function(e){g.log(v+h.messages.SDK.incoming.overlayDidFinishDismissal+"   "+JSON.stringify(e));var t,n,i,r,a=g.getCurrentDisplayedAd();a?(t=e,n=D(a),t.dismissInitiatedSource=n&&n.getDismissInitiatedSource()||h.overlayDismissInitiatedType.user,F(h.messages.adunit.outgoing.overlayDismissed,t),n&&n.setDismissInitiatedSource(null)):(i=e,r=g.AdUtils.extractEventData(o),i&&(r.generalmessage=i.advertisedAppId,r.custom_b=i.userDismissible,r.custom_a=i.overlayId),r.custom_c=h.overlayDismissInitiatedType.adClose,l.trackEvent(d.overlayDismissed,{},r)),I(null)}),f.PubSub.subscribe(p.CB+"."+h.messages.SDK.incoming.overlayCreateFailed,function(e){g.log(v+h.messages.SDK.incoming.overlayCreateFailed+"   "+JSON.stringify(e));var t={};if(e&&e.overlayId){var n=T(e.overlayId);t=n&&n.getConfigObjectForSDK()}F(h.messages.adunit.outgoing.overlayCreateFailed,t)}),f.PubSub.subscribe("SDKController.aecskTriggered",function(e){y=!0}))},isSKOverlaySupported:u,onSKClose:function(){if(u()&&!y){var e=D(o);if(e){if(i)return O(i,!1),void(i=null);e.getFlow()===h.flow.presentOnAdVisible&&O(e,!1),e.getFlow()===h.flow.presentOnSKClose&&O(e,!0),e.getFlow()===h.flow.presentOnSKCloseAndQC&&e.isQualityClickTriggered()&&O(e,!0)}}else y=!1},onSKOpen:function(){u()&&(P()?((i=w()).setDismissInitiatedSource(h.overlayDismissInitiatedType.SKOpen),C(i.getOverlayId())):L())},isSKOverlayVisible:function(){return P()}}}},{"../../components/SKOverlay/SKOverlay":57,"../../components/storeKit/SKANModel":86,"../../constants/SDKFeatureNames":91,"../../modules/DemandSource/EventCategories.js":115,"./SKOverlayConstants":58}],61:[function(e,t,n){t.exports=function(i,r,a){function o(e){var t=i.getConfig().controllerConfig;return(t&&t.networkConfig||{})[e]}var s={getInventoryOnInit:!1,refreshInterval:30,precache:!0};function d(e){return null!=e&&("boolean"==typeof e||"true"===e||"false"===e)}return{shouldFetchNewFeedOnAdCloseFlag:function(e){var t=i.getConfig().controllerConfig;return(t&&t[r.sspProductNames[e]]||{}).shouldFetchNewFeedOnAdClose},getValueByKey:function(e){return(i.getConfig().controllerConfig||{})[e]},getValueByKeyAndProductType:function(e,t){var n=i.getConfig().controllerConfig;return(n&&n[r.sspProductNames[t]]||{})[e]},getNetworkConfigValueByKey:o,getFeaturesConfigByAdSource:function(e){var t=o("features"),n=a.extend({},t);delete n.MP;var i=e&&t&&t[e]||{};return a.extend(!0,{},n,i)},getOfferWallConfig:function(){var e,t=i.getConfig().controllerConfig,n={precache:d(t.precacheMobileOfferWall)?t.precacheMobileOfferWall:s.precache,getInventoryOnInit:d(t.getInventoryOnInit)?t.getInventoryOnInit:s.getInventoryOnInit,refreshInterval:(e=t.owRefreshInterval,null==e||isNaN(parseInt(e))||0===t.owRefreshInterval?s.refreshInterval:t.owRefreshInterval)};return a.extend(!0,s,n)},isNetworkConfigEmpty:function(){var e=i.getConfig().controllerConfig;return!e||!e.networkConfig}}}},{}],62:[function(e,t,n){function i(o,r,s,d){function i(e,t){return e[0]&&t[0]?(e=new Date(e[0]))<(t=new Date(t[0]))?-1:t<e?1:0:0}function e(e,t){return void 0===e&&(e=1),e=parseInt(e),t=parseInt(t),isNaN(e)||isNaN(t)?-1:e===t?0:t<e?1:-1}function t(e){try{return e()}catch(e){return!1}}function n(e){return"object"==typeof e&&e.hasOwnProperty("length")?Array.prototype.slice.call(e):[]}function a(e){if(c())return f(l(),e)}function l(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}function c(){return crypto&&crypto.getRandomValues&&"function"==typeof crypto.getRandomValues}function u(e,t){if(e.length<=t||t<=0)return"";for(var n=0,i=0;i<e.length;i++){n+=e.charCodeAt(i)}return n%Math.pow(16,t).toString(16).padStart(t,"0")}function f(e,t){if(e.length<=t||t<=0)return e;var n=e.slice(0,-t);return n+u(n,t)}var g={extend:function(e,t){jQuery.extend(e,t)},getScript:function(e,t,n){var i=s.createElement("script");i.src=e;var r=s.getElementsByTagName("head")[0],a=!1;i.onload=i.onreadystatechange=function(e){a||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(a=!0,t(e),i.onload=i.onreadystatechange=null,r.removeChild(i))},i.onerror=function(e){o.log(["script load error",e]),n&&n()},r.appendChild(i)},getQueryString:function(e,t,n){n=this.isDefined(n)?n:r.location.href,null===t&&(t=""),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(n);return null===i?t:i[1]},getUrlInfo:function(e){var t=s.createElement("a");return t.href=e,{host:t.hostname,port:t.port,path:t.pathname,protocol:t.protocol}},changeUrlProtocol:function(e,t){var n=s.createElement("a");return n.href=e,n.protocol=t,n.href},serialize:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},isDefined:function(e){return typeof e!==d},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},parseJSON:function(e){var t={};if(!this.isString(e))return null;try{t=jQuery.parseJSON(e)}catch(e){}return t},getParams:function(e){var t,n=[],i=e.split("/"),r=i.length;if(-1===e.indexOf("JSON:")){if(2<=r&&r%2==0)for(t=0;t<r;t+=2)n[i[t]]=i.length>=t+1?decodeURIComponent(i[t+1]):null}else{var a=e.split("JSON:");typeof a[1]!==d&&(n=jQuery.parseJSON(a[1]))}return n},decodeValues:function(t){jQuery.each(t,function(e){t.hasOwnProperty(e)&&("string"==typeof t[e]&&(t[e]=decodeURIComponent(t[e])),"object"==typeof t[e]&&t[e]&&o.Utils.decodeValues(t[e]))})},renderTemplate:function(i,e){return e&&jQuery.each(e,function(e,t){var n=new RegExp("{{"+e+"}}","g");i=i.replace(n,t)}),i},isVisible:function(e){return"none"!==e.css("display")&&"hidden"!==e.css("visibility")},versionCompare:function(e,t){var n=function(e){1===e.length&&e.push("0"),2===e.length&&e.push("0")},i=function(t){jQuery.each(t,function(e){t[e]=parseInt(t[e])})};"5.02"===e&&(e="5.0.2");var r=e.split("."),a=t.split(".");n(r),n(a);try{i(r),i(a)}catch(e){throw"parse error"}return r[0]===a[0]?r[1]===a[1]?r[2]===a[2]?0:r[2]>a[2]?1:-1:r[1]>a[1]?1:-1:r[0]>a[0]?1:-1},returnResolvedPromise:function(){var e,t=new jQuery.Deferred;return 0<arguments.length&&(e=[].slice.call(arguments)),t.resolve.apply(t.resolve,e),t.promise()},returnRejectedPromise:function(){var e,t=new jQuery.Deferred;return 0<arguments.length&&(e=[].slice.call(arguments)),t.reject.apply(t.reject,e),t.promise()},replacePlaceHolder:function(e,t){var n;for(var i in t){n=t[i];var r=new RegExp(i+"|"+encodeURIComponent(i),"i");e=e.replace(r,"function"==typeof n?n():n)}return e},fileArrayIncludes:function(e,t){if(e||0===e.length)return!1;for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){if(!e)return!0;if(this.isString(e)||this.isArray(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},sortDataByDateKey:function(e){var t=[];for(var n in e)t.push([n,e[n]]);return t.sort(i)},apiVersionCompareTo:e,isNestedObjectExists:t,convertArrayLikeObjectToArray:n,generateIdentifier:a,replaceEndingWithCheckSum:f};return g}t.exports=i},{}],63:[function(e,t,n){t.exports=function(g,l){var p=e("../components/PixelTrackingService.js")(l),v=e("../components/FillRateTrackingService.js")(l,p),m=e("../components/ObfuscationService.js")(),h=e("../modules/DemandSource/EventCategories")(),b=e("./Constants"),S=l.DemandUtils;return{parseVast:function(e,t,n){var i,r,a=new jQuery.Deferred;if(r="prod"!==l.getEnv()?(i=e.settings.urltocdn+"/common/sdk/1.0.9/vastObfuscator.html",e.settings.urltocdn+"/common/sdk/1.0.9/vast-vmap.js"):(i=e.settings.urltocdn+"/common/sdk/1.0.9/vastObfuscator.4f4eb4fb.min.html",e.settings.urltocdn+"/common/sdk/1.0.9/vast-vmap.4f4eb4fb.min.js"),!(e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse))return a.reject({errMsg:"unsupported vast format"});var o=e.ext.vastData.xmlResponse,s={adData:o,style:"height:100%;",adUnitData:e,vastParserUrl:r},d={adData:o,url:i,templateClass:"obfuscationIframe",style:{width:"1px",height:"1px",border:"0"},id:e.vastIframeId};return function(n,t,e){var i,r;if("[object Array]"===Object.prototype.toString.call(n.ext.callbacks)){var a=n.controllerSpace&&n.controllerSpace.viewCount||0;i=n.ext.callbacks[a]}else i=n.ext.callbacks;var o=v.init(i),s=n.vastIframeId,d=g.PubSub.subscribe("SDKController.VastRequest",function(e){e.vastIframeId&&e.vastIframeId===s&&(o.track({trackingType:"request"}),g.PubSub.unsubscribe(d))}),l=g.PubSub.subscribe("SDKController.VastResponse",function(e){e.vastIframeId&&e.vastIframeId===s&&(clearTimeout(r),"hit"===e.result?(o.track({trackingType:"responseHit"}),m.removeIframe(s),g.PubSub.unsubscribe(l),t.resolve(e.data)):(o.track({trackingType:"responseMiss",data:e.data}),m.removeIframe(s),g.PubSub.unsubscribe(l),t.reject({errMsg:e.data})))}),c=e&&e>b.vastMinimumResponseTimeout?e:b.vastResponseTimeout;r=setTimeout(function(){g.PubSub.unsubscribe(l),g.PubSub.unsubscribe(d),g.PubSub.unsubscribe(u),clearTimeout(r),t.reject({isTimeLimitReached:!0,errMsg:"timeout"})},c);var u=g.PubSub.subscribe("SDKController.VastErrorPixel",function(e){e.vastIframeId&&e.vastIframeId===s&&(p.firePixel(e),m.removeIframe(s),g.PubSub.unsubscribe(u))}),f=g.PubSub.subscribe("SDKController.parseVastInfo",function(e){if(e.vastIframeId&&e.vastIframeId===s){g.PubSub.unsubscribe(f);var t=S.extendCallbackParamsWithParentProductConfig(n,{action:"fireEvent",eventParam:{eName:h.parseVastInfo,label:{},data:{generalMessage:e.data}}});g.PubSub.publish("SDKController.Analytics",[t])}})}(e,a,n.vastTimeOut),m.init(d,function(e){g.Msg.postMessage("$$JSON:"+JSON.stringify(s),i,e[0].contentWindow)}),a.promise()},removeIframe:function(e){m.removeIframe(e)}}}},{"../components/FillRateTrackingService.js":23,"../components/ObfuscationService.js":43,"../components/PixelTrackingService.js":52,"../modules/DemandSource/EventCategories":115,"./Constants":13}],64:[function(t,e,n){e.exports=function(e){var i,r,a,o=t("../components/Constants.js"),s=null;return{init:function(e,t){var n;s=new jQuery.Deferred,i=(n=e).settings&&n.settings.standaloneView,o.viewsStates.normal,r=e.ext&&e.ext.viewUniqueId||"",a={standaloneView:i,viewUniqueId:r,adViewId:t},s.resolve({})},waitForAllViews:function(){return s.promise()},getDisplayWebViewParams:function(e){return a=jQuery.extend(a,{display:e})}}}},{"../components/Constants.js":13}],65:[function(e,t,n){"use strict";n.__esModule=!0,t.exports=function(e){var i=[],t=e.controller;function n(t){var e=i.filter(function(e){return e.getContainerID()===t});return 0<e.length?e[0]:void 0}return{add:function(e){e&&i.push(e)},getAdViewById:n,isExist:function(e){return void 0!==n(e)},removeAdViewById:function(t){var n={};return i=i.filter(function(e){return e.getContainerID()!==t||(n=e,!1)}),n},toArray:function(){return i.slice()},size:function(){return i.length},printAll:function(){i.forEach(function(e){t.log("container  "+e.getContainerID())})}}}},{}],66:[function(e,t,n){t.exports=function(f,g,p,n,i){var v="AdViewsManager | ";function r(e){return f.log(v+"_getAdViewByAd"),a(e).getAdViewByAd(e)}function a(e){if(m("_getManager"),e)return e.isWPAD?p:g;m("_getManager without ad")}function m(e){f.log(v+e)}return{createAndLoadView:function(e,t,n,i){var r,a,o,s,d,l,c,u;e.isWPAD?(d=e,l=t,c=n,u=i,m("_createAndLoadAdWebView"),p.loadAdUnitUrlToView(d,l,c,u)):(r=e,a=t,o=n,s=i,f.log(v+"_createAndLoadFrameView"),g.createAndLoadAdFrame(r,a,o,s))},displayAdView:function(e,t,n,i){f.log(v+"_displayAdView"),a(e).displayAdView(e,t,n,i)},unloadAdView:function(e){m("_unloadAdView"),e?a(e).unloadAdView(e):m("_unloadAdView | no ad")},updateFrameUrl:function(e,t,n,i){m("_updateFrameUrl"),a(e).updateAdUnitUrl(e,t,n,i)},getContainerState:function(){return m("_getContainerState"),n.getState()},displayContainer:function(e){if(m("_displayContainer"),a(e)===g)return n.display(e);var t=r(e).getContainerID();return n.display(e,t)},hideContainer:function(e){m("_hideContainer"),n.hide(e)},setContainerVisibility:function(e){m("_setContainerVisibility"),n.setVisibility(e)},changeContainerMode:function(e,t){m("_changeContainerMode"),n.changeMode(e,t)},unloadProductFromContainer:function(){m("_unloadProductFromContainer"),n.unloadProduct()},setContainerBGColorTransparent:function(){m("_setContainerBGColorTransparent"),n.setWebviewBGColorTransparent()},handleScreenVisible:function(e,t){m("_handleScreenVisible"),a(t).handleScreenVisible(e,t)},displayLoader:function(e){if(m("_displayLoader"),i.isDisplayed()){var t=i.get();a(t).displayLoader(e,t)}else g.displayLoader(e)},hideLoader:function(){if(m("_hideLoader"),i.isDisplayed()){var e=i.get();a(e).hideLoader(e)}else g.hideLoader()},isContainerLoaded:function(e){return m("_isContainerLoaded"),a(e).isContainerLoaded(e)},getContainerCreationHandler:function(e){return m("_getContainerCreationHandler"),a(e).getContainerCreationHandler(e)},onAdUnitLoaded:function(e,t,n){f.log(v+"_onAdUnitLoaded"),a(e).onAdUnitLoaded(e,t,n)},getAdViewByAd:r,triggerRedraw:function(){m("_triggerRedraw"),n.redraw()},sendMessageToAdView:function(e,t){return m("_sendMessageToAdView"),t?a(t).sendMessageToDisplayedAdView(e):(m("_sendMessage | ad undefined"),!1)},sendMessageToAllAdViews:function(e){m("_sendMessageToAllAdViews"),p.sendMessageToAllAdViews(e),g.sendMessageToAllAdViews(e)},getDisplayedAdView:function(e){return m("_getDisplayedAdView"),a(e).getDisplayedAdView(e)},hideView:function(){var e=i.get();a(e).hideView(e)},displayView:function(){var e=i.get();a(e).displayView(e)},isViewDisplayed:function(e,t){a(t).isViewDisplayed(e)}}}},{}],67:[function(e,t,n){t.exports=function(n,t,e){var i=n.jQuery(),r=e.style.backgroundColors;return{setSDKWebviewBGColor:function(e,t){e&&(n.log("ContainerManager | setSDKWebviewBGColor | color: "+e),n.callSDKFunction("setWebviewBackgroundColor",i.extend(t||{},{color:e})))},setControllerBGColor:function(e){e&&(n.log("ContainerManager | setControllerBGColor | color: "+e),i("body").css("background",e))},getSDKWebviewBGColorByProductType:function(e){switch(e){case t.IS:case t.WebControls:return r.transparent;case t.OW:case t.RV:default:return r.black}},getControllerBGColorByProductType:function(e){switch(e){case t.IS:case t.WebControls:return r.transparent;case t.OW:case t.RV:default:return r.darkGrey}},backgroundColors:r}}},{}],68:[function(e,t,n){t.exports=function(l,c,u,t){var i,r,n,a="BannerExternalAdViewService | ",f=e("./ExternalAdViewConstants.js"),o=e("./WPADUtils")(c),s=[],d=[],g=f.nativeFunction,p=c.jQuery();function v(){var e=t.get();e&&e.productType&&e.productType===u.BN&&t.reset()}function m(e){return!!e&&e.isViewVisible}function h(e){return e&&e.adViewId}function b(e){var t,n;return n=e,t=!(C()!==f.nativeFunction||h(n)&&!o.isBannerAdViewId(n.adViewId))||h(e)&&function(e){c.log("BannerExternalAdViewService | isIdentifierExistInIdsCollection | "+e);for(var t=!1,n=0;!t&&n<d.length;n++)d[n].id===e&&(t=!0);return t}(e.adViewId),c.log("BannerExternalAdViewService | "+C()+" | handling message? "+t+"  message:"+JSON.stringify(e)),t}function S(e){D("sendMessage | "+JSON.stringify(e));var t,n,i,r,a,o,s=l.PubSub.subscribe(u.CB+"."+f.handleSendMessageFailure,function(e){b(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleSendMessageFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(s))});if("string"==typeof e){var d=e.indexOf("$$");-1!==d&&(n=d,i={},r=(t=e).substr(n+2),a=r.indexOf("="),o=r.substr(0,a),i.name=t.substr(0,n),i[o]=r.substr(a+1),e=i)}c.callSDKFunction(C(),{functionName:f.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},f.handleSendMessageSuccess,f.handleSendMessageFailure)}var y=function(e,t){S(e)};function A(){n=!(d=[])}function C(){return g}function D(e){c.log(a+e)}return{init:function(e){var t;n=!0,D("_setNativeServiceApi | "+(t=e)),t&&(D("_setNativeServiceApi | "+t),g=t),c.log("rony BannerExternalAdViewService | _init nativeservice : "+g),s.push(l.PubSub.subscribe(u.CB+"."+f.handleContainerIsVisible,function(e){b(e)?!e.configs&&e.configs.productType&&e.configs.visibilityParams||(c.log("rony BannerExternalAdViewService | handeling isVisible"),c.log("BannerExternalAdViewService | "+f.handleContainerIsVisible),m(e.configs.visibilityParams)&&l.PubSub.publish(e.configs.productType+".isVisible",[e.configs])):c.log("rony BannerExternalAdViewService | not handeling isVisible")})),s.push(l.PubSub.subscribe(u.CB+"."+f.handleContainerWasRemoved,function(e){if(b(e)){c.log("BannerExternalAdViewService | "+f.handleContainerWasRemoved,c.LogLevels.error);for(var t=!1,n=0;!t&&n<d.length;n++)d[n].id===e.configs.externalAdViewId&&(t=!0,d.splice(n,1));t||c.log("BannerExternalAdViewService | "+f.handleContainerWasRemoved+"trying to remove container "+e.configs.externalAdViewId+" that does not exist",c.LogLevels.error),v(),l.PubSub.publish(e.configs.productType+".reset",[e.configs])}})),s.push(l.PubSub.subscribe(u.CB+"."+f.NativeAPI.linkActivation,function(e){b(e)&&(c.log("BannerExternalAdViewService |  "+f.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&l.Utils.decodeValues(e),l.PubSub.publish(u.CB+".linkActivationOnAd",[e]))})),s.push(l.PubSub.subscribe(u.CB+"."+f.handleMessage,function(e){b(e)&&function(t){try{var e=t.adViewId?t.adViewId:void 0,n=(i=t.id,r=e,function(e){var t={data:e,id:i};r&&p.extend(t,{adViewId:r}),y(t,!0)});c.isAndroid()||l.Utils.decodeValues(t.arguments),e&&p.extend(t.arguments,{adViewId:e}),p.extend(t.arguments,{callback:n}),l.PubSub.publish("SDKController."+t.method,[t.arguments])}catch(e){c.log("BannerExternalAdViewService | unable to parse message: "+t,c.LogLevels.error)}var i,r}(e)}))},destroy:function(){l.PubSub.clearHandlers(s)},loadWithUrl:function(t,n,e,i,r){D("_loadWithUrl | "+t),c.AdUtils.extendAdObjectWithConfig(t,n,e,i);var a=l.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlFailure,function(e){b(e)&&(c.isAdDisplayed(n)?D("_loadWithUrl | isAdDisplayed=true"):(e&&e.errMsg&&(c.log("Error calling "+f.handleLoadWithUrlFailure+" with error "+e.errMsg+" url "+t,c.LogLevels.error),v(),l.PubSub.publish("SDKController.AdLoadError",[e])),l.PubSub.unsubscribe(a),r&&r(!1)))}),o=l.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlSuccess,function(e){b(e)&&(r&&r(!0),D(f.handleLoadWithUrlSuccess),l.PubSub.unsubscribe(a),l.PubSub.unsubscribe(o))});c.callSDKFunction(C(),{functionName:f.NativeAPI.loadWithUrl,functionParams:p.extend({urlForWebView:t},i)},f.handleLoadWithUrlSuccess,f.handleLoadWithUrlFailure)},updateAd:function(e,t,n,i){c.log("BannerExternalAdViewService | _updateAd | "+JSON.stringify(t));var r={name:"updateAd",param:t};c.AdUtils.extendAdObjectWithConfig(e,t,n,i);var a=l.PubSub.subscribe(u.CB+"."+f.handleUpdateAdFailure,function(e){b(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleUpdateAdFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(a))});c.callSDKFunction(C(),{functionName:f.NativeAPI.updateAd,functionParams:{params:JSON.stringify(r)}},f.handleUpdateAdSuccess,f.handleUpdateAdFailure)},sendMessage:S,isContainerVisible:m,isExternalAdViewInitiated:function(){if(c.log("BannerExternalAdViewService | isExternalAdViewInitiated |"),i&&"pending"===i.status)return i;i=new p.Deferred;var t=l.PubSub.subscribe(u.CB+"."+f.handleIsInitiated,function(e){b(e)&&(c.log("BannerExternalAdViewService | "+f.handleIsInitiated+" "+JSON.stringify(e)),l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n),i.resolve(e))}),n=l.PubSub.subscribe(u.CB+"."+f.handleIsInitiatedFailure,function(e){b(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleIsInitiatedFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(n),l.PubSub.unsubscribe(t),i.reject(e))});return c.callSDKFunction(C(),{functionName:f.NativeAPI.isExternalAdViewInitiated},f.handleIsInitiated,f.handleIsInitiatedFailure),i.promise()},addExternalAdViewIdAndSetStatus:function(e){D("_addExternalAdViewIdAndSetStatus");for(var t=e.externalAdViewId,n=e.isInReload,i=!1,r=0;r<d.length;r++){var a=d[r];a.id===t&&(i=!0,D("_addExternalAdViewIdAndSetStatus | changed isInReload to "+(a.isInReload=n)))}i?c.log("BannerExternalAdViewService | _addExternalAdViewIdAndSetStatus | "+t+" has been previously added",c.LogLevels.error):(0!==d.length&&(d=[]),d.push({id:t,isInReload:n}))},getViewVisibility:function(){if(D("_getViewVisibility | banner"),r&&"pending"===r.status)return r;r=new p.Deferred;var t=l.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilitySuccess,function(e){b(e)&&(D(f.handleGetViewVisibilitySuccess+" "+JSON.stringify(e)),l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n),r.resolve(e))}),n=l.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilityFailure,function(e){b(e)&&(e&&e.errMsg&&c.log("BannerExternalAdViewService | Error calling "+f.handleGetViewVisibilityFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(n),l.PubSub.unsubscribe(t),r.reject(e))});return c.callSDKFunction(C(),{functionName:f.NativeAPI.getViewVisibility},f.handleGetViewVisibilitySuccess,f.handleGetViewVisibilityFailure),r.promise()},resetExternalAdViewsIdentifiers:A,removeExternalAdView:function(e,t,n){A(),c.callSDKFunctionWithCallback(C(),{functionName:f.NativeAPI.removeAdView,functionParams:{adViewId:e}},t,n)},getIsServiceInitiated:function(){return D("rony _getIsServiceInitiated: "+n),n}}}},{"./ExternalAdViewConstants.js":72,"./WPADUtils":76}],69:[function(b,e,t){e.exports=function(t,n,r,e){var i="BannerExternalContainer | ",a=b("./WPADUtils")(n),o=!1,s=!1,d=!1,l=!1,c=e,u=[];function f(e){s=e}function g(e){h("_setAdIsVisibleInContainer = "+e),o=e}function p(){return o}function v(){h("_resetReportAdVisibilityFlags"),f(!1),g(!1)}function m(){return h("_shouldReportAdVisible | containerID: "+c+" isAdLoadedInContainer: "+s+" | isAdVisibleInContainer "+o),s&&!o}function h(e){n.log(i+e)}return{setAdIsVisibleInContainer:g,resetReportAdVisibilityFlags:v,shouldReportAdVisibleForBanners:m,checkStatusOfAdView:function(){if(r.getIsServiceInitiated)return r.isExternalAdViewInitiated()},createAdUrlInAdView:function(e,t,n,i){h("_createAdUrlInAdView "+t.productType),v(),l=!0,r.getIsServiceInitiated&&r.loadWithUrl(e,t,n,i,function(e){d=e,l=!1})},updateAdInAdView:function(e,t,n,i){h("_updateAdInAdView "+t.productType),v(),r.getIsServiceInitiated&&r.updateAd(e,t,n,i)},sendMessageToExternalAdView:function(e){e&&c&&(e.adViewId||(e.adViewId=c)),r.getIsServiceInitiated&&r.sendMessage(e)},addExternalAdViewIdAndSetStatus:function(e){r.getIsServiceInitiated&&r.addExternalAdViewIdAndSetStatus(e)},onExternalViewLoaded:function(){h("_onExternalViewLoaded isAdVisibleInContainer="+p()),f(!0)},isAdInExternalViewLoaded:function(){return h("isAdInExternalViewLoaded "+s),s},onBannerViewLoaded:function(t,n){f(!0),r.getIsServiceInitiated&&r.getViewVisibility().then(function(e){r.isContainerVisible(e)&&(t(),m()&&n())})},resetExternalAdViewsIdentifiers:function(){r.getIsServiceInitiated&&r.resetExternalAdViewsIdentifiers()},getContainerID:function(){return h("_getContainerID: "+c),c},removeContainer:function(e,t){r.getIsServiceInitiated&&r.removeExternalAdView(c,e,t)},isVisible:p,isContainerLoaded:function(e){return!0===l&&t.PubSub.publish("BannerExternalContainer.duringCreation",[e]),d},init:function(){u.push(t.PubSub.subscribe("SDKController.AdVisible",function(e){var t;h("inside adVisibleHandler"),h("_shouldRecieveMessage containerID: "+c+" adViewId: "+(t=e).adViewId),(a.isBannerAd(t)&&a.isBannerAdViewId(c)||t.adViewId===c)&&(h("got SDKController.AdVisible | setting visibility to true"),g(!0))}))},clean:function(){h("_clean"),t.PubSub.clearHandlers(u),r.getIsServiceInitiated&&r.destroy(),r=null}}}},{"./WPADUtils":76}],70:[function(f,e,t){e.exports=function(n,i,r,a,e){f("./ExternalAdViewConstants.js");var t="BannerHandlerDelegate | ",o=e,s=r.BN,d=[],l="";function c(e){e.productType=s,e.demandSourceName=o}function u(e){i.log(t+e)}return{assignAdViewAndStartHandle:function(e){u("_assignAdViewAndStartHandle: "+e),e&&(l=e,d.push(n.PubSub.subscribe("removed."+l,function(e){var t;c(e),u("handle banner removed with id: "+e.adViewId+"for instance id: "+e.demandSourceId),(t=a.get())&&t.productType&&t.productType===r.BN&&a.reset()})),d.push(n.PubSub.subscribe("isVisible."+l,function(e){var t;c(e),!e.configs&&e.configs.productType&&e.configs.visibilityParams||(u("handle banner visible with id: "+e.adViewId+"for instance id: "+e.demandSourceId),(t=e.configs.visibilityParams)&&t.isViewVisible&&e.productType===r.BN&&n.PubSub.publish("Banner.isVisible",[e]))})),d.push(n.PubSub.subscribe("destroy."+l,function(t){var e;c(t),u("handle banner destroy with id: "+t.adViewId+"for instance id: "+t.demandSourceId),t.isBNAutoRemove?(c(e=t),e[r.isBNAutoRemove]&&!1===i.getSDKDataByKey(r.bnAutoDestroy)||(u("handle banner replace with id: "+e.adViewId+"for instance id: "+e.demandSourceId),i.unloadAdViewsByProductExceptDisplayedView({productType:e.productType}))):i.OMIDService.finishSession(t).always(function(){var e;e=t,n.PubSub.publish("Banner.reset",[e]),a.getDisplayedAdType()===r.BN&&n.PubSub.publish("SDKController.AdClose",[e])})})))},stopHandle:function(){u("stopHandle: "+l),n.PubSub.clearHandlers(d)}}}},{"./ExternalAdViewConstants.js":72}],71:[function(e,t,n){t.exports=function(e,t){var n,i={notCreated:0,duringCreation:1,createdSuccessfully:2,failedToCreate:3},r=i.notCreated,a=new e.Deferred,o="failed to create native webview";function s(e){e!==r?(d("setState - new state: "+e),function(e){if(d("updatePromiseOnStateChange: "+e),"pending"!==a.state())return d("updatePromiseOnStateChange - not in pending state - ignoring");e===i.createdSuccessfully?a.resolve():e===i.failedToCreate&&a.reject(o)}(r=e)):d("setState - already in state: "+e)}function d(e){t("ContainerCreationStateHandler | "+e)}return{getState:function(){return r},setState:s,getCreationStates:function(){return i},getCreationResultPromise:function(){return a.promise()},creationStarted:function(e){d("creationStarted"),s(i.duringCreation),n=setTimeout(function(){d("creation ended because of timeout"),s(i.failedToCreate)},e||3e3)},creationEnded:function(e){d("creationEnded with result: "+e),clearTimeout(n),s(e?i.createdSuccessfully:i.failedToCreate)}}}},{}],72:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{loadWithUrl:"loadWithUrl",updateAd:"updateAd",isExternalAdViewInitiated:"isExternalAdViewInitiated",sendMessage:"sendMessage",getViewVisibility:"handleGetViewVisibility",removeAdView:"removeAdView",linkActivation:"linkActivation"},nativeFunction:"bannerViewAPI",nativeFunctionAdViewAPI:"adViewAPI",handleContainerIsVisible:"containerIsVisible",handleContainerWasRemoved:"containerWasRemoved",performDestroyDisplayBanner:"performDestroyDisplayBanner",destroyBanner:"destroyBanner",cleanUpNonDisplayBanners:"cleanUpNonDisplayBanners",isBNAutoRemove:"isBNAutoRemove",bnAutoDestroy:"bnAutoDestroy",handleIsInitiated:"containerAdViewStatus",handleIsInitiatedFailure:"containerAdViewStatusFailure",handleAdReplaced:"containerAdReplaced",handleMessage:"containerSendMessage",handleLoadWithUrlSuccess:"handleLoadWithUrlSuccess",handleLoadWithUrlFailure:"handleLoadWithUrlFailure",handleUpdateAdSuccess:"handleUpdateAdSuccess",handleUpdateAdFailure:"handleUpdateAdFailure",handleSendMessageSuccess:"handleSendMessageSuccess",handleSendMessageFailure:"handleSendMessageFailure",handleGetViewVisibilitySuccess:"handleGetViewVisibility",handleGetViewVisibilityFailure:"handleGetViewVisibilityFailure"}},{}],73:[function(P,e,t){e.exports=function(l,c,u,t){var i,r,a,n="ExternalAdViewService | ",e=P("../../constants/SDKFeatureNames"),f=P("./ExternalAdViewConstants.js"),o=P("./bannerLoadWhileShowHandler"),s=P("./WPADUtils")(c),d=[],g=f.nativeFunction,p=c.jQuery();function v(){var e=t.get();e&&e.productType&&e.productType===u.BN&&t.reset()}function m(e){return!!e&&e.isViewVisible}function h(e){return e&&e.adViewId}var b={handleVisible:function(e){var t;!(t=e.configs)&&t.productType&&t.visibilityParams||(c.log("ExternalAdViewService | "+f.handleContainerIsVisible),m(t.visibilityParams)&&t.productType===u.BN&&l.PubSub.publish(t.productType+".isVisible",[t]))},handleRemoved:function(e){c.log("ExternalAdViewService | bannerSingleInstancesHandler | "+f.handleContainerWasRemoved,c.LogLevels.error),v(),l.PubSub.publish(e.configs.productType+".reset",[e.configs])},handlePerformDestroy:function(e){c.log("ExternalAdViewService | bannerSingleInstancesHandler | handlePerformDestroy")}};function S(){return c.CompatibilityService.isFeatureSupportedInNativeSDK(e.bannerMultipleInstances)?o(l,c):b}function y(e){if(t=e,D()===f.nativeFunction&&(!h(t)||s.isBannerAdViewId(t.adViewId)))return!0;var t,n=h(e)&&I()===e.adViewId;return c.log("ExternalAdViewService | "+D()+" | handling message? "+n+"  message:"+JSON.stringify(e)),n}function A(e){w("sendMessage | "+JSON.stringify(e));var t,n,i,r,a,o,s=l.PubSub.subscribe(u.CB+"."+f.handleSendMessageFailure,function(e){y(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleSendMessageFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(s))});if("string"==typeof e){var d=e.indexOf("$$");-1!==d&&(n=d,i={},r=(t=e).substr(n+2),a=r.indexOf("="),o=r.substr(0,a),i.name=t.substr(0,n),i[o]=r.substr(a+1),e=i)}c.callSDKFunction(D(),{functionName:f.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},f.handleSendMessageSuccess,f.handleSendMessageFailure)}var C=function(e,t){A(e)};function D(){return g}function I(){return a}function w(e){c.log(n+e)}return{init:function(e,t){var n,i;w("_setNativeServiceApi | "+(i=e)),i&&(g=i),w("_setAdViewId | "+(n=t)),n&&(a=n),d.push(l.PubSub.subscribe(u.CB+"."+f.handleContainerIsVisible,function(e){y(e)&&S().handleVisible(e)})),d.push(l.PubSub.subscribe(u.CB+"."+f.handleContainerWasRemoved,function(e){y(e)&&S().handleRemoved(e)})),d.push(l.PubSub.subscribe(u.CB+"."+f.destroyBanner,function(e){y(e)&&S().handlePerformDestroy(e)})),d.push(l.PubSub.subscribe(u.CB+"."+f.NativeAPI.linkActivation,function(e){y(e)&&(c.log("ExternalAdViewService |  "+f.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&l.Utils.decodeValues(e),l.PubSub.publish(u.CB+".linkActivationOnAd",[e]))})),d.push(l.PubSub.subscribe(u.CB+"."+f.handleMessage,function(e){y(e)&&function(t){try{var e=t.adViewId?t.adViewId:void 0,n=(i=t.id,r=e,function(e){var t={data:e,id:i};r&&p.extend(t,{adViewId:r}),C(t,!0)});c.isAndroid()||l.Utils.decodeValues(t.arguments),p.extend(t.arguments,{callback:n}),e&&p.extend(t.arguments,{adViewId:e}),l.PubSub.publish("SDKController."+t.method,[t.arguments])}catch(e){c.log("ExternalAdViewService | unable to parse message: "+t,c.LogLevels.error)}var i,r}(e)}))},destroy:function(){l.PubSub.clearHandlers(d)},loadWithUrl:function(t,n,e,i,r){w("_loadWithUrl | "+t),c.AdUtils.extendAdObjectWithConfig(t,n,e,i);var a=l.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlFailure,function(e){y(e)&&(c.isAdDisplayed(n)?w("_loadWithUrl | isAdDisplayed=true"):(e&&e.errMsg&&(c.log("Error calling "+f.handleLoadWithUrlFailure+" with error "+e.errMsg+" url "+t,c.LogLevels.error),v(),l.PubSub.publish("SDKController.AdLoadError",[e])),l.PubSub.unsubscribe(a),r&&r(!1)))}),o=l.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlSuccess,function(e){y(e)&&(r&&r(!0),w(f.handleLoadWithUrlSuccess),l.PubSub.unsubscribe(a),l.PubSub.unsubscribe(o))});c.callSDKFunction(D(),{functionName:f.NativeAPI.loadWithUrl,functionParams:p.extend({urlForWebView:t},i)},f.handleLoadWithUrlSuccess,f.handleLoadWithUrlFailure)},updateAd:function(e,t,n,i){c.log("ExternalAdViewService | _updateAd | "+JSON.stringify(t));var r={name:"updateAd",param:t};c.AdUtils.extendAdObjectWithConfig(e,t,n,i);var a=l.PubSub.subscribe(u.CB+"."+f.handleUpdateAdFailure,function(e){y(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleUpdateAdFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(a))});c.callSDKFunction(D(),{functionName:f.NativeAPI.updateAd,functionParams:{params:JSON.stringify(r)}},f.handleUpdateAdSuccess,f.handleUpdateAdFailure)},sendMessage:A,isContainerVisible:m,isExternalAdViewInitiated:function(){if(c.log("ExternalAdViewService | isExternalAdViewInitiated |"),i&&"pending"===i.status)return i;i=new p.Deferred;var t=l.PubSub.subscribe(u.CB+"."+f.handleIsInitiated,function(e){y(e)&&(c.log("ExternalAdViewService | "+f.handleIsInitiated+" "+JSON.stringify(e)),l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n),i.resolve(e))}),n=l.PubSub.subscribe(u.CB+"."+f.handleIsInitiatedFailure,function(e){y(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleIsInitiatedFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(n),l.PubSub.unsubscribe(t),i.reject(e))});return c.callSDKFunction(D(),{functionName:f.NativeAPI.isExternalAdViewInitiated},f.handleIsInitiated,f.handleIsInitiatedFailure),i.promise()},getViewVisibility:function(){if(w("_getViewVisibility | external container"),r&&"pending"===r.status)return r;if(r=new p.Deferred,I()){var t=l.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilitySuccess,function(e){y(e)&&(w(f.handleGetViewVisibilitySuccess+" "+JSON.stringify(e)),l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n),r.resolve(e))}),n=l.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilityFailure,function(e){y(e)&&(e&&e.errMsg&&c.log("ExternalAdViewService | Error calling "+f.handleGetViewVisibilityFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(n),l.PubSub.unsubscribe(t),r.reject(e))});return c.callSDKFunction(D(),{functionName:f.NativeAPI.getViewVisibility,functionParams:{adViewId:I()}},f.handleGetViewVisibilitySuccess,f.handleGetViewVisibilityFailure),r.promise()}r.reject({errMsg:"adViewId is missing"})},removeExternalAdView:function(e,t,n){c.callSDKFunctionWithCallback(D(),{functionName:f.NativeAPI.removeAdView,functionParams:{adViewId:e}},t,n)},setBannerHandlerDelegate:function(e){}}}},{"../../constants/SDKFeatureNames":91,"./ExternalAdViewConstants.js":72,"./WPADUtils":76,"./bannerLoadWhileShowHandler":79}],74:[function(e,t,n){var b=e("./ContainerCreationStateHandler"),S=e("./WPADUtils");t.exports=function(o,t,s,e){var n="ExternalContainer | ",i=new S(t),d=new b(t.jQuery(),t.log),r=!1,a=!1,l=e,c=null,u=[];function f(e){a=e}function g(e){h("_setAdIsVisibleInContainer = "+e),r=e}function p(){return r}function v(){h("_resetReportAdVisibilityFlags"),f(!1),g(!1)}function m(){return h("_getContainerID: "+l),l}function h(e){t.log(n+e)}return u.push(o.PubSub.subscribe("SDKController.AdVisible",function(e){var t;h("inside adVisibleHandler"),h("_shouldReceiveMessage containerID: "+l+" adViewId: "+(t=e).adViewId),(i.isBannerAd(t)&&i.isBannerAdViewId(l)||t.adViewId===l)&&(h("got SDKController.AdVisible | setting visibility to true"),g(!0))})),{setAdIsVisibleInContainer:g,resetReportAdVisibilityFlags:v,createAdUrlInAdView:function(e,t,n,i){var r,a;h("_createAdUrlInAdView "+t.productType),v(),(r=i).shouldCreateContainer=(a=r,!!o.Utils.isDefined(a.adSize)&&!(!o.Utils.isDefined(a.adSize.width)||!o.Utils.isDefined(a.adSize.height))&&0<a.adSize.width&&0<a.adSize.height),c&&c.assignAdViewAndStartHandle(m()),function(e){if(e||!e.productType)var t=o.PubSub.subscribe(e.productType+".GetConfig",function(e){e.adViewId&&e.adViewId===l&&(o.PubSub.unsubscribe(t),d.creationEnded(!0))})}(t),d.creationStarted(),s.loadWithUrl(e,t,n,i,function(){h("native reported on webview creation")})},sendMessageToExternalAdView:function(e){e&&l&&(e.adViewId||(e.adViewId=l)),s.sendMessage(e)},onExternalViewLoaded:function(e,t,n){f(!0),h("_onExternalViewLoaded"),e.displayOnAdReady&&s.getViewVisibility().then(function(e){s.isContainerVisible(e)&&(p()||n())})},isAdInExternalViewLoaded:function(){return h("isAdInExternalViewLoaded "+a),a},getContainerID:m,removeContainer:function(e,t){s.removeExternalAdView(l,e,t)},isVisible:p,isContainerLoaded:function(){return d.getState()===d.getCreationStates().createdSuccessfully},clean:function(){h("_clean"),o.PubSub.clearHandlers(u),c&&(c.stopHandle(),c=null),s.destroy(),s=null},getContainerCreationHandler:function(){return d},shouldReportAdVisible:function(){return a&&!r},setAdInstanceHandler:function(e){c=e}}}},{"./ContainerCreationStateHandler":71,"./WPADUtils":76}],75:[function(e,t,n){t.exports=function(l,c,u){var f=l.jQuery(),g={none:0,device:1,controller:2};function p(e,t,n,i){l.isIOS()&&f("body").css("height",t.scrollHeight),u.setBackgroundColorByMode("Neutral",n),c.displayView(),l.callSDKFunction("setBackButtonState",{state:g.controller}),e(!1,!1,null),u.changeMode("Neutral"),i(),f("#ssaNavigator").removeClass("webNavigation").addClass("defaultNavigation"),l.isIOS()&&setTimeout(function(){l.callSDKFunction("navigationModeChange",{state:!1})},70)}return{changeToNavigationMode:function(e,t,n,i,r){var a,o,s,d;f("body").css("height",""),u.setBackgroundColorByMode("Navigation","WebControls"),u.changeMode("Navigation"),c.hideView(),c.hideLoader(),l.callSDKFunction("setBackButtonState",{state:g.device}),e(!1,null),a=e,o=n,s=i,d=r,t.unbind("touchend").bind("touchend",function(e){e.stopPropagation(),e.preventDefault(),f("#ssaNavigatorBackButton").unbind("touchend"),l.callSDKFunction("controlSecondaryWebView",{action:"close"}),l.callSDKFunction("removeCloseEventHandler"),p(a,o,s,d)}),f("#ssaNavigatorBackButton").unbind("touchend").bind("touchend",function(e){e.stopPropagation(),e.preventDefault(),l.callSDKFunction("removeCloseEventHandler"),l.callSDKFunction("controlSecondaryWebView",{action:"back"})}),f("#ssaNavigator").removeClass("defaultNavigation").addClass("webNavigation"),l.callSDKFunction("navigationModeChange",{state:!0})},returnFromNavigationMode:p}}},{}],76:[function(e,t,n){t.exports=function(a){var o=e("../../constants/SDKFeatureNames"),t=e("../../components/Constants.js"),s=e("../../components/OMIDConstants"),n="bannerAdView";function d(e){return e.productType===t.BN}return{generateAdViewId:function(e){return a.isBannerNoneLWS(e.productType)?n:a.AdUtils.generateUniqueAdId(e)},generateBannerAdViewId:function(){return t.bannerAdViewId},isBannerAdViewId:function(e){return-1!==e.indexOf(t.bannerAdViewId)},shouldDisplayAdOnExternalWebView:function(e,t){if(a.log("_shouldDisplayAdOnExternalWebView"),d(e))return!0;if(a.OMIDService.isAdOmidSupported(e)){var n=(i=a.OMIDService.getVersionData().omidVersion)&&s.omidVersionRequiresWebviewPerAd[i];return a.log("_shouldDisplayAdOnExternalWebView - OMID Ad - requires WPAD: "+n),n}var i,r;return(r=t)&&!0===r.webviewPerAd?a.CompatibilityService.isFeatureSupportedInNativeSDK(o.webviewPerAdV1)?!t||0!==t.numOfBannersToInitSuccess||0!==t.numOfBannersToCache||(a.log("_shouldDisplayAdOnExternalWebView - numOfBannersToInitSuccess 0 , numOfBannersToCache 0"),!1):(a.log("_shouldDisplayAdOnExternalWebView - not supported for sdk version"),!1):(a.log("_shouldDisplayAdOnExternalWebView - wpad flag is off"),!1)},isBannerAd:d,getBannerAdViewId:function(){return n}}}},{"../../components/Constants.js":13,"../../components/OMIDConstants":41,"../../constants/SDKFeatureNames":91}],77:[function(e,t,n){t.exports=function(i,d,r,l,c,u){var t="Webview | ",f=!1,g=!1,p=!1,a=null,o={on:!1,productConfig:null},v=d.jQuery();function m(){y("state- open: "+f+", viewable: "+g+"engaged "+p+" , productConfig: "+JSON.stringify(a))}function e(e,t){if(y("received event: "+e+" sendCloseRequest: "+JSON.stringify(o)),"close"===e&&s(t)){var n=d.DemandUtils.extendCallbackParamsWithParentProductConfig(t);i.PubSub.publish("SDKController.onAdWindowsClosed",[n]),d.callSDKFunction("onAdWindowsClosed",n)}}function h(e,t){var n=r[d.getDeviceOs()+e]?e:"Neutral",i=v.extend({},r[d.getDeviceOs()+n]);t&&(i.position=t),d.callSDKFunction("setForceClose",i)}function n(){d.callSDKFunction("setForceClose",r.disable)}function s(e){return o.on&&o.productConfig===e?(o.on=!1,o.productConfig=null,m(),!0):(m(),!1)}function b(e){a=d.DemandUtils.extendCallbackParamsWithParentProductConfig(e,{}),p=!0,m()}function S(e,t){h(e,t)}function y(e){d.log(t+e)}return i.PubSub.subscribe("SDKController.SetForceClose",function(e){var t;t=e,!i.Utils.isDefined(t.isEnable)||t.isEnable?S("Neutral",t.position):n()}),{setBackgroundColorByMode:function(e,t){"Navigation"===e?(c.setSDKWebviewBGColor(c.getSDKWebviewBGColorByProductType(t)),c.setControllerBGColor(c.getControllerBGColorByProductType(t))):"Neutral"===e&&(c.setControllerBGColor(c.getControllerBGColorByProductType(t)),c.setSDKWebviewBGColor(c.getSDKWebviewBGColorByProductType(t)))},display:function(e,t){if(e){if(d.isAndroid()||!f&&!g){var n=u.getAdDisplayOrientation(d.getConfig(),d.getApplicationExternalConfig(),e);d.OrientationService.setOrientation(n)}else y("avoiding setOrientation for new displayed ad");if(f||g)return y("be might here because of next offer, engaged is "+p),void(p=!0);var i,r;r={adViewId:t},(i=e)&&i.productType?d.getNotchService().onSetConfig(i)?(c.setSDKWebviewBGColor(c.backgroundColors.semiTransparent,r),c.setControllerBGColor(c.backgroundColors.semiTransparent)):i.settings.setContainerBGColorBlack?c.setControllerBGColor(c.backgroundColors.black):(c.setSDKWebviewBGColor(c.getSDKWebviewBGColorByProductType(i.productType),r),c.setControllerBGColor(c.getControllerBGColorByProductType(i.productType))):c.setControllerBGColor(c.backgroundColors.darkGrey),h(i.productType),b(e),d.ViewsManager.init(e,t);var a=d.DemandUtils.extendCallbackParamsWithParentProductConfig(e,d.ViewsManager.getDisplayWebViewParams(!0)),o=function(e){var t={};if(d.isAndroid()){var n=e.settings&&e.settings.immersive;v.extend(t,{immersive:n}),t.activityThemeTranslucent=!!e.settings.translucentView,t.removeViewOnDestroy=!0,e.settings.sambsfix&&(y("ctrWVPauseResume=true"),t.ctrWVPauseResume=!0)}return d.isIOS()&&v.extend(t,{appOrientation:d.AppOrientationManager.getOrientation(),ModalPresentationStyle:l.iOS_UIModalPresentationFullScreen}),t}(e);y("display platformParams: "+JSON.stringify(o)),y("display displayParams: "+JSON.stringify(a));var s=v.extend(o,a,{});d.callSDKFunction(l.nativeInterfaceMethod.displayWebView,s),f=!0,m()}},hide:function(){f&&function(){var e,t=new v.Deferred;d.log("webview | hide | "+JSON.stringify(a),d.LogLevels.verbose);var n=d.DemandUtils.extendCallbackParamsWithParentProductConfig(a,d.ViewsManager.getDisplayWebViewParams(!1));return e=i.PubSub.subscribe(l.CB+"."+l.nativeCallBacks.hideSuccess,function(){i.PubSub.unsubscribe(e),t.resolve()}),d.callSDKFunction(l.nativeInterfaceMethod.displayWebView,n,l.nativeCallBacks.hideSuccess,l.nativeCallBacks.hideFailed),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer(),t.promise()}().then(function(){f=!1,o.productConfig=a,o.on=!0,m(),p||e("close",a)})},setVisibility:function(e){g=e,m()},shouldNotifyClose:s,loadProduct:b,unloadProduct:function(){p=!1,m(),o.on&&e("close",a)},changeMode:S,disableForceClose:n,setWebviewBGColorTransparent:function(){c.setControllerBGColor(c.backgroundColors.transparent)},setControllerBGColor:function(e){c.setControllerBGColor(c.getControllerBGColorByProductType(e))},getState:function(){return{engaged:p,opened:f,productConfig:a,viewable:g,standalone:!1}},redraw:function(){d.isAndroid()&&20<=d.getConfigurationHelper().getDeviceApiLevel()&&(c.setSDKWebviewBGColor(c.backgroundColors.black),c.setSDKWebviewBGColor(c.backgroundColors.transparent))}}}},{}],78:[function(e,t,n){var T=e("./ExternalContainer"),O=e("./ExternalAdViewService"),F=e("./ExternalAdViewConstants"),i=e("./AdViewsCollections"),x=(e("../../constants/SDKFeatureNames"),e("./BannerHandlerDelegate"));t.exports=function(b,S,y,A){var C="WebViewManager | ",D=e("./WPADUtils")(S),I=S.jQuery(),w=new i({controller:S});function r(e){if(e)return P("_getAdViewByAd "+e.adViewId),w.getAdViewById(e.adViewId)}function P(e){S.log(C+e)}return{loadAdUnitUrlToView:function(e,t,n,i){var r,a,o,s,d;if(r=e,b.PubSub.subscribe(r.productType+".reset",function(e){P("webViewManager | reset"),w.toArray().forEach(function(e){e.getContainerID()===D.getBannerAdViewId()&&(w.removeAdViewById(e.getContainerID()),e.clean())})}),S.log(C+"_loadAdUnitUrlToView"),t&&e){var l,c,u=(s=e,d=new O(b,S,y,A),s.adViewId=D.generateAdViewId(s),S.isBannerNoneLWS(s.productType)?d.init(F.nativeFunction,s.adViewId):d.init(F.nativeFunctionAdViewAPI,s.adViewId),new T(b,S,d,s.adViewId));l=e,c=u.getContainerID(),e=I.extend(l,{adViewId:c}),w.add(u);var f,g,p=(f=i,g=u.getContainerID(),I.extend(f,{adViewId:g}));a=p,p=(o=e).adSize?I.extend(a,{adSize:o.adSize}):a;var v,m,h=(v=t,m=u.getContainerID(),v+"&"+y.adViewIdString+"="+m);!function(e,t,n){if(P("assignAdInstanceHandlerToExternalContainer | id: "+n.getContainerID()),n&&S.isBannerAndLoadWhileShowSupported(e)){var i=new x(b,S,y,A,t);n.setAdInstanceHandler(i)}}(e.productType,e.demandSourceId,u),u.createAdUrlInAdView(h,e,n,p)}else P("_loadAdUnitUrlToView without ad/url")},updateAdUnitUrl:function(e,t,n,i){},displayAdView:function(e,t,n,i){P("_displayAdView"),A.set(e),I.when(i(e)).then(function(){P("_displayView after adunitOpenCallback"),t(!1),n()})},handleScreenVisible:function(e,t){P("_handleScreenVisible");var n=r(t);n.sendMessageToExternalAdView({message:"handleScreenVisible",adViewId:n.getContainerID()})},unloadAdView:function(e){P("_unloadAdView "+e.adViewId);var n=r(e);n?n.removeContainer(function(e){if(e&&e.adViewId===n.getContainerID()){P("_unloadAdView | successCallback | removed id"+e.adViewId);var t=w.removeAdViewById(n.getContainerID());b.Utils.isEmptyObject(t)||t.clean()}},function(e){if(e&&e.adViewId===n.getContainerID()){b.PubSub.publish("SDKController.removeContainerError",[e]),P("_unloadAdView | failCallback | id"+e.adViewId);var t=w.removeAdViewById(n.getContainerID());b.Utils.isEmptyObject(t)||t.clean()}}):P("_unloadAdView | ad is not engaged / no external container")},displayLoader:function(e){P("_displayLoader");var t=r(e);t&&t.sendMessageToExternalAdView({message:"displayLoader",adViewId:t.getContainerID()})},hideLoader:function(e){P("_hideLoader");var t=r(e);t&&t.sendMessageToExternalAdView({message:"hideLoader",adViewId:t.getContainerID()})},hideView:function(e){P("_hideView ad: "+JSON.stringify(e));var t=r(e);t&&t.sendMessageToExternalAdView({message:"hideFrame",adViewId:t.getContainerID()})},displayView:function(e){P("_displayView ad: "+JSON.stringify(e));var t=r(e);t&&t.sendMessageToExternalAdView({message:"displayFrame",adViewId:t.getContainerID()})},isContainerLoaded:function(e){var t=r(e),n=!!t&&t.isContainerLoaded();return P("_isContainerLoaded: "+n),n},onAdUnitLoaded:function(e,t,n){P("_onAdUnitLoaded");var i=r(e);i&&(i.isAdInExternalViewLoaded()?P("already received the loaded event for container"):(i.onExternalViewLoaded(e,t,n),P("ad loaded:"+e.id)))},isAdViewExistForAd:function(e){return P("_isAdViewExistForAd"),!!e&&w.isExist(e.adViewId)},getAdViewByAd:r,sendMessageToDisplayedAdView:function(e){P("_sendMessageToDisplayedAdView");var t=r(A.get());t&&t.sendMessageToExternalAdView(e)},sendMessageToAllAdViews:function(t){P("_sendMessageToAllAdViews"),w.toArray().forEach(function(e){e.sendMessageToExternalAdView(t)})},getDisplayedAdView:function(e){P("_getDisplayedAdView ad: "+JSON.stringify(e));var t=r(e);return t&&(P("external container visible="+t.isVisible()),t.isVisible())?t:null},isViewDisplayed:function(e){return e.isVisible()},getContainerCreationHandler:function(e){var t=r(e);return t?t.getContainerCreationHandler():null}}}},{"../../constants/SDKFeatureNames":91,"./AdViewsCollections":65,"./BannerHandlerDelegate":70,"./ExternalAdViewConstants":72,"./ExternalAdViewService":73,"./ExternalContainer":74,"./WPADUtils":76}],79:[function(e,t,n){var i=e("./ExternalAdViewConstants.js");t.exports=function(t,n){return{handleVisible:function(e){e.adViewId&&(n.log("ExternalAdViewService | bannerMultipleInstancesHandler| handleVisible: isVisible."+e.adViewId,n.LogLevels.error),t.PubSub.publish("Banner.isVisible",[e]),t.PubSub.publish("isVisible."+e.adViewId,[e]))},handleRemoved:function(e){e.adViewId&&(n.log(" ExternalAdViewService | bannerMultipleInstancesHandler | "+i.handleContainerWasRemoved,n.LogLevels.error),t.PubSub.publish("removed."+e.adViewId,[e]))},handlePerformDestroy:function(e){e.adViewId&&(n.log(" ExternalAdViewService | bannerMultipleInstancesHandler | handlePerformDestroy params.adViewId="+e.adViewId),t.PubSub.publish("destroy."+e.adViewId,[e]))}}}},{"./ExternalAdViewConstants.js":72}],80:[function(n,e,t){e.exports=function(i,e,t){var r,a,s=n("../OrientationUtils.js")(),o=t.appInfo.orientation.none,d=!1,l={free:t.appInfo.orientation.none,portrait:t.appInfo.orientation.portrait,landscape:t.appInfo.orientation.landscape};function c(e,t,n){d=!1;var i=l[(e||"").toLowerCase()];if(i)return d=!0,i;if(!n)return t;var r,a=s.sharedOrientationBetweenOrientations(n.viewControllerToPresentFrom||n.topMostViewControllerOrientation,n.windowOrientation),o=(r=(a&&0<a.length?s.convertOrientationsArrayToNumber(a):n.windowOrientation).toString(),s.isContainPortrait(r)&&s.isContainLandscape(r)?l.free:s.isContainPortrait(r)?l.portrait:l.landscape);return o!==t&&(d=!0),o}return{init:function(e,t){r=e,a=t.appOrientation,o=c(r,a,t.orientationRestriction)},getOrientation:function(){return o},isAppOrientation:function(e){return o===e},isChangedExternally:function(){return d},updateAppOrientationByNewRestriction:function(e){if(e){var t,n=o;o=c(r,a,e),n!==(t=o)&&i.PubSub.publish("AppOrientationManager.appOrientationChanged",[{appOrientation:t}])}}}}},{"../OrientationUtils.js":49}],81:[function(e,t,n){function i(r,a,e){var o=e||{},t,s,d=!1,l=a.Cache,c={campaignsOnly:"campaignsOnly",globalsOnly:"globalsOnly",globalsAndCampaigns:"globalsAndCampaigns"},n=!1,i=!1,u=a.jQuery();function f(e){n=e}function g(e,t,n){return l.cacheAds(o,e,t,n)}function p(e,t,n){return setTimeout(function(){!0,a.log("Time out in update cache. Fallback to non-precache.",a.LogLevels.error),r.PubSub.publish("PrecacheManager.fallbackToNonPrecache",[{demandSourceName:o.demandSourceName,productType:o.productType}]),v(!1),r.PubSub.publish("Cache.StopCacheUpdate",[{demandSourceName:o.demandSourceName,productType:o.productType}]),f(!1),l.clearCacheByType(o,[]).then(function(){t()}).fail(function(){var e="Error deleting globals in fallback to NPC";a.log(e,a.LogLevels.error),n(e)})},o.nonPrecacheFallback)}function v(e){t=e}function m(i){s=p(d,i.cacheTimeoutSuccessCallback,i.cacheTimeoutFailCallback),f(!0),g(i.applicationKey,i.newAdsToEnterCache,i.adAssetsCacheConfig).then(function(){a.log("PM | success",a.LogLevels.verbose),clearTimeout(s),d||(a.log("cache update completed",a.LogLevels.verbose),f(!1),r.PubSub.publish("PrecacheManager.cacheAdsSuccessCallback",[o]))},function(e,t,n){if(clearTimeout(s),!d){f(!1),r.PubSub.publish("PrecacheManager.cacheAdsFailedCallback",[{productType:o.productType,demandSourceName:o.demandSourceName,deletedOffers:t,deletedAdsData:n,errorLog:"Error adding new ads from queue, some campaigns were deleted.",cacheParam:e,inventoryId:i.inventoryId}])}})}function h(e){a.log("PrecacheManager | updateConfig"),u.extend(o,e)}function b(e){var t=e.numOfCampaigns||0,n=e.settings||{};return h({settings:n}),0<=n.numOfBannersToInitSuccess&&0<t&&0<n.numOfBannersToCache?(n.numOfBannersToCache<n.numOfBannersToInitSuccess&&(n.numOfBannersToInitSuccess=n.numOfBannersToCache),t<n.numOfBannersToInitSuccess&&(n.numOfBannersToInitSuccess=t),t<n.numOfBannersToCache&&(n.numOfBannersToCache=t),v(!0),n.maxCachedCampaigns=o.maxCachedCampaigns,l.setSettings(o,n)):(n.numOfBannersToInitSuccess=n.numOfBannersToCache=0,v(!1)),r.Utils.returnResolvedPromise()}function S(e){return e&&e.cacheBase===o.cacheBase}function y(){r.PubSub.subscribe("Cache.cacheUpdated",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.cacheUpdatedCallback",[e]))}),r.PubSub.subscribe("Cache.campaignDeleted",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.campaignDeletedCallback",[e]))}),r.PubSub.subscribe("Cache.campaignSaved",function(e){if(S(e)){var t=u.extend({},e,o);r.PubSub.publish("PrecacheManager.campaignSavedCallback",[t])}}),r.PubSub.subscribe("Cache.campaignDownloadStarted",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.campaignDownloadStartedCallback",[e]))}),r.PubSub.subscribe("Cache.preProcessingFailed",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.preProcessingFailedCallback",[e]))})}function A(){return t}function C(){var e,t,n=new u.Deferred,i=A();function r(e){n.resolve(e)}return o.settings.purgeCacheOnInit?(t="purge cache on init (settings)",e=!0):i||(t="purge cache on non-precache",e=!0),e?(a.log("handleCacheClear purge reason: "+t,a.LogLevels.verbose),l.clearCacheByType(o,[]).then(r.bind(null,c.campaignsOnly),function(){n.reject("Error in clearing cache")})):r(),n.promise()}function D(e){A()&&(f(!0),l.cacheNext(o,e).always(function(){f(!1)}).fail(function(e,t,n){a.log("line[451]: failed updating cache on cache next with deletedAds: "+t,a.LogLevels.verbose),t&&0<t.length&&r.PubSub.publish("PrecacheManager.cacheNextFail",[{productType:o.productType,demandSourceName:o.demandSourceName,deletedAds:t,deletedAdsData:n,inventoryId:t[0].inventoryId}])}))}function I(){return c}function w(){return l.getNextAvailableAd(o)}function P(e){return l.clearCacheByType(o,e)}function T(e,t){return t=r.Utils.isDefined(t)?t:o.settings.numOfBannersToCache,l.mergeCampaigns(e,t,o.settings.maxCachedCampaigns,o)}function O(e,t){return l.areCampaignsAvailable(e,t,o)}function F(){return l.getCacheSizeByType(o)}function x(){return l.incrementNextCampaign(o)}function L(e){return l.getCurrentAd(o,e)}function N(e){return l.isNextAvailable(o,e)}function U(){return l.cacheNext(o)}function V(e,t){return l.setAdInventoryIndex(o,e,t)}function M(e){return l.isAdInCache(o,e)}function E(e){return l.setSettings(o,e)}function k(){i||(i=!0,y(),l.initCacheBase(o.cacheBase))}function K(e){return l.getAdStatusInQueue(o,e)}function B(e){return l.deleteCachedCampaign(o,e)}function R(e,t){return l.cacheSingleAd(o,e,t)}var j={updateConfig:h,init:k,decidePrecacheStatus:b,isPrecache:A,handleCacheClear:C,mergeCampaigns:T,handleCacheAds:m,updateCache:D,clearCacheByType:P,areCampaignsAvailable:O,getCacheSizeByType:F,setAdInventoryIndex:V,incrementNextCampaign:x,getCurrentAd:L,isAdInCache:M,getAdStatusInQueue:K,setCacheSettings:E,getNextAvailableAd:w,isNextAvailable:N,getCacheClearMessages:I,cachingStatus:l.cachingStatus,deleteCachedCampaign:B,cacheSingleAd:R,getConfig:function(){return o}};return j}t.exports=i},{}],82:[function(e,t,n){t.exports=function(n){var i=e("./SDKPluginTypeConstants.js");return{shouldShowInStandAloneView:function(e){var t=e.getApplicationExternalConfig().getGeneralConfig()[i.microJobFlags.showStandaloneViewInAdobe];return null!==t&&n.isDefined(t)||(t=!0),e.log("AdobeAirPluginHandler | shouldShowInStandAloneView | useStandAloneView: "+t),t}}}},{"./SDKPluginTypeConstants.js":83}],83:[function(e,t,n){t.exports={supportedPluginNames:{adobeAir:"AdobeAir"},microJobFlags:{showStandaloneViewInAdobe:"showStandaloneViewInAdobe"}}},{}],84:[function(o,e,t){e.exports=function(n,i){var r=o("./SDKPluginTypeConstants.js");function a(e){return(t=e).applicationSettings&&t.applicationSettings.SDKPluginType&&t.applicationSettings.SDKPluginType===r.supportedPluginNames.adobeAir?(n.log("SDKPluginTypeHandler | createPluginHandler | creating adobe handler"),new(o("./AdobeAirPluginHandler.js"))(i)):(n.log("SDKPluginTypeHandler | createPluginHandler | plugin handler is not required"),null);var t}return{shouldShowInStandAloneView:function(e){n.log("SDKPluginTypeHandler | shouldShowInStandAloneView");var t=a(e);return t&&"function"==typeof t.shouldShowInStandAloneView?t.shouldShowInStandAloneView(n):(n.log("SDKPluginTypeHandler | shouldShowInStandAloneView | "+(t?"function not supported in handler":"no plugin handler")),!1)}}}},{"./AdobeAirPluginHandler.js":82,"./SDKPluginTypeConstants.js":83}],85:[function(e,t,n){t.exports={versions:{SKAN1:1,SKAN2:2},applicationSettingsKeys:{skd:"skd",skanv:"skanv",atid:"atid",providers:"providers",skanIds:"skanIds"},controllerConfigKeys:{SKANData:"SKANData",version:"version",sourceAppTrackID:"sourceAppTrackID",adNetworkIDs:"adNetworkIDs"},nativeParamsKeys:{adNetworkId:"adNetworkId",adNetworkCampaignId:"adNetworkCampaignId",id:"id",adNetworkNonce:"adNetworkNonce",adNetworkImpressionTimestamp:"adNetworkImpressionTimestamp",adNetworkAttributionSignature:"adNetworkAttributionSignature",adNetworkPayloadVersion:"adNetworkPayloadVersion",adNetworkSourceAppStoreIdentifier:"adNetworkSourceAppStoreIdentifier"},SKAdImpression:{minimalSupportedIOSVersion:14.5,jsInterface:"SKAdImpressionAPI",startImpression:"startImpression",startImpressionSuccess:"startImpressionSuccess",startImpressionFailed:"startImpressionFailed",endImpression:"endImpression",endImpressionSuccess:"endImpressionSuccess",endImpressionFailed:"endImpressionFailed"}}},{}],86:[function(e,t,n){t.exports=function(){var c=e("./SKANConstants");function u(e,t,n){var i={};return e&&(i.SKANVersion=e),t&&(i.SKANSourceAppTrackID=t),n&&Array.isArray(n)&&0<n.length&&(i.SKANAdNetworkIDs=n.toString()),i}function i(e){if(!e)return{};var t=parseFloat(e.version);return t?t<c.versions.SKAN2?r(e):a(e):n(e)}function n(e){var t={};return t[c.nativeParamsKeys.id]=e.advertisedAppTrackID||e.appId,t}function r(e){var t=n(e);return t[c.nativeParamsKeys.adNetworkId]=e.adNetworkID,t[c.nativeParamsKeys.adNetworkImpressionTimestamp]=e.timestamp,t[c.nativeParamsKeys.adNetworkNonce]=e.nonce&&e.nonce.toLowerCase(),t[c.nativeParamsKeys.adNetworkAttributionSignature]=e.signature,t[c.nativeParamsKeys.adNetworkCampaignId]=e.SKANCampaignID,t}function a(e){var t=r(e);return t[c.nativeParamsKeys.adNetworkPayloadVersion]=e.version,t[c.nativeParamsKeys.adNetworkSourceAppStoreIdentifier]=e.sourceAppTrackID,t}function t(e,t){return jQuery.extend({},e.settings&&e.settings.SKANData,e.ext&&e.ext.SKANData,e.ext&&e.ext.SKANData&&e.ext.SKANData[t])}return{extractDataForPayload:function(e,t){var n=function(e){var t=!!e&&e[c.applicationSettingsKeys.skd];if(!t)return{};var n=t[c.applicationSettingsKeys.skanv],i=t[c.applicationSettingsKeys.atid],r=t[c.applicationSettingsKeys.providers],a=[];if(r)for(var o=0,s=Object.keys(r);o<s.length;o++){var d=s[o];if(r[d]){var l=r[d][c.applicationSettingsKeys.skanIds];l&&Array.isArray(l)&&0<l.length&&(a=a.concat(l))}}return u(n,i,a)}(t);return 0===Object.keys(n).length&&(n=function(e){if(!e)return{};var t=e[c.controllerConfigKeys.SKANData];if(!t)return{};var n=t[c.controllerConfigKeys.version],i=t[c.controllerConfigKeys.sourceAppTrackID],r=t[c.controllerConfigKeys.adNetworkIDs];return u(n,i,r)}(e)),n},extractDataForSKAdImpression:function(e){return a(t(e,"VTA"))},buildStoreKitLoadDataForSDK:function(e,t){if(!e)return{};var n={appId:e.appId,viewUniqueId:t,storeKitLoadParams:i(e)};return e.ppid&&(n.storeKitLoadParams.ppid=e.ppid),n},extractDataForSKOverlay:function(e){return e?i(t(e,"StoreKit")):{}}}}},{"./SKANConstants":85}],87:[function(e,t,n){t.exports=function(e,t,n,i){var r=parseInt(e),a=0,o=function(e){return!!r&&(-1!==n.storeKit.loadFailuresToPreventRetry.indexOf(e)?(i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | stop executing retries for reason: "+e),!1):(r<=a&&i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | All retries attempts exhausted"),a<r))};return{shouldPerformRetry:o,performRetry:function(){a++,"function"==typeof t&&(i("StoreKitLoadingRetryExecutor | _performRetry | Performing retry attempt #"+a),t())},getCurrentAttempt:function(){return a},cancelAdditionalRetryAttempts:function(){o=function(){return!1}}}}},{}],88:[function(e,t,n){t.exports=function(h,b,S){var t=e("../../patches/PatchStoreKitOsVersion"),y=e("./SKANModel")(),A=e("../../constants/SDKFeatureNames"),C=e("./StoreKitLoadingRetryExecutor"),D="NativeCallback",n=!1;function I(e){return e.viewIdentifier?e.viewIdentifier:e.viewUniqueId}function w(e,t){var n={isViewable:e,changeReason:t};h.PubSub.publish(D+".viewableChange",[n])}function P(e){n=e}function T(){return!b.CompatibilityService.isFeatureSupportedInNativeSDK(A.loadStoreKitOncePerAd)}function O(e){if(F()){if(!e)return;b.callSDKFunction("clearAppPage",{viewUniqueId:e})}}function F(e){if(!b.isIOS())return!1;try{if(parseInt(b.getConfig().mobileSDKSettings.deviceApiLevel)<S.storeKit.minimalSupportedOSVersion)return!1}catch(e){b.log("StoreKitService | isStoreKitSupported | failed to parse deviceApiLevel as integer")}return!(t(h.Utils,b.CompatibilityService).shouldBlock(b.getApiData({deviceOSVersion:1}).deviceOSVersion)||e&&!0===e.standaloneView)}return h.PubSub.subscribe("SDKController.PreloadAppInstallPage",function(e){b.log("SDKController.PreloadAppInstallPage"),b.checkRequiredCallbackParams(["appId"],e,"preloadAppInstallPage").didSucceed?function e(n,t){var i,r,a=I(n),o=(r=n.productType)&&b.getApplicationExternalConfig().getABTestConfiguration(r).storeKitLoadingTimeout||3e4,s=t||C(n.loadRetryAttempts,m,S,b.log);if(F(n)){var d=y.buildStoreKitLoadDataForSDK(n,a);b.callSDKFunction("preLoadAppPage",d,"preloadAppInstallPageSuccess","preloadAppInstallPageFailure");var l=h.PubSub.subscribe(D+".appStoreInsideLoaded",function(e){if(e&&"object"==typeof e&&e.viewUniqueId&&e.viewUniqueId===a){clearTimeout(i),h.PubSub.unsubscribe(l),n.callback&&(e.isLoaded||(e.currentLoadRetryAttempt=s.getCurrentAttempt()),n.callback.call(null,e));var t=e.errMsg&&decodeURIComponent(e.errMsg);!e.isLoaded&&s.shouldPerformRetry(t)&&s.performRetry()}}),c=h.PubSub.subscribe(D+".appStoreInsideDisplayStoreKit",function(e){if(e.viewUniqueId=I(e),b.log("appStoreInsideDisplayStoreKit "+e.viewUniqueId,b.LogLevels.verbose),e.viewUniqueId===a){P(!0);var t=jQuery.extend({name:"appStoreInsideVisible",shouldPreloadStoreKitOnStoreKitClose:T()},e);b.postAdUnitEvent(t),w(!1,"storeKitOpen"),b.SKOverlayManager.onSKOpen()}}),u=h.PubSub.subscribe(D+".appStoreInsideClosed",function(e){e.viewUniqueId===a&&(!1!==e.didStoreKitPresent&&!1!==e.isClosed?(p(e),b.SKOverlayManager.onSKClose()):g(e))}),f=h.PubSub.subscribe("SDKController.ClearAppPage",function(e){e.viewUniqueId===a&&(b.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?(h.PubSub.unsubscribe(f),v()):b.log("error calling clear App install page with "+JSON.stringify(e),b.LogLevels.error))}),g=function(e){s.cancelAdditionalRetryAttempts(),b.CompatibilityService.isFeatureSupportedInNativeSDK(A.loadStoreKitOncePerAd)&&O(e.viewUniqueId),b.log("storeKit Failed to Load ",b.LogLevels.verbose),v()},p=function(e){P(!1);var t=jQuery.extend({name:"appStoreInsideClosed",shouldPreloadStoreKitOnStoreKitClose:T()},e);b.postAdUnitEvent(t),w(!0,"storeKitClose"),T()&&(h.PubSub.unsubscribe(c),h.PubSub.unsubscribe(u))},v=function(){h.PubSub.unsubscribe(l),h.PubSub.unsubscribe(u),h.PubSub.unsubscribe(c)};i=setTimeout(function(){b.log("reach appstoreinside loading timeout",b.LogLevels.verbose),b.postAdUnitEvent({name:"appStoreLoadingTimeout",viewUniqueId:a,currentLoadRetryAttempt:s.getCurrentAttempt(),errMsg:S.storeKit.loadingTimeoutMessage},!0),s.shouldPerformRetry(S.storeKit.loadingTimeoutMessage)?s.performRetry():(v(),O(a))},o)}function m(){clearTimeout(i),O(a),e(n,s)}}(e,null):b.log("error calling preload App install page with "+JSON.stringify(e),b.LogLevels.error)}),h.PubSub.subscribe("SDKController.ClearAppPage",function(e){e.viewUniqueId=I(e),b.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?e&&e.viewUniqueId&&O(e.viewUniqueId):b.log("error calling clear App install page with "+JSON.stringify(e),b.LogLevels.error)}),{updateAdWithStoreAppId:function(e,t){if(e&&e.ext&&e.ext.clickTags&&e.ext.clickTags.storeAppId&&!F(t)&&delete e.ext.clickTags.storeAppId,t&&(void 0===(i=t.extractAppIdForStoreKit)||i)&&F(t)&&e&&e.ext&&e.ext.clickTags&&!e.ext.clickTags.storeAppId&&e.ext.clickTags.pixelURL){var n=b.AdUtils.getStoreAppId(e);n&&(e.ext.clickTags.storeAppId=n)}var i;return e},getViewUniqueId:I,isStoreKitVisible:function(){return n}}}},{"../../constants/SDKFeatureNames":91,"../../patches/PatchStoreKitOsVersion":168,"./SKANModel":86,"./StoreKitLoadingRetryExecutor":87}],89:[function(e,t,n){t.exports={NativeAPI:{failCallback:"updateTokenFail",successCallback:"updateTokenSuccess"},ControllerNativeAPI:{updateToken:"updateToken"},tokenAPI:"iabTokenAPI",payloadKeys:{common:{biddingRVImpressions:!0,biddingISImpressions:!0,totalRVSessionImpressions:!0,totalISSessionImpressions:!0,auid:!0},android:{gpi:!0,blacklistedCampaigns:!0},ios:{}}}},{}],90:[function(o,e,t){e.exports=function(e,r,t,n,i){var a=o("./TokenConstants");return e.PubSub.subscribe(t.CB+"."+a.NativeAPI.failCallback,function(e){r.log("TokenService | updateTokenFail: "+JSON.stringify(e));var t=e.errMsg?e.errMsg:"unknown";n.trackEvent(i.updateTokenFail,{generalMessage:t})}),{updateToken:function(e){var t=function(e){if(!e)return{};var t={},n=a.payloadKeys.common;for(var i in jQuery.extend(n,a.payloadKeys[r.getConfig().mobileSDKSettings.deviceOs]),n)n.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(e);r.log("TokenService | _updateNativeToken | data: "+JSON.stringify(t)),0!==Object.keys(t).length&&r.callSDKFunction(a.tokenAPI,{functionName:a.ControllerNativeAPI.updateToken,functionParams:t},null,a.NativeAPI.failCallback)}}}},{"./TokenConstants":89}],91:[function(e,t,n){t.exports={bannerMultipleInstances:"bannerMultipleInstances",storeKitDismissVCOnFinishCallback:"storeKitDismissVCOnFinishCallback",limitAppFiltering:"disableCheckInstalledAppsJSInterface",noPackagesInstallationPolling:"noPackagesInstallationPolling",webviewPerAdV1:"webviewperad-v1",loadStoreKitOncePerAd:"loadStoreKitOncePerAd",SKAdImpression:"SKAdImpression",SKOverlay:"SKOverlay",bannersOpenMeasurement:"bannersOpenMeasurement"}},{}],92:[function(e,t,n){t.exports={pullingNativeDeviceData:{ios:"5.76",android:"5.81"},mutableAdvertingTrackingData:{ios:"5.79",android:"99"}}},{}],93:[function(e,t,n){var u={ext:{clickTags:{backgroundLandscape:"",backgroundPortrait:""},videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:"",appImages:{both:[],portrait:[],landscape:[]}}}},f={ext:{videoData:{videoSource:{vast:""}}}},g={ext:{vastData:{xmlResponse:""}}},p={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:{url:""},appImages:[{url:""}]},imageData:{landscape:"",portrait:""}}},v={ext:{imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}},m={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},layoutData:{html:""}}},h={ext:{videoData:{videoSource:{videoformat_mp4:""}},clickTags:{backgroundLandscape:""}}},b={ext:{videoData:{videoSource:{html:""}}}},S={ext:{videoData:{videoSource:{videoformat_mp4:""}},appData:{appIcon:""}}},y={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}};t.exports=function(){var s=function(e,t){return t+e.split("/").pop()},r=function(e,t){for(var a=[],n=Object.keys(t),i=0;i<n.length;i++)e[n[i]]&&o(t[n[i]],e[n[i]]);function o(e,t){var n,i;if("string"==typeof e)a.push(t);else if(e instanceof Array&&0===e.length)a=a.concat(t);else if(e instanceof Array&&0<e.length&&t instanceof Array&&0<t.length)for(n=0;n<t.length;n++)for(i=0;i<e.length;i++)o(e[i],t[n]);else{var r=Object.keys(e);for(n=0;n<r.length;n++)t[r[n]]&&o(e[r[n]],t[r[n]])}}return a};function o(e){return!!e.src&&e.src}function d(e){var t,n=r(e,c(e)),i=0<n.length&&n[0];return!!i&&((t=document.createElement("div")).innerHTML=i,t.firstChild)}function l(e){return e.ext&&e.ext.ableToCache}function i(e){return e&&e.type&&"playableAd"===e.type}function a(e){return e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.videoformat_mp4}function c(e){if(e.ext)return e.ext.layoutData?e.ext.layoutData.portrait&&e.ext.layoutData.landscape?a(e)?y:v:m:e.ext.appData&&e.ext.appData.appImages&&Array.isArray(e.ext.appData.appImages)?p:e.ext.clickTags&&e.ext.clickTags.backgroundLandscape&&e.ext.videoData.videoformat_mp4?h:i((n=e).ext)&&n.ext.videoData&&n.ext.videoData.videoSource&&n.ext.videoData.videoSource.html?b:a(t=e)&&t.ext.appData&&t.ext.appData.appIcon&&!t.ext.appData.appImages?S:u;var t,n}return{extractStaticFiles:function(e,t){return e.ext&&i(e.ext)?function(e,t){var n=[];if(t&&l(e)){var i=d(e);if(!i)return n;var r=o(i);if(r){n.push(r);var a=function(e){var t,n=[];if(t=e.getAttribute("data-assets"))try{n=(n=JSON.parse(t))&&n.assets?n.assets:[]}catch(e){}return n}(i);a&&0<a.length&&(n=n.concat(a))}}return n}(e,t):r(e,c(e))},extractVastSource:function(e){var t=e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse?g:f;return r(e,t)},updateAdunitPrecachePath:function(e,t,n){return e.ext&&i(e.ext)?function(e,t){var n=d(e),i=o(n);if(l(e)&&i&&n){var r=s(i,t);n.src=r,e.ext.videoData.videoSource.html=n.outerHTML}}(e,t):function(e,a,t){for(var n=Object.keys(t),i=0;i<n.length;i++)e[n[i]]&&(e[n[i]]=o(t[n[i]],e[n[i]]));function o(e,t){var n,i;if("string"==typeof e||"string"==typeof t)t=s(t,a);else if(e instanceof Array&&0===e.length)for(n=0;n<t.length;n++)t[n]=s(t[n],a);else if(e instanceof Array&&0<e.length&&t instanceof Array&&0<t.length)for(n=0;n<t.length;n++)for(i=0;i<e.length;i++)t[n]=o(e[i],t[n]);else{var r=Object.keys(e);for(n=0;n<r.length;n++)t[r[n]]&&(t[r[n]]=o(e[r[n]],t[r[n]]))}return t}return e}(e,t,c(e))},getPlayableCacheFlag:function(){return"isPrecacheable"},isAdAbleToCache:l}}},{}],94:[function(e,t,n){t.exports={adunitFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},owFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},environment:{develop:"dev",production:"prod",stage:"stage"},adunitAssetsJsonKeys:{html:"html",js:"js",css:"css",sprite:"sprite",libs:"libs",graphicAssets:"graphicAssets",adunitVersion:"adunitVersion"},adunitVersionKey:"adunitVersion",adunitLibsFileName:"adunitLibsFile",adunitGlobalsErrorMsgs:{failedDownloadingAssetsJson:"Failed downloading adunitStaticAssets.json",invalidAdunitAssetsJson:"Missing parameters in adunitStaticAssets.json",failedDownloaingGraphicAssets:"Failed to download adunit graphic assets",failedToRetrieveAdunitUrl:"Failed to retrieve Adunit url"},apiResponseTimeout:15e3}},{}],95:[function(e,t,n){t.exports=function(e,t,n,i,r){var a=e||{},o=t||{},s=n&&n.debug,d=n&&n.domain,l=n&&n.scdn,c=n&&n.protocol,u=n&&n.adunitConfig,f=i,g=r||{};function p(){return c+"//"+function(){if(s&&0<parseInt(s)&&"www.supersonicads.com"!==d){var e=d.split(".")[0];return d+"/users/staging/"+e}return l}()+"/adunit/dist/adunitAssets.json"}function v(){return o.ajax({dataType:"json",url:p(),timeout:g.apiResponseTimeout}).then(function(e,t,n){if(e&&(e.libs&&e.libs.adunitVersion||e.adunitVersion))return e;var i=o.Deferred();return i.reject(g.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson),i.promise()},function(e,t,n){return g.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson})}function m(e){return e&&e.libs&&(e.adunitVersion||e.libs.adunitVersion)&&e.graphicAssets}return{getGlobalAssetsJSON:function(){return f===g.environment.develop?v():m(u)?a.Utils.returnResolvedPromise(u):v().then(function(e){return m(e)?a.Utils.returnResolvedPromise(e):a.Utils.returnRejectedPromise(g.adunitGlobalsErrorMsgs.invalidAdunitAssetsJson)})},setProtocol:function(e){c=e}}}},{}],96:[function(K,e,t){function n(n){var c,u,f,g,p,v,m,h,b,S,y,A,C,r,a,o,s,d,l,D,I,w,P=K("./AdUnitConst.js");function T(){var e=f+"//",t="/adunit/dist",n=s?"/versions/"+s:"";if(c&&0<parseInt(c)&&"www.supersonicads.com"!==u){var i=u.split(".")[0],r="/stage/";("local"===i||1<parseInt(i))&&(r="/dev/"),e=e+u+("/users/staging/"+i)+t+n+r}else e=e+g+t+n+"/prod/";return e}function O(){var e=b.getCacheByType({cacheBase:"globals"});return e&&e.cache||[]}function F(e,t){return b.cacheGlobalAssets(e,t)}function x(){return"../"+S+"/globals/"}function L(){return b.getAppData().then(function(e){return(e=e||{})[P.adunitVersionKey]=s,b.setAppData(e)}).always(v.Utils.returnResolvedPromise)}function N(){return b.clearCacheByType({cacheBase:"globals"},[])}function U(e){if(p===n.environment.develop)return v.Utils.returnResolvedPromise(!0);var t=O();return t.length<=0||function(e,t){for(var n=0;n<e.length;n++){var i=e[n].split("."),r=i[i.length-1];if(P.adunitFilesMapping.hasOwnProperty(r)&&e[n]!==P.adunitFilesMapping[r])return t.hasOwnProperty("trackEvent")&&t.trackEvent(m.globalsInOldFormat),!0}return!1}(t,e)?v.Utils.returnResolvedPromise(!0):SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload&&SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload!==s?v.Utils.returnResolvedPromise(!0):b.getAppData().then(function(e){e=e||{};var t=v.Utils.versionCompare(s,e[P.adunitVersionKey]?e[P.adunitVersionKey]:"0");return v.Utils.returnResolvedPromise(0===t)}).then(function(e){var t=e&&function(){var e=O(),t=P.adunitFilesMapping;for(var n in t)if(-1===e.indexOf(t[n]))return!1;return!0}();return v.Utils.returnResolvedPromise(!t)}).fail(function(){return v.Utils.returnResolvedPromise(!0)})}function V(e){var a=T();return h.map(e,function(e){var t=/(\.\.\/)/g,n=e.match(t),i=n&&n.length||0;if(e=e.replace(t,""),0<i){var r=a.split("/");return r.splice(r.length-1-i,i),r.join("/")+e}return a+e})}function M(e){s=e.adunitVersion?e.adunitVersion:e.libs.adunitVersion}function E(e){var t,n,i=h.extend({},P.adunitFilesMapping,e);return n=e,(t=i).libs=function(e,t){for(var n in e)e.hasOwnProperty(n)&&"string"==typeof e[n]&&(e[n]=t+e[n]);return e}(n.libs,"../../"),i=t}function k(e){return w.prefetchGlobalAssetsToBrowser(e,T())}return{init:function(e,t,n,i,r,a,o,s,d,l){e,c=t.debug,u=t.domain,f=t.protocol,g=t.scdn,h=n,b=i,S=r,y=a,A=o,p=s,v=d,m=l,C=new(K("./AdUnitDataJsonFetcher.js"))(v,h,t,p,P),w=new(K("./AdUnitUtils.js"))(v,h,P),I=new(K("./AdUnitGraphicAssetsManager.js"))(v,w,b)},setProtocol:function(e){f=e,C.setProtocol(e)},getStaticGlobalsUrl:T,getGlobalAssetsJSON:function(){return C.getGlobalAssetsJSON()},prefetchGlobalAssetsToBrowser:k,getGlobalsCache:O,isAdunitVersionChanged:function(n){var e=O(),i=!0;return h.each(e,function(e,t){return-1<t.indexOf(n)&&(i=!1),i}),i},clearGlobalsCache:N,getLocalGlobalsFolder:x,cacheGlobalAssets:F,assetsToCache:V,updateAdUnitGlobals:function(t,e,n,i){if(t){if(l&&"rejected"!==l.state())return l.promise();l=h.Deferred()}else{if(d&&"rejected"!==d.state())return d.promise();d=h.Deferred()}return D&&"rejected"!==D.state()||(D=C.getGlobalAssetsJSON().then(function(e){var t;M(r=e),r=E(r),a=P.adunitFilesMapping,I.setAdunitAssetsPaths(r.graphicAssets,T()),o=r.libs,A.setLibsFilesPaths(o,T()),t=T()+P.adunitFilesMapping.html,y.setRemoteAdunitUrl(t),y.setLocalAdunitUrlFromCache(x(),O())}).then(function(){return t?A.manageDownloadLibsFileByFiletype(P.adunitLibsFileName,e):k({adunitLibsFile:o.adunitLibsFile})}).fail(function(e){t?l.reject(e):d.reject(e)})),D.then(function(){return t?(e=n,I.shouldUpdateAdunitAssets()?I.precacheAdunitGraphicAssets(e):v.Utils.returnResolvedPromise()).then(null,function(){l.reject(P.adunitGlobalsErrorMsgs.failedDownloaingGraphicAssets)}).then(U.bind(null,i)).then(function(e){return e?N().then(function(e,t){return F(V(e),t).then(function(){y.setLocalAdunitUrl(x()+y.getRemoteAdunitFileName())},function(){return y.setLocalAdunitUrl(y.getRemoteAdunitUrl()),P.adunitGlobalsErrorMsgs.failedToRetrieveAdunitUrl}).then(L)}.bind(null,a,n)).then(function(){l.resolve()},function(e){l.reject(e)}).always(function(){return l.promise()}):(l.resolve(),l.promise())}):k(a).then(I.prefetchAdunitGraphicAssets).then(function(){d.resolve()},function(e){d.reject(e)}).always(function(){return d.promise()});var e})},setAdunitVersion:M,getAdunitGlobalsHTML:function(){return P.adunitFilesMapping.html},updateGlobalAssetsStructure:E,getOWGlobalsHTML:function(){return P.owFilesMapping.html},getOWStaticGlobalsUrl:function(e){var t=f+"//",n="/ow-adunit/dist",i="/versions/"+e;if(c&&0<parseInt(c)&&"www.supersonicads.com"!==u){var r=u.split(".")[0],a="/stage/";("local"===r||1<parseInt(r))&&(a="/dev/"),t=t+u+"/users/staging/"+r+n+i+a}else t=t+g+n+i+"/prod/";return t}}}var i;e.exports=function(e,t){return t?new n(e):(i||(i=new n(e)),i)}},{"./AdUnitConst.js":94,"./AdUnitDataJsonFetcher.js":95,"./AdUnitGraphicAssetsManager.js":97,"./AdUnitUtils.js":98}],97:[function(e,t,n){t.exports=function(e,t,n){var r,a=n||{},o=t||{},s={},i={},d="graphicAssets";function l(){var e=a.getCacheByType({cacheBase:d});return e&&e.cache||[]}return{setAdunitAssetsPaths:function(e,t){s=e,r=t,i.sprite=s.sprite},shouldUpdateAdunitAssets:function(){if(0===l().length)return!0;for(var e in s)if(!a.isAssetInCache(o.extractFileNameFromPath(s[e]),d))return!0;return!1},precacheAdunitGraphicAssets:function(e){return(t=function(){for(var e=l(),t=[],n=function(e){for(var t in s)if(o.extractFileNameFromPath(s[t])===e)return!1;return!0},i=0;i<e.length;i++)n(e[i])&&t.push(e[i]);return t}(),a.deleteCachedListOfAssets(d,t)).then(a.cacheGraphicAssets.bind(null,function(){var e=[];for(var t in s){var n=o.extractFileNameFromPath(s[t]);if(!a.isAssetInCache(n,d)){var i=o.formatAssetsUrlForCache(s[t],r);e.push(i)}}return e}(),e));var t},prefetchAdunitGraphicAssets:function(){return o.prefetchGlobalAssetsToBrowser(i,r)}}}},{}],98:[function(e,t,n){t.exports=function(e,t,n){var p=t||{},v=n||{};return{formatAssetsUrlForCache:function(e,t){var n=t,i=function(e,t){var n=/(\.\.\/)/g,i=t.match(n),r=i&&i.length||0;if(t=t.replace(n,""),0<r){var a=e.split("/");return a.splice(a.length-1-r,r),a.join("/")+t}return e+t};return"string"==typeof e?i(n,e):p.map(e,function(e){i(n,e)})},prefetchGlobalAssetsToBrowser:function(e,t,n,i){var r,a,o=new p.Deferred,s=[],d=0,l=0,c=p.extend(!0,{},e);c.hasOwnProperty(v.adunitAssetsJsonKeys.html)&&delete c.html;var u=function(e){return-1<s.indexOf(e)};p.each(c,function(e,t){"string"==typeof t?u(t)||l++:delete c[e]}),0===l&&o.resolve();var f=function(e){var t;if(u(t=e)||s.push(t),++d===l){if("function"==typeof n&&n(s),r)return;clearTimeout(a),o.resolve()}},g=t;return p.each(c,function(e,i){if(!u(i)){var t=g+i;p.get(t,{},null,{dataType:"text"}).done(function(){f(i)}).fail(function(e,t,n){"parsererror"===t&&f(i)})}}),a=setTimeout(function(){d<l&&("function"==typeof i&&i(),o.reject("Failed to preload all global assets ("+d+" out of "+l+" succeeded)")),r=!0},15e3),o.promise()},extractFileVersionFromUrl:function(e){var t=e.split("/");return 0<t.length?t[t.length-2]:"0"},extractFileNameFromPath:function(e){return e.replace(/^.*[\\\/]/,"")}}}},{}],99:[function(A,e,t){function n(e){var a=e||{},t={dapi:"dapi",externalObfuscation:"externalObfuscation",adunitLibsFile:"adunitLibsFile",omid:"omid"},o={dapi:{filename:"dapi.js",type:t.dapi,cacheKeyName:"dapiVersion"},externalObfuscation:{filename:"obfuscateV2.html",type:t.externalObfuscation,cacheKeyName:"externalObfuscation"},adunitLibsFile:{filename:"adunitLibs.min.js",type:t.adunitLibsFile,cacheKeyName:"adunitLibsFile"},omid:{filename:"omid.js",type:t.omid,cacheKeyName:"omid"}},s="libs",d,l,c,i,r;function u(e,t,n){return!!o[e]&&(o[e].url=t,o[e].newVersion=n,!0)}function n(e,t,n){return u(e,t,n),a.returnResolvedPromise()}function f(e,t){return u(e,i.formatAssetsUrlForCache(t,r),i.extractFileVersionFromUrl(t))}function g(e){return d.isAssetInCache(e,s)?d.deleteCachedAsset(s,e):a.returnResolvedPromise()}function p(e,t){return 0===a.versionCompare(e,t)}function v(e,t){var n=o[e],i={};return!!n&&(i[n.cacheKeyName]=t,i)}function m(e,t,n){c=e,l=t,d=n||{},i=new(A("./AdUnitUtils.js"))(l,d)}function h(e,t){if(r=t,e)for(var n in e)f(n,e[n])}function b(e,n){var i=o[e]||{},r=function(){return g(i.filename).then(function(){return c.log("LibsManager | updateFileInCache | going to download",c.LogLevels.verbose),d.cacheLibsAsset(i.url).then(null,function(){return a.returnResolvedPromise()})}).fail(function(){return a.returnResolvedPromise()})};return d.getAppData().then(function(e){e=e||{},i.savedVersion=e&&e[i.cacheKeyName]?e[i.cacheKeyName]:"0";var t=!p(i.newVersion,i.savedVersion);return n||t?r().then(function(e){c.log("LibsManager | updateFileVersion | appData "+JSON.stringify(e),c.LogLevels.verbose);var t=l.extend(e,v(i.type,i.newVersion));return c.log("LibsManager | updateFileVersion | updatedData "+JSON.stringify(t),c.LogLevels.verbose),d.setAppData(t).fail(function(){return a.returnResolvedPromise()})}.bind(null,e)):d.isAssetInCache(i.filename,s)?(c.log("LibsManager | manageDownloadLibsFileByFiletype | file version is updated and file is already in cache",c.LogLevels.verbose),a.returnResolvedPromise()):(c.log("LibsManager | manageDownloadLibsFileByFiletype  | file version updated but file is not in cache - download it again",c.LogLevels.verbose),d.cacheLibsAsset(i.url))},r).then(function(){return c.log("LibsManager | manageDownloadLibsFileByFiletype  | success to download file "+i.url,c.LogLevels.verbose),a.returnResolvedPromise("success")},function(){return c.log("LibsManager | manageDownloadLibsFileByFiletype  | failed to download file "+i.url,c.LogLevels.verbose),S(i)})}function S(e){return e.filename===o.adunitLibsFile.filename?a.returnRejectedPromise("Failed to download file "+e.filename):a.returnResolvedPromise()}var y={init:m,setLibsFilesPaths:h,manageDownloadLibsFileByFiletype:b,updateFileVersionByFilePathForThirdPartyLibraries:n};return y}e.exports=n},{"./AdUnitUtils.js":98}],100:[function(e,t,n){function i(e,n){var t,i,a=function(){return t},r=function(e){t=e},o=function(){var e=null;return t&&(e=t.replace(/^.*[\\\/]/,"")),e},s=function(){return i},d=function(e){i=e},l=function(e,t,n,i){var r=e?s():a();return r+=t&&t.productType?"#?productType="+t.productType:"",r+=t&&t.demandSourceName?"&demandSourceName="+t.demandSourceName:"",r+=n&&n.shouldBuildAdUnitUrlForExternal?"&"+c(i):""};function c(e){var t={mode:"native",viewType:"external"};return e&&(t.deviceOs=e),n.serialize(t)}var u=function(n,e){jQuery.each(e,function(e,t){if("string"==typeof t&&t.match(/.*\.html/))return d(n+t.replace(/^.*[\\\/]/,"")),!1})},f={getAdunitUrl:l,getRemoteAdunitUrl:a,setRemoteAdunitUrl:r,getRemoteAdunitFileName:o,getLocalAdunitUrl:s,setLocalAdunitUrl:d,setLocalAdunitUrlFromCache:u};return f}t.exports=i},{}],101:[function(e,t,n){t.exports={NativeAPI:{adClicked:"adClicked",init:".initInterstitial",load:".loadInterstitial",show:".showInterstitial"},ControllerCallbacks:{cacheReady:".CacheReady",noMoreOffers:".NoMoreOffers",failedToShow:".failedToShow",failedToLoad:".failedToLoad",fallbackToNonPrecache:".fallbackToNonPrecache",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",resetStateManager:".resetStateManager"},AdUnitCallbacks:{adClicked:"SDKController.AdClicked",adVisible:"SDKController.AdVisible",engageEnd:"SDKController.engageEnd"},retriesLogic:{maxNumOfAttemptsToCallAPI:2,initAttemptsDelay:500,serverResponseTimeoutInMilis:1e4}}},{}],102:[function(e,t,n){t.exports=function(e,t,n,i){return{retriesLogic:e.retriesLogic,NativeAPI:e.NativeAPI,ControllerCallbacks:{reset:".reset",isVisible:".isVisible",isInitiated:".isInitiated",cacheReady:".CacheReady",failedToShow:".failedToShow",failedToLoad:".failedToLoad",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",noMoreOffers:".NoMoreOffers"},AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,ProductName:t.BN,Features:{allowMultiInitCalls:!0,shouldFetchNewFeedOnAdClose:!1,isSupportFetchFeedOnAdCloseLogic:!1,allowReloadDuringShow:!0,displayOnAdReady:!0,allowConsecutiveGatewayRequestsDuringLoad:!1,isExhaustInstanceAllowed:!1},gatewayDestinationMap:{prod:t.gatewayDestinationMap.BN.production},amountOfInventories:2,shouldResetOnEngageEnd:!0,shouldAvoidHandleFrameClose:!0,forcePreload:i,width:n?n.width:0,height:n?n.height:0,label:n?n.label:null,lwsSupported:i}}},{}],103:[function(s,e,t){e.exports=function(r,a){var o=s("../components/Constants");return{create:function(e){var t=s("./ProductAdapter"),n=s("./AdapterSharedConfig"),i=s("./Banner/BannerConfiguration")(n,o,e,a.isBannerAndLoadWhileShowSupported(o.BN));return new t(r,a,i,o)}}}},{"../components/Constants":13,"./AdapterSharedConfig":101,"./Banner/BannerConfiguration":102,"./ProductAdapter":132}],104:[function(re,e,t){function n(y,A){var C="NativeCallback",h="globals",b="graphicAssets",n=!1,o=re("./Cache/CacheConstants"),D={},I={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[],evaluatedCache:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]},graphicAssets:{cache:[],cacheQueue:[]}},w={Interstitial:{numOfBannersToCache:1}},P,t=function(e){return 0!==I[e.cacheBase].cache.length?(I[e.cacheBase].currentAd+1)%I[e.cacheBase].cache.length:0},i=function(i){i=i||{},jQuery.each(I,function(e,t){var n=e;I[n].cache&&0!==I[n].cache.length&&y.Utils.isDefined(i)&&i.hasOwnProperty(n)&&I[n].cache.sort(function(e,t){return i[n].indexOf(e.id)<i[n].indexOf(t.id)?-1:1})})},T=function(e){var t,n=e.length;for(t=0;t<n;t++)y.Utils.isDefined(e[t])&&e[t]&&y.PubSub.unsubscribe(e[t])},r=function(e){A.log("cache: "+JSON.stringify(I[e].cache)+" currentAd: "+I[e].currentAd,A.LogLevels.info),A.log("queue: "+JSON.stringify(I[e].cacheQueue),A.LogLevels.info)},O=function(e,t){var n,i=null,r=I[e.cacheBase].cacheQueue.length;for(n=0;n<r;n++)if(I[e.cacheBase].cacheQueue[n].cachingStatus===t){i=I[e.cacheBase].cacheQueue[n];break}return i},F=function(e,t){return e.cacheBase+"/"+t},x=function(e,t){var n=jQuery.map(I[e.cacheBase].evaluatedCache,function(e){return A.AdUtils.getAdId(e)});if(0<n.length){var i=n.indexOf(t.toString());0<=i&&(A.log("Removing ad from evaluatedCache! "+t,A.LogLevels.verbose),I[e.cacheBase].evaluatedCache.splice(i,1))}},L=function(e,t){var n=A.AdUtils.getAdId(t);if(t&&n){var i,r=I[e.cacheBase].cacheQueue.length;for(i=0;i<r;i++)I[e.cacheBase].cacheQueue[i].id==n&&(I[e.cacheBase].cacheQueue[i]=t)}},N=function(n,e){var i=-1;jQuery.each(I[e.cacheBase].cache,function(e,t){return!(y.Utils.isDefined(t.inventoryIndex)&&t.inventoryIndex>n.inventoryIndex||!y.Utils.isDefined(t.inventoryIndex))||(i=e,!1)}),-1===i?I[e.cacheBase].cache.push(n):I[e.cacheBase].cache.splice(i,0,n);var t={};t.cacheBase=e.cacheBase,t.id=n.id,t.inventoryId=n.inventoryId,t.demandSourceName=n.demandSourceName,y.PubSub.publish("Cache.campaignSaved",[t])},U=function(n){jQuery.each(I[n.cacheBase].cacheQueue,function(e,t){if(t.cachingStatus===P.cachingStatus.none&&0===jQuery.grep(I[n.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(t)}).length&&0===jQuery.grep(I[n.cacheBase].evaluatedCache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(t)}).length)return I[n.cacheBase].evaluatedCache.push(t),!1})},a=function(e,t){var n=jQuery.map(I[e.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)});if(0<n.length){var i=n.indexOf(t.toString());0<=i&&(A.log("Removing ad from cache array! "+t,A.LogLevels.verbose),I[e.cacheBase].cache.splice(i,1))}},s=function(i,r){return A.getGlobalAppData().then(function(e){e.cachePriorityArray=e.cachePriorityArray||{};var t=e.cachePriorityArray[i.cacheBase];if(t){var n=t.indexOf(r.toString());0<=n&&(A.log("Removing ad from cache array! "+r,A.LogLevels.verbose),t.splice(n,1),e.cachePriorityArray=t)}return A.setGlobalAppData(e)})};function d(s,c){I[s.cacheBase].evaluatedCache.length;var t,e,n,u,i=I[s.cacheBase].cacheQueue.length,r=(w[s.cacheBase].numOfBannersToCache,null),a=null,f=null,g=null,o=null,p=[],v=[],d=[],m=0,h={};for(n=jQuery.Deferred(),e=0;e<i;e++)I[s.cacheBase].cacheQueue[e].cachingStatus!==P.cachingStatus.pending&&I[s.cacheBase].cacheQueue[e].cachingStatus!==P.cachingStatus.queued||0;var b=function(){0<I[s.cacheBase].evaluatedCache.length?(A.log("line[182]: evaluatedCache is: "+JSON.stringify(I[s.cacheBase].evaluatedCache),A.LogLevels.verbose),(t=O(s,P.cachingStatus.none))?(t.cachingStatus=P.cachingStatus.pending,x(s,A.AdUtils.getAdId(t)),t.numOfAssetsCached=0,D[s.cacheBase][t.id]=[],d.push(A.AdUtils.getAdId(t)),t.preProcessing().then(function(e){if(!y.Utils.isDefined(e))return y.Utils.returnResolvedPromise();t=$(e),L(s,t)},function(){var e={};e.cacheBase=s.cacheBase,e.id=A.AdUtils.getAdId(t),e.inventoryId=t.inventoryId,e.demandSourceName=t.demandSourceName,y.PubSub.publish("Cache.preProcessingFailed",[e]),p.push(e.id),n.reject(I[s.cacheBase].cache,p)}).then(function(){var e={};e.cacheBase=s.cacheBase,e.id=t.id,e.demandSourceName=t.demandSourceName,y.PubSub.publish("Cache.campaignDownloadStarted",[e]),h={},0===t.assets.length?l(s,A.AdUtils.getAdId(t)):(A.log("campaign "+t.id+" download started",A.LogLevels.info),A.cacheAdUnitAssets(F(s,t.id),t))}),0):(T([r,a,o,f,g]),0===p.length?n.resolve(I[s.cacheBase].cache):n.reject(I[s.cacheBase].cache,p,v))):(O(s,P.cachingStatus.pending)&&A.log("cache is full but we're waiting for a campaign to finish downloading (probably the last)",A.LogLevels.verbose),T([r,a,o,f,g]),0===p.length?n.resolve(I[s.cacheBase].cache):n.reject(I[s.cacheBase].cache,p,v))},S=function(e){T([f,g]),e&&(0,b())},l=function(e,t,n,i){var r,a,o=i&&i.hasOwnProperty("file")?i.file:null,s=!(!i||!i.hasOwnProperty("status"))&&i.status,d=[];if((r=E(e,t))&&te(s,h,o,r.assets,c)){if(c.cacheBase=e.cacheBase,h[o]={isSuccessfullyCached:s},!ne(n,o,h,r.assets,m,c))return void m++;m=0}if(D[e.cacheBase][t].push(i),r&&r.id&&D[e.cacheBase][r.id].length===r.assets.length)if(A.log("campaign "+r.id+" download finished!",A.LogLevels.info),u=k(D[e.cacheBase][r.id],function(e){return e.status}),a=K(D[e.cacheBase][r.id],r,function(e){return e.status}),0===r.assets.length&&(u=!0),delete D[e.cacheBase][r.id],u){if(r.cachingStatus=P.cachingStatus.queued,0<=I[e.cacheBase].evaluatedCache.length){M(e,r.id,!1),r.numOfAssetsCached=r.assets.length,N(r,e),d=I[e.cacheBase].cache.map(function(e){return A.AdUtils.getAdId(e)}),e.inventoryId=r.inventoryId,e.demandSourceName=r.demandSourceName;var l=jQuery.extend({},e,{inventoryId:r.inventoryId,demandSourceName:r.demandSourceName});y.PubSub.publish("Cache.cacheUpdated",[l])}else A.log("Cache full, could not enter new ad",A.LogLevels.error);0<d.length?(A.log("mappedAds after 'handleCachedAd/pushNewCachedAd' "+d,A.LogLevels.verbose),A.setCachePriorityArrayKey(e,d).always(function(){b()})):b()}else M(e,t,!1),U(e),f=y.PubSub.subscribe(C+".deleteFolderFailed",function(e){A.log("in delete failure from cache next",A.LogLevels.verbose),A.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&(A.log("deleting folder failed: "+JSON.stringify(e),A.LogLevels.error),y.Utils.isDefined(e.errCode)&&1==e.errCode?S(!0):S(!1))}),g=y.PubSub.subscribe(C+".deleteFolderSuccess",function(e){A.log("in delete success from cache next",A.LogLevels.verbose),A.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&(A.log("deleting folder success: "+JSON.stringify(e),A.LogLevels.info),S(!0))}),p.push(r.id),a&&v.push({id:r.id,failedAssetsUrlsArray:a.failedAssetsUrlsArray}),A.deleteFolder(n)};return r=y.PubSub.subscribe(C+".assetCached",function(e,t,n){if(A.checkRequiredCallbackParams(["path","file"],e,"assetCached",n).didSucceed){var i,r=V(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!0};-1!==jQuery.inArray(r.id,d)?y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(A.log("asset cached success: "+r.id+"/"+e.file,A.LogLevels.verbose),i={cacheBase:r.type},E(i,r.id).numOfAssetsCached++,l(i,r.id,a,o)):A.log("Exiting asset cached. folder:"+r.id+" responses array:"+JSON.stringify(D),A.LogLevels.error):A.log("ad is not recognised in this scope: "+r.id+" adForCaching:"+d,A.LogLevels.info)}}),a=y.PubSub.subscribe(C+".assetCachedFailed",function(e,t,n){if(A.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",n).didSucceed){var i,r=V(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!1};-1!==jQuery.inArray(r.id,d)&&(y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(A.log("asset cached failed: "+r.id+"/"+e.file+" with error: "+e.errMsg,A.LogLevels.error),i={cacheBase:r.type},l(i,r.id,a,o)):A.log("Exiting asset cached failed. folder:"+r.id+" responses array:"+JSON.stringify(D),A.LogLevels.error))}}),o=y.PubSub.subscribe(C+".preCacheFileFail",function(e,t,n){if(A.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",n).didSucceed){var i,r=V(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!1};-1!==jQuery.inArray(r.id,d)&&(y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(A.log("pre cache file fail: "+e.file+" with error: "+e.errMsg,A.LogLevels.error),i={cacheBase:r.type},l(i,r.id,a,o)):A.log("Exiting preCache file fail. folder:"+r.id+" responses array:"+JSON.stringify(D),A.LogLevels.error))}}),b(),n.promise()}var l=function(e){return parseInt(e)},c=function(e){var t;try{t=parseInt(e)}catch(e){t=0}return t},u=function(e,t){var n,i;for(n in t)if(t.hasOwnProperty(n)){if("userUniqueId"===n||"applicationUserId"===n||"applicationKey"===n)continue;if("files"===n){e.cache=t[n];continue}if(l(n)){e.cache.push({id:n,numOfAssetsCached:y.Utils.isDefined(t[n].files)?t[n].files.length:0,lastUpdateTime:y.Utils.isDefined(t[n].lastUpdateTime)?c(t[n].lastUpdateTime):0,assets:y.Utils.isDefined(t[n].files)?t[n].files:[]});continue}if("lastUpdateTime"===n)return;i=A.isRootFolder(n)?e:(P.initCacheBase(n),e[n]),u(i,t[n])}},f=function(e){y.Utils.isDefined(e)&&e&&e!=={}?u(I,e):I={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},RewardedVideo_Premium:{cache:[],currentAd:0,cacheQueue:[]},RewardedVideo_Direct:{cache:[],currentAd:0,cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]}}},V=function(e){var t=decodeURIComponent(e).split("/");return{type:t[0],id:y.Utils.isDefined(t[1])?t[1]:null}},g=function(e){var t=e.split("#");return 1<t.length?t[t.length-1]:(t=e.split("/"))[t.length-1]},S=function(e,t){var n,i=-1,r=g(t),a=e.length;for(n=0;n<a;n++)if(g(e[n])===r){i=n;break}return i},M=function(e,t,n){var i,r=I[e.cacheBase].cacheQueue,a=[],o=!1;for(i=0;i<I[e.cacheBase].cacheQueue.length;i++)r[i].id!=t?a.push(r[i]):(o&&!n&&a.push(r[i]),o=!0);I[e.cacheBase].cacheQueue=a},p=function(i,e){var t,n,r,a,o=0,s=I[i.cacheBase].cache.length,d=[],l=[],c=jQuery.Deferred(),u=function(e,t){-1!==jQuery.inArray(decodeURIComponent(e.path),d)&&(e.success=t,l.push(e),l.length>=d.length&&(T([r,a]),k(l,function(e){return y.Utils.isDefined(e.success)&&e.success})?c.resolve():c.reject()))};if(a=y.PubSub.subscribe(C+".deleteFolderFailed",function(e){A.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&-1!==e.path.indexOf(i.cacheBase)&&(A.log("deleting folder failed: "+JSON.stringify(e),A.LogLevels.error),y.Utils.isDefined(e.errCode)&&1==e.errCode?u(e,!0):u(e,!1))}),r=y.PubSub.subscribe(C+".deleteFolderSuccess",function(e){if(A.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&-1!==e.path.indexOf(i.cacheBase)){A.log("deleting folder success: "+JSON.stringify(e),A.LogLevels.info),u(e,!0);var t=V(e.path);if(null!==t.id){var n={};n.cacheBase=t.type,n.id=t.id,n.inventoryId=t.inventoryId,y.PubSub.publish("Cache.campaignDeleted",[n])}}}),i.cacheBase===h)I[i.cacheBase].cache=[],I[i.cacheBase].cacheQueue=[],d.push(h);else{for(o=0;o<s;o++)y.Utils.isDefined(I[i.cacheBase].cache[0].id)||A.log("something went wrong. len="+s+" cache size= "+I[i.cacheBase].cache.length+" first element="+JSON.stringify(I[i.cacheBase].cache[0]),1),t=I[i.cacheBase].cache[0].id.toString(),y.Utils.isDefined(t)&&-1===jQuery.inArray(t,e)&&(n=i.cacheBase+"/"+t,-1===jQuery.inArray(n,d)&&d.push(n)),I[i.cacheBase].cache.shift();for(s=I[i.cacheBase].cacheQueue.length,o=0;o<s;o++)t=I[i.cacheBase].cacheQueue[0].id,y.Utils.isDefined(t)&&I[i.cacheBase].cacheQueue[0].cachingStatus!==P.cachingStatus.none&&(n=i.cacheBase+"/"+t,-1===jQuery.inArray(n,d)&&d.push(n)),I[i.cacheBase].cacheQueue.shift()}if(0===d.length)T([r,a]),c.resolve();else for(A.log("Removing irrelevant campaigns: "+JSON.stringify(d)),o=0;o<d.length;o++)A.deleteFolder(d[o]);return c.promise()},v=function(e,t){var n,i=null,r=I[e.cacheBase].cache,a=I[e.cacheBase].cache.length;for(n=0;n<a;n++)if(r[n].id==t){i=r[n];break}return i},E=function(e,t){var n,i=null,r=I[e.cacheBase].cacheQueue,a=I[e.cacheBase].cacheQueue.length;for(n=0;n<a;n++)if(r[n].id==t){i=r[n];break}return i},k=function(e,t){var n,i=e.length,r=!0;for(n=0;n<i;n++)r=r&&t(e[n]);return r};function K(e,t,n){var i,r=e.length,a={failedAssetsUrlsArray:[]},o=function(e,t){if(!e||!e.assets)return null;var n=e.assets;t=t.split("?")[0];for(var i=0;i<n.length;i++){if(t&&-1!==n[i].indexOf(t))return n[i].split("?")[0]}return null};for(i=0;i<r;i++)if(!n(e[i])){var s=o(t,e[i].file);s&&a.failedAssetsUrlsArray.push(s)}return a}var m=function(){y.PubSub.subscribe(C+".printCache",function(e){y.Utils.isDefined(e.type)&&r(e.type)})},e=function(n,i,e){var r=0,a=!1;return jQuery.each(I[e.cacheBase].cache,function(e,t){if(0<jQuery.grep(n,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(t)}).length&&i<=++r)return!(a=!0)}),a},B=function(t,e,n,i){var r,a=t.slice(0,e),o=[];for(I[i.cacheBase].evaluatedCache=[],r=0;r<a.length;r++)0===jQuery.grep(I[i.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(a[r])&&R(e,a[r])}).length&&I[i.cacheBase].evaluatedCache.push(a[r]);for(r=0;r<a.length;r++)0===jQuery.grep(I[i.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(a[r])&&!R(e,a[r])}).length&&o.push(a[r]);for(r=e;r<t.length;r++)0<jQuery.grep(I[i.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(t[r])&&R(e,t[r])}).length&&o.push(t[r]);var s,d=t.length;for(r=0;r<I[i.cacheBase].cache.length;r++)0===jQuery.grep(t,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(I[i.cacheBase].cache[r])}).length&&(I[i.cacheBase].cache[r].inventoryIndex=++d,o.push(((s=I[i.cacheBase].cache[r]).adId=s.id,s.staticContent=s.assets,s)));return I[i.cacheBase].mergedAds=o.slice(0,n),I[i.cacheBase].mergedAds},R=function(e,t){if(!e||!t)return A.log("line[750]: entering isCachedAdStillUpdated with no ad",A.LogLevels.verbose),!1;var n=X(e.assets),i=X(t.staticContent);return A.log("cachedAdNumOfUniqueAssets: "+n+", newAdNumOfUniqueAssets:"+i,A.LogLevels.verbose),n===i&&(j(t)||e.lastUpdateTime==t.lastUpdateTime)},j=function(e){return e&&"0"!==e.creativeId},W=function(e,t){return I[t]&&-1<I[t].cache.indexOf(e)};function _(e){if(!e)return null;var t=I[o.adsAssetsCacheDir]&&I[o.adsAssetsCacheDir].cache;if(!t)return null;for(var n=0;n<t.length;n++){var i=t[n];if(i&&i.id===e)return i}return null}function G(e){return e&&e.assets?e.assets.length:0}function H(){var e=I[o.adsAssetsCacheDir]&&I[o.adsAssetsCacheDir].cache;if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n].id);return t}function q(e){var t=_(A.AdUtils.getAdId(e));return!(!t||!e.adAssets||G(t)!==e.adAssets.length)}function Q(e,t){var n=_(t);return!(!e||!n)&&!(!n.assets||-1===n.assets.indexOf(e))}function J(e,t){if(e&&t&&Array.isArray(t)&&0!==t.length){var n=A.AdUtils.getAdId(e);I[o.adsAssetsCacheDir]||(I[o.adsAssetsCacheDir]={}),I[o.adsAssetsCacheDir].cache||(I[o.adsAssetsCacheDir].cache=[]);for(var i=I[o.adsAssetsCacheDir].cache,r=0;r<i.length;r++){i[r].id===n&&i.splice(r,1)}var a={id:n,assets:t,lastUpdateTime:e.lastUpdateTime?e.lastUpdateTime:0,inventoryIndex:y.Utils.isDefined(e.inventoryIndex)?e.inventoryIndex:-1};i.push(a)}}var z=function(e,t,n){var i=v(e,t);i&&(i.inventoryIndex=n)},X=function(e){var n,i=[];return e?(jQuery.each(e,function(e,t){n=g(t),-1===S(i,n)&&i.push(n)}),i.length):(A.log("cannot extract unique assets count",A.LogLevels.error),-1)},$=function(e){var t={id:A.AdUtils.getAdId(e),demandSourceName:e.demandSourceName,assets:e.staticContent||[],lastUpdateTime:y.Utils.isDefined(e.lastUpdateTime)?e.lastUpdateTime:0,numOfAssetsCached:0,cachingStatus:P.cachingStatus.none,preProcessing:e.preProcessing||y.Utils.returnResolvedPromise};return y.Utils.isDefined(e.credits)&&(t.credits=e.credits),y.Utils.isDefined(e.inventoryIndex)&&(t.inventoryIndex=e.inventoryIndex),t},Y=function(e,t){var n={};n.failedCachedFile=e,n.listOfFilesUrls=t,e=e.split("?")[0];for(var i=0;i<t.length;i++)if(-1!==t[i].indexOf(e))return t[i];return!1},Z=function(e,t,n,i,r,a,o){return{cacheBase:e,productType:t,demandSourceName:n,file:i,currentRetryAttempt:r,totalRetryAttempts:a,assetType:o}},ee=function(e){return e&&e.hasOwnProperty("retryAttempts")&&e.hasOwnProperty("retryInterval")},te=function(e,t,n,i,r){return n&&i&&0<i.length&&(!e||t[n])&&ee(r)},ne=function(e,t,n,i,r,a){var o,s=!0,d=Y(t,i),l=a.retryAttempts,c=a.retryInterval,u={cacheBase:e,failedCachedFile:t,listOfFilesUrls:i};if(d)return n[t].isSuccessfullyCached?0<r&&n[t].isSuccessfullyCached&&(o=Z(e,a.productType,a.demandSourceName,d,r,l,a.assetType),y.PubSub.publish("Cache.assetRetrySuccess",[o])):r<l?(s=!1,setTimeout(function(){A.cacheAsset(e,d)},1e3*c)):(o=Z(e,a.productType,a.demandSourceName,d,r,l,a.assetType),y.PubSub.publish("Cache.assetRetryFailed",[o])),s;y.PubSub.publish("Cache.executeRetryFileUrlEmpty",[u])},ie={init:function(e,t){return P=this,n||(f(e),m(),n=!0),i(t),n},initCacheBase:function(e){I[e]||(I[e]={cache:[],currentAd:0,cacheQueue:[]}),D[e]||(D[e]={})},setAdInventoryIndex:z,cacheNext:function(e,t){return A.log("line[707]: recalling cache next",A.LogLevels.verbose),U(e),d(e,t)},incrementNextCampaign:function(e){I[e.cacheBase].currentAd=t(e)},isNextAvailable:function(e,t){return P.getCurrentAd(e,t)},setSettings:function(e,t){w[e.cacheBase]=t},getCacheSizeByType:function(e){var t=I[e.cacheBase];return t&&t.hasOwnProperty("cache")?t.cache.length:0},cacheGlobalAssets:function(e,t){return P.cacheFilesByFolder("globals",e,t)},cacheGraphicAssets:function(e,t){return P.cacheFilesByFolder("graphicAssets",e,t)},cacheFilesByFolder:function(n,i,r){var e,a,o,s,d,l=i.length,c=[],u=0,f={};if(!I.hasOwnProperty(n))return y.Utils.returnResolvedPromise();a=jQuery.Deferred();var g=I[n].cache,p=I[n].cacheQueue,v=function(e,t){if(te(t,f,e,i,r)){if(f[e]={isSuccessfullyCached:t},r.cacheBase=n,!ne(n,e,f,i,u,r))return void u++;u=0}c.push({file:e,status:t}),m(e),c.length>=l&&(T([o,s,d]),k(c,function(e){return e.status})?(g=jQuery.map(i,function(e){return e.replace(/^.*[\\\/]/,"")}),a.resolve(g)):a.reject())},m=function(e){var t=p.indexOf(e);-1<t&&p.splice(t,1)};for(o=y.PubSub.subscribe(C+".assetCached",function(e,t,n){A.checkRequiredCallbackParams(["path","file"],e,"assetCached",n).didSucceed&&(e.path!==h&&e.path!==b||(A.log("asset cached success: "+e.file,A.LogLevels.verbose),v(e.file,!0)))}),s=y.PubSub.subscribe(C+".assetCachedFailed",function(e,t,n){A.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",n).didSucceed&&(e.path!==h&&e.path!==b||(A.log("asset cached failed: "+e.file+" with error: "+e.errMsg,A.LogLevels.error),v(e.file,!1)))}),d=y.PubSub.subscribe(C+".preCacheFileFailed",function(e,t,n){A.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",n).didSucceed&&(e.path!==h&&e.path!==b||(A.log("failed to request to save file:"+e.file+" with error "+e.errMsg,A.LogLevels.error),v(e.file,!1)))}),e=0;e<l;e++)-1===S(g,i[e])?(-1===S(p,i[e])?p.push(i[e]):m(i[e]),A.cacheAsset(n,i[e])):-1!==S(g,i[e])&&v(i[e],!0);return 0===l&&T([o,s,d]),a.promise()},cacheLibsAsset:function(e){var t=jQuery.Deferred(),n=e.replace(/^.*[\\\/]/,"");return I.libs.cacheQueue.push(n),A.cacheAsset("libs",e).then(function(){!function(e){I.libs.cache.push(n);var t=I.libs.cacheQueue.indexOf(e);-1!==e&&I.libs.cacheQueue.splice(t,1)}(e),t.resolve(I.libs.cache)},function(){t.reject("Libs asset cache failed: "+e)}),t.promise()},cacheAds:function(e,t,n,i){var r,a=n.length;for(r=0;r<a;r++){var o=$(n[r]);I[e.cacheBase].cacheQueue.push(o)}return d(e,i)},cacheSingleAd:function(e,t,n){I[e.cacheBase].cacheQueue.splice(0,0,$(t)),P.cacheNext(e,n)},clearCacheByType:function(e,t){var n,i,r=t.length,a=[],o=null,s=[],d=jQuery.Deferred();if(0===I[e.cacheBase].cache.length&&0===I[e.cacheBase].cacheQueue.length)return d.resolve(I[e.cacheBase].cache),d.promise();for(n=0;n<r;n++)i=A.AdUtils.getAdId(t[n]),o=v(e,i),R(o,t[n])&&(s.push(i),y.Utils.isDefined(t[n].credits)&&!y.Utils.isDefined(o.credits)&&(o.credits=t[n].credits),a.push(o));return jQuery.when(p(e,s)).then(function(){I[e.cacheBase].cache=a,d.resolve(I[e.cacheBase].cache)},function(){A.log("error in clear cache by type",A.LogLevels.error),d.reject()}),d.promise()},getCurrentAd:function(t,e){var i=null;return t&&t.cacheBase&&e?(jQuery.each(e,function(e,n){return jQuery.each(I[t.cacheBase].cache,function(e,t){return!(i=A.AdUtils.getAdId(t)===A.AdUtils.getAdId(n)?t:i)}),!i}),i):null},getNextAvailableAd:function(){return{}},getCacheByType:function(e){return I[e.cacheBase]},getRootCacheStructure:function(){return I},isAdInCache:function(e,t){var n,i=!1,r=I[e.cacheBase],a=r&&r.cache?r.cache.length:0;for(n=0;n<a;n++)if(r.cache[n].id===t){i=!0;break}return i},getAdStatusInQueue:function(e,t){var n=E(e,t);return n?n.cachingStatus:null},setAppData:function(e){return A.setGlobalAppData(e)},getAppData:function(){return A.getGlobalAppData()},deleteCachedAsset:function(e,t){return A.deleteAsset(e,t)},deleteCachedListOfAssets:function(e,t){var n,i=new jQuery.Deferred,r=[],a=0;if(0===t.length)return i.resolve(0),i.promise();for(n=0;n<t.length;n++)r.push(A.deleteAsset(e,t[n]));return jQuery.when.apply(null,r).always(function(){var e=arguments;for(n in e)e[n]&&a++;i.resolve(a)}),i.promise()},deleteCachedCampaign:function(e,t){var n=e.cacheBase+"/"+t;return A.deleteFolder(n),a(e,t),s(e,t)},isAssetInCache:W,isAssetInAdsCacheFolder:Q,getCachedAdFolder:_,getAmountOfAssetsInAdFolder:G,isAdExistInCacheAndContainsAllAssets:q,setAdInAdsFolder:J,mergeCampaigns:B,areCampaignsAvailable:e,getFileIndexInCache:S,removeAdFromCacheArray:a,cachingStatus:{none:0,pending:1,queued:2}};return ie}e.exports=n},{"./Cache/CacheConstants":110}],105:[function(e,t,n){t.exports=function(i,c,u,f){function g(e,t,n){i.PubSub.publish("AdsAssetsClearanceService.cacheReachedMaximumCapacity",[{demandSourceName:e.demandSourceName,productType:e.productType,maxAdsToSaveInCache:t,amountOfAdsCached:n}])}return{enactClearanceLogic:function(e,t,n,i,r){var a,o=function(e){for(var t=[],n=[],i=e.length,r=0;r<i;r++)c.isAdExistInCacheAndContainsAllAssets(e[r])?n.push(e[r]):t.push(e[r]);return{adsFromFeedThatAreNotInCache:t,adsThatWereAlreadyInTheCache:n}}(e),s=o.adsFromFeedThatAreNotInCache,d=c.getCacheSizeByType(n);if(t=function(e,t,n){for(var i=e,r=f.getAdIdsOfAds(n),a=0;a<i&&a<t.length;a++){var o=t[a].isCacheable,s=f.getAdId(t[a]),d=-1!==r.indexOf(s);o&&!d||e--}return e}(t,e,o.adsThatWereAlreadyInTheCache),a=s,t<=0||0===a.length||d+t<=i)return{adsToCache:s,adsToRemoveFromCache:[],adsThatWereAlreadyCached:o.adsThatWereAlreadyInTheCache};var l=function(e){for(var t=c.getCacheByType(e).cache,n=[],i=t.length,r=0;r<i;r++){var a=t[r];0===u.getReferenceCountOfAd(a.id)&&n.push(a)}return n}(n);return 0===l.length?(g(r,i,d),{adsToCache:s,adsToRemoveFromCache:[],adsThatWereAlreadyCached:o.adsThatWereAlreadyInTheCache}):{adsToCache:s,adsToRemoveFromCache:function(e,t,n,i,r){var a=e+n-i,o=t.length;if(o<a)return g(r,i,e),t;if(o===a)return t;if(a<o){var s=t.splice(0,a);return s}}(d,l,t,i,r),adsThatWereAlreadyCached:o.adsThatWereAlreadyInTheCache}}}}},{}],106:[function(r,e,t){e.exports=function(v,m,h){var o,b,s,S=r("./CacheConstants"),y=new(r("./CacheUtils"))(v),d=new(r("./AdsReferencesManager")),u={},A={},i={};function f(e,t,n,i){var r=m.AdUtils.getAdId(t);if(!y.isAssetValid(e))return v.Utils.returnRejectedPromise(S.errors.cacheAssetInvalidParams);var a=e[S.assetKeys.URL],o=y.extractFileNameFromURL(a);if(!o)return I("urlNotMatched",{demandSourceName:n.demandSourceName,productType:n.productType,asset:e,ad:t}),v.Utils.returnRejectedPromise(S.errors.cacheAssetInvalidParams);if(b.isAssetInAdsCacheFolder(o,r))return e[S.assetKeys.file]=o,v.Utils.returnResolvedPromise(e);var s,d,l,c,u,f,g=new jQuery.Deferred,p=y.buildAdFolderPath(r);return s=e,d=p,l=g,c=[],u=v.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",function(e){e[S.assetKeys.path]===d&&e[S.assetKeys.file]===y.extractFileNameFromURL(s[S.assetKeys.URL])&&(v.PubSub.clearHandlers(c),s[S.assetKeys.path]=y.buildAdAssetsPath(e[S.assetKeys.path],e[S.assetKeys.file]),s[S.assetKeys.file]=e[S.assetKeys.file],l.resolve(s))}),f=v.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedFailure",function(e){e[S.assetKeys.file]===y.extractFileNameFromURL(s[S.assetKeys.URL])&&(v.PubSub.clearHandlers(c),l.reject("failed caching file "+e[S.assetKeys.file]))}),c.push(u,f),h.saveFileWithRetry(a,p,n,i),g.promise()}function g(n,i,e){var t,r,a=m.AdUtils.getAdId(n);if(!a)return v.Utils.returnRejectedPromise("Failed to cache ad "+a||m.AdUtils.getBannerId(n));if(!n.isCacheable)return v.Utils.returnResolvedPromise();if(b.isAdExistInCacheAndContainsAllAssets(n))return v.Utils.returnResolvedPromise();if(t=a,u.hasOwnProperty(t))return r=a,u.hasOwnProperty(r)?u[r]:v.Utils.returnResolvedPromise();var o,s,d=new jQuery.Deferred;o=a,s=d.promise(),u.hasOwnProperty(o)||(u[o]=s);for(var l=[],c=0;c<n.adAssets.length;c++)l.push(f(n.adAssets[c],n,i,e));return jQuery.when.apply(null,l).then(function(){var e=v.Utils.convertArrayLikeObjectToArray(arguments);!function(e,t){if(t&&Array.isArray(t)){for(var n=[],i=0;i<t.length;i++){var r=t[i];r&&r.hasOwnProperty(S.assetKeys.file)&&n.push(r[S.assetKeys.file])}b.setAdInAdsFolder(e,n)}}(n,e),p(a),I("saveAdInCacheSuccess",{demandSourceName:i.demandSourceName,productType:i.productType,ad:n}),d.resolve()},function(e){D(m.AdUtils.getAdId(n),i.instanceUniqueId),I("saveAdInCacheFailure",{demandSourceName:i.demandSourceName,productType:i.productType,ad:n});var t=y.buildAdFolderPath(a);!function(t,n,i,r,a){var o=[],s=m.AdUtils.getAdId(t),e=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",l),d=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",l);function l(e){e.path===n&&(v.PubSub.clearHandlers(o),I("deleteAdFromCacheSuccess",{demandSourceName:a.demandSourceName,productType:a.productType,ad:t}),p(s),r.reject("ad "+s+" failed to cached with reason: "+i))}o.push(e,d)}(n,t,e,d,i),h.deleteFolder(t)}),d.promise()}function p(e){u.hasOwnProperty(e)&&delete u[e]}function C(e){A.hasOwnProperty(e)&&delete A[e]}function D(e,t){d.unsetReferenceForAd(e,t)}function l(e,t){var n,i,r,a=m.AdUtils.getAdId(e);return n=a,null===b.getCachedAdFolder(n)?v.Utils.returnResolvedPromise():(r=a,A.hasOwnProperty(r)?(i=a,A.hasOwnProperty(i)?A[i]:v.Utils.returnResolvedPromise()):function(e,t){var n,i,r=m.AdUtils.getAdId(e),a=new jQuery.Deferred;n=r,i=a.promise(),A.hasOwnProperty(n)||(A[n]=i);var o,s,d,l,c,u,f,g,p=y.buildAdFolderPath(r);return o=e,s=p,d=a,l=t,c=[],u=m.AdUtils.getAdId(o),f=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",function(e){e.path===s&&(v.PubSub.clearHandlers(c),C(u),b.removeAdFromCacheArray(y.getAdLevelCacheConfiguration(),u),I("deleteAdFromCacheSuccess",{demandSourceName:l.demandSourceName,productType:l.productType,ad:o}),d.resolve())}),g=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",function(e){e.path===s&&(v.PubSub.clearHandlers(c),C(u),I("deleteAdFromCacheFailure",{demandSourceName:l.demandSourceName,productType:l.productType,ad:o}),d.reject(e.errorMsg))}),c.push(f,g),h.deleteFolder(p),a.promise()}(e,t))}function I(e,t){v.PubSub.publish("AdsAssetsManager."+e,[t])}return{init:function(e,t){var n;b=e,n=i=t||{},0!==Object.keys(n).length&&m.getSegmentationAllocator().addAdLevelCacheSegment(n.adLevelCacheGroup),s=i[S.maxAdsToSaveInCache]||S.defaultMaxAdsToSaveInCache,o=new(r("./AdsAssetsClearanceService"))(v,b,d,m.AdUtils)},setAdAssetsForAds:function(e){if(e)for(var t=0;t<e.length;t++)e[t].adAssets=y.extractAssetsFromAd(e[t])},cacheAssetsOfAd:g,cacheAdsWithClearanceLogic:function(e,t,n,i,r){if(0===e.length||!t||!o)return v.Utils.returnResolvedPromise(S.errors.cacheAdsWithClearanceLogicConfigurationProblem);var a=jQuery.extend(!0,[],e);return function(e,t){if(0===e.length)return v.Utils.returnResolvedPromise();for(var n=[],i=new jQuery.Deferred,r=0;r<e.length;r++)n.push(l(e[r],t));jQuery.when.apply(null,n).then(i.resolve,i.reject),i.promise()}(o.enactClearanceLogic(a,t,y.getAdLevelCacheConfiguration(),s,i).adsToRemoveFromCache,i),function(e,t,n,i,r){function a(){return function e(t,n,i,r){n<=0||0===t.length||g(t.shift(),i,r).then(function(){e(t,--n,i,r)}).fail(function(){e(t,n,i,r)})}(e,t,i,r),v.Utils.returnResolvedPromise()}return 0<n&&!function(e,t){for(var n=0;n<t;n++){var i=e[n];if(i&&i.isCacheable)return!1}return!0}(e,n)?function(e,t){for(var n=0;n<t;n++){var i=e[n];if(i&&i.isCacheable&&!b.isAdExistInCacheAndContainsAllAssets(i))return!1}return!0}(e,n)?(I("adsAlreadyCached",{demandSourceName:i.demandSourceName,productType:i.productType}),a()):(o=jQuery.extend(!0,[],e),s=n,d=i,l=r,c=new jQuery.Deferred,function e(t,n,i,r,a){n<=0?a.resolve():0===t.length&&0<n?a.reject(S.errors.cacheMandatoryAdsFailed):g(t.shift(),i,r).then(function(){e(t,--n,i,r,a)}).fail(function(){e(t,n,i,r,a)})}(o,s,d,l,c),c.promise()).then(a):a();var o,s,d,l,c}(a,t,n,i,r)},areNonMandatoryAdsToCacheConfigured:function(e,t){return!(!v.Utils.isDefined(e)||!v.Utils.isDefined(t))&&e<t},setReferencesForAds:function(e,t){var n,i,r;if(Array.isArray(e))for(var a=0;a<e.length;a++)(r=e[a])&&r.isCacheable&&(n=m.AdUtils.getAdId(e[a]),i=t,d.setReferenceForAd(n,i))},unsetReferencesForAds:function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)D(m.AdUtils.getAdId(e[n]),t)},unsetReferencesForInstance:function(e){d.unsetAllReferencesForReferrer(e)}}}},{"./AdsAssetsClearanceService":105,"./AdsReferencesManager":108,"./CacheConstants":110,"./CacheUtils":111}],107:[function(f,e,t){e.exports=function(l,c){var u=f("./CacheConstants");return{saveFileWithRetry:function(t,n,i,r){var a=[],o=new(f("./CacheAssetRetry"))(r,d),e=l.PubSub.subscribe("NativeCallback.assetCached",function(e){e.path=decodeURIComponent(e.path),e[u.assetKeys.path]===n&&-1!==t.indexOf(e[u.assetKeys.file])&&(o.areRetryAttemptsPerformed()&&l.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetrySuccess",[{demandSourceName:i.demandSourceName,productType:i.productType,file:t,currentRetryAttempt:o.getAttemptsSoFar(),totalRetryAttempts:r.adAssetRetryAttempts}]),l.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",[e]),l.PubSub.clearHandlers(a))}),s=l.PubSub.subscribe("NativeCallback.assetCachedFailed",function(e){e.path=decodeURIComponent(e.path),e[u.assetKeys.path]===n&&-1!==t.indexOf(e[u.assetKeys.file])&&(o.shouldExecuteRetry()?o.performRetryWithDelay():(o.areRetryAttemptsPerformed()&&l.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetryFailed",[{demandSourceName:i.demandSourceName,productType:i.productType,file:t,currentRetryAttempt:o.getAttemptsSoFar(),totalRetryAttempts:r.adAssetRetryAttempts}]),l.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedFailure",[e]),l.PubSub.clearHandlers(a)))});function d(){c.callSDKFunction("saveFile",{file:t,path:n,overrideExistingFile:!1})}a.push(e,s),d()},deleteFolder:function(t){if(t){var n=[],e=l.PubSub.subscribe("NativeCallback.deleteFolderSuccess",function(e){c.isIOS()&&(e.path=decodeURIComponent(e.path)),e.path===t&&(l.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",[e]),l.PubSub.clearHandlers(n))}),i=l.PubSub.subscribe("NativeCallback.deleteFolderFailed",function(e){c.isIOS()&&(e.path=decodeURIComponent(e.path)),e.path===t&&(l.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderFailure",[e]),l.PubSub.clearHandlers(n))});n.push(e,i),c.callSDKFunction("deleteFolder",{path:t},"deleteFolderSuccess","deleteFolderFailed")}}}}},{"./CacheAssetRetry":109,"./CacheConstants":110}],108:[function(e,t,n){t.exports=function(){var i={};function r(e,t){if(e&&t&&i.hasOwnProperty(e)){var n=i[e].indexOf(t);-1!==n&&i[e].splice(n,1)}}return{setReferenceForAd:function(e,t){e&&t&&(i.hasOwnProperty(e)||(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t))},unsetReferenceForAd:r,unsetAllReferencesForReferrer:function(e){for(var t=Object.keys(i),n=0;n<t.length;n++)r(t[n],e)},getReferenceCountOfAd:function(e){return(t=e,t&&i.hasOwnProperty(t)?i[t]:[]).length;var t}}}},{}],109:[function(e,t,n){t.exports=function(e,t){var n=e&&e.adAssetRetryAttempts,i=e&&e.adAssetRetryInterval,r=0;return{shouldExecuteRetry:function(){return r<n&&"function"==typeof t},areRetryAttemptsPerformed:function(){return 0<r},getAttemptsSoFar:function(){return r},performRetryWithDelay:function(){setTimeout(function(){r++,t()},1e3*i)}}}},{}],110:[function(e,t,n){t.exports={assetKeys:{URL:"URL",size:"size",label:"label",path:"path",file:"file"},errors:{cacheAssetInvalidParams:"Unable to cache asset due to invalid cacheModule/adId/asset",cacheAdsWithClearanceLogicConfigurationProblem:"Unable to cacheAds due to not being in new flow/no ads/no need to cache ads/no clearance service",cacheMandatoryAdsFailed:"Failed to cache mandatory ads"},adsAssetsCacheDir:"ads",supportNewCacheStructureConfigurationKey:"supportNewCacheStructure",fileNameFromURLPattern:/[^/]+$/,adLevelCache:"adLevelCache",maxAdsToSaveInCache:"maxAdsToSaveInCache",defaultMaxAdsToSaveInCache:30}},{}],111:[function(e,t,n){t.exports=function(r){var i=e("./CacheConstants");function a(e){return i.adsAssetsCacheDir+"/"+e}function o(e,t){return"../"+e+"/"+t}function s(e){if(!e)return null;var t=e.match(i.fileNameFromURLPattern);return t&&0!==t.length?t[0]:null}return{isAssetValid:function(e){return e&&"string"==typeof e[i.assetKeys.URL]},extractAssetsFromAd:function(e){e.ext&&e.ext.appData&&e.ext.appData.adAssets&&(e.ext.appData.appImages=e.ext.appData.adAssets,delete e.ext.appData.adAssets);for(var t=[],n=r.AdAssets.extractStaticFiles(e),i=0;i<n.length;i++)t.push({URL:n[i]});return t},buildAdFolderPath:a,buildAdAssetsPath:o,extractFileNameFromURL:s,extendAssetWithLocalPath:function(e,t){if(!e)return null;var n=s(e[i.assetKeys.URL]);return jQuery.extend({},e,{file:n,path:o(a(t),n)})},getAdLevelCacheConfiguration:function(){return{cacheBase:i.adsAssetsCacheDir}}}}},{"./CacheConstants":110}],112:[function(e,t,n){"use strict";var i=function(){function e(){this.store={}}return e.prototype.setData=function(e,t){this.store[e]=t},e.prototype.getData=function(e){return this.store[e]},e.prototype.clear=function(){this.store={}},e}();t.exports=i},{}],113:[function(Oe,e,t){e.exports=function(D,I,w,e,P,t,T){"use strict";var O,l,c,u,n=!1,f=e.demandSourceName,F=I.adUnitUrl,x=I.jQuery(),g=!1,p=new(Oe("./../../components/MultipleInventories")),L=new(Oe("./PreloadAdManager"))(D,I),v=Oe("../../components/OMIDConstants"),N=new(Oe("./../../components/sdkPluginType/SDKPluginTypeHandler"))(I,D.Utils),m=Oe("./../../components/AdFeaturesParser"),h=P.eventicsCategories,U={},V=P.displayMode,b=!1,r=0,i=null,M={},S=w.closeButtonStates,a=[],s=w.CB,d=null,y=0,A={},C=I[P.productType],E=new(Oe("./DemandEntityBuilder.js"))(P,e),k=Oe("../../patches/PatchIOSLoadAfterLoad.js")(D,I,E),K=t,o=Oe("./FetchDemand/FetcherPatch.js")(D,I,P,K,w),B=I.DemandUtils,R=new(Oe("./../RewardedVideo/dsTaskManager.js"))(D,I,E,w),j=Oe("../../components/VastService.js")(D,I),W=new(Oe("./../RewardedVideo/availabilityReporter.js"))(D,I,P,E,R),_=new(Oe("./../RewardedVideo/availabilityManager.js"))(D,I,W,P),G=new(Oe("./PayloadBuilder.js"))(x,I,D,E,w),H=Oe("../../components/containers/WPADUtils")(I),q=!0,Q=I.InstancesTimers;function J(){return I.ImpressionsCounterService.getCountersByProduct(P.productType).bidding+1}var z=function(){a.push(D.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",function(e){if(B.shouldReceiveMessage(E,e)){var t,n,i;if(I.log("globals ready: "+b+" initSuccess in settings: "+U.numOfBannersToInitSuccess+" adUnits: "+p.size(e.inventoryId),I.LogLevels.verbose),0===U.numOfBannersToInitSuccess)n=1,t=T.areCampaignsAvailable(re(e.inventoryId).slice(0,n),n);else{var r=ae(e.inventoryId);n=r.length;var a=$(p.getOffers(e.inventoryId),U.numOfBannersToInitSuccess);i=a<=n?a:n,t=T.areCampaignsAvailable(r,i)}I.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+t,I.LogLevels.verbose),b&&t&&Z(e.inventoryId)}})),a.push(D.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",function(e){if(B.shouldReceiveMessage(E,e)){var t,n=-1,i={};D.Utils.isDefined(e.id)&&(t=ie(e.id,e.inventoryId),i=I.AdUtils.updateEventWithAdParams(U,t,i),n=t&&D.Utils.isDefined(t.inventoryIndex)?t.inventoryIndex:-1),K.trackEvent(h.campaignDeletedCache,{inventoryIndex:n},i)}})),a.push(D.PubSub.subscribe("PrecacheManager.campaignSavedCallback",function(e){if(B.shouldReceiveMessage(E,e)){var t,n=-1,i=null,r={};D.Utils.isDefined(e.id)&&(t=ie(e.id,e.inventoryId),i=e.id,n=t&&D.Utils.isDefined(t.inventoryIndex)?t.inventoryIndex:-1,r=I.AdUtils.updateEventWithAdParams(U,t,r)),x.extend(r,{eNameStart:{name:h.campaignSavedCache.name+(i||"")},inventoryIndex:n}),K.trackTimingStop(h.campaignSavedCache,r)}})),a.push(D.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",function(e){if(B.shouldReceiveMessage(E,e)){var t=x.extend({},h.campaignSavedCache);t.name=t.name+(e.id||""),K.trackTimingStart(t)}})),a.push(D.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",function(e){B.shouldReceiveMessage(E,e)&&I.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),I.LogLevels.verbose)})),a.push(D.PubSub.subscribe("PrecacheManager.cacheNextFail",function(o){B.shouldReceiveMessage(E,o)&&o.deletedAds&&0<o.deletedAds.length&&x.each(o.deletedAds,function(e,t){var n=ie(t,o.inventoryId),i=I.AdUtils.updateEventWithAdParams(U,n,{}),r=o.deletedAdsData;if(r&&r[e].id==t){var a=r[e].failedAssetsUrlsArray.toString();i.rvnomoreoffersreason=a.substring(0,999)}K.trackEvent(h.campaignFailedToCache,{},i),te(t,o.inventoryId)})})),a.push(D.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",function(e){B.shouldReceiveMessage(E,e)&&(D.PubSub.publish(P.productType+".fallbackToNonPrecache",[e]),K.trackEvent(h.fallbackToNonPrecache))})),a.push(D.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",function(e){if(B.shouldReceiveMessage(E,e)){I.log("RV cacheAdsFailedCallback "+JSON.stringify(e),I.LogLevels.verbose);for(var t,n,i,r=e.deletedOffers.length,a=e.deletedOffers,o=e.deletedAdsData,s=0;s<r;s++){var d=a[s],l=ie(d,e.inventoryId),c=I.AdUtils.updateEventWithAdParams(U,l,{});if(o&&o[s].id==d){var u=o[s].failedAssetsUrlsArray.toString();c.rvnomoreoffersreason=u.substring(0,999)}K.trackEvent(h.campaignFailedToCache,{},c),ee(d,e.inventoryId)}if(0===U.numOfBannersToInitSuccess)n=1,t=T.areCampaignsAvailable(re(e.inventoryId).slice(0,n),n);else{var f=ae(e.inventoryId);n=f.length;var g=$(p.getOffers(e.inventoryId),U.numOfBannersToInitSuccess);i=g<=n?g:n,t=T.areCampaignsAvailable(f,i)}_.cacheAdsFailed(b,t,e.errorLog,Z.bind(null,e.inventoryId))}})),a.push(D.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",function(e){B.shouldReceiveMessage(E,e)&&I.log("PM | preProcessingFailedCallback "+e,I.LogLevels.verbose)})),a.push(D.PubSub.subscribe("Cache.assetRetrySuccess",function(e){if(B.shouldReceiveMessage(E,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,{});e.assetType===w.assetType.adunitAsset?K.trackEvent(h.adUnitRetrySuccess,{generalMessage:t.substring(0,250)},n):e.assetType===w.assetType.adAsset&&K.trackEvent(h.adAssetRetrySuccess,{generalMessage:t.substring(0,250)},n)}})),a.push(D.PubSub.subscribe("Cache.assetRetryFailed",function(e){if(B.shouldReceiveMessage(E,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,{});e.assetType===w.assetType.adunitAsset?K.trackEvent(h.adUnitRetryFail,{generalMessage:t.substring(0,250)},n):e.assetType===w.assetType.adAsset&&K.trackEvent(h.adAssetRetryFail,{generalMessage:t.substring(0,250)},n)}})),a.push(D.PubSub.subscribe("Cache.executeRetryFileUrlEmpty",function(e){var t={},n=e.listOfFilesUrls.toString();t.callfailreason=e.failedCachedFile.substring(0,255),t.rvnomoreoffersreason=n.substring(0,999),K.trackEvent(h.executeRetryFileUrlEmpty,{},t)})),a.push(D.PubSub.subscribe("SDKController.AdTracked",function(e){B.shouldReceiveMessage(E,e)&&(e=I.AdUtils.formatParamsToAdId(e),I.callSDKFunction("adCredited",B.extendCallbackParamsWithParentProductConfig(E,{credits:ie(I.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))})),a.push(D.PubSub.subscribe("SDKController.AdStarted",function(e){if(B.shouldReceiveMessage(E,e)&&I.RingerSwitchService.isInitiated()){var t={},n=he();n&&n.ext&&(t=Ae(i.ext)),I.RingerSwitchService.startListener(t),I.log("Ringer | startListener ringer status from AdStarted.",I.LogLevels.info)}})),a.push(D.PubSub.subscribe("SDKController.Analytics",function(e){if(B.shouldReceiveMessage(E,e)&&e&&e.action){var t=e.action,n=e.eventParam;"fireEvent"===t?K.trackEvent(n.eName,n.label,n.data):"startTiming"===t?K.trackTimingStart(n.eName,n.data):"stopTiming"===t?K.trackTimingStop(n.eName,n.data):"setCustomData"===t&&(I.log("Controller - setCustomData received",I.LogLevels.verbose),K.updateBaseData(n.data))}})),a.push(D.PubSub.subscribe("SDKController.AdLoaded",function(e){if(B.shouldReceiveMessage(E,e)){var t,n,i,r=I.AdUtils.getAdId(e),a=ie(r,e.inventoryId),o=e.inventoryId;if(clearTimeout(O),I.log("ad loaded with params: "+JSON.stringify(e),I.LogLevels.verbose),a&&K.updateBaseData({rvPlayMethod:a.displayMode}),D.Utils.isDefined(e.errMsg)){R.publish("AdErrorState",[B.extendCallbackParamsWithDemandConfig(E,{error:!0})]),I.log("Error in loading ad: "+e.errMsg,I.LogLevels.error);var s={generalMessage:e.errMsg,vastViewCount:0};return s=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,s),s=I.AdUtils.updateEventWithAdParams(U,a,s),K.trackEvent(h.adLoadedError,{},s),pe(a),t=a,n=I.AdUtils.getAdId(t),i=R.getStatus().duringEngage,te(n,t.inventoryId),void(i&&!g?function(){I.log(P.productType+" adLoaded with error | no offers for user - show dialog",I.LogLevels.verbose),I.setCloseButtonState({productType:P.productType,demandSourceName:f,state:S.close});var e={productType:P.productType,message:l&&l.noOffers?l.noOffers:w.labels.noOffers,yes:"close",alwaysClose:!0};I.postAdUnitEvent({name:"alertUserOnError",options:e}),K.trackEvent(h.userAlert,{inventoryIndex:t.inventoryIndex||-1})}():(I.log("DemandSource | adLoaded with error - removing and moving to next offer",I.LogLevels.verbose),me(null),I.removeAdUnit(ie(n,t.inventoryId))))}U.viewType===w.viewTypes.externalView&&K.incrementSessionNumber(),K.trackEvent(h.adLoaded,{vastViewCount:0}),D.Utils.isDefined(e.enableBackButton)&&I.setBackButtonState(e.enableBackButton),e=I.AdUtils.formatParamsToAdId(e),I.onAdLoaded(ie(I.AdUtils.getAdId(e),e.inventoryId));var d={totalNumberCredits:ne(o),numOfAdUnits:p.size(o),adViewId:e.adViewId};_.adLoadedSuccessfully(d,P.forcePreload)}})),a.push(D.PubSub.subscribe("SDKController.AdError",function(e){B.shouldReceiveMessage(E,e)&&I.log("SDKController.AdError:"+JSON.stringify(e),I.LogLevels.verbose)})),a.push(D.PubSub.subscribe("SDKController.dialogBoxResume",function(e){B.shouldReceiveMessage(E,e)&&K.trackEvent(h.dialogBoxResume)})),a.push(D.PubSub.subscribe("SDKController.dialogBoxExit",function(e){B.shouldReceiveMessage(E,e)&&K.trackEvent(h.dialogBoxExit)})),a.push(D.PubSub.subscribe(P.productType+".isVisible",function(e){if(B.shouldReceiveMessage(E,e)){var t=he();I.setCurrentDisplayedAd(t);var n=I.getAdViewContainer(t);n&&n.shouldReportAdVisible()&&I.onAdVisible()}})),a.push(D.PubSub.subscribe("SDKController.adClosed",function(e){B.shouldReceiveMessage(E,e)&&(I.SKAdImpressionService.endImpression(e.ad,Pe,Te),K.resetBaseData(w.keysToResetOnAdClosed))})),a.push(D.PubSub.subscribe(P.productType+".GetConfig",function(e){if(B.shouldReceiveMessage(E,e)){I.log("Bidder ProductInstance | getConfig received");var t=he();if(!t)return void I.log("Bidder ProductInstance | getConfig with no loaded ad");o=t,s=e,(d=ie(I.AdUtils.getAdId(o),o.inventoryId))?(function(e){U.requestID&&(e.requestID=U.requestID);var t,n,i,r=(t=I.getApiData({scdn:1,protocol:0,defaultProtocol:1}).scdn,n=I.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+t,"prod"!==I.getEnv()&&(n=I.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env),n);x.extend(!0,e,I.getFormattedDeviceData(),(i=r,{settings:{protocol:I.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:i,appKey:I.getSDKDataByKey(w.requiredSDKDataKeys.applicationKey),appOrientation:I.getSDKDataByKey(w.requiredSDKDataKeys.appOrientation),deviceLanguage:I.getSDKDataByKey(w.requiredSDKDataKeys.deviceLanguage),bundleId:I.getSDKDataByKey(w.requiredSDKDataKeys.bundleId),sdkAbName:I.getSDKDataByKey(w.requiredSDKDataKeys.sdkAbName),deviceId:I.getDeviceId(),skOverlaySupported:I.SKOverlayManager.isSKOverlaySupported()}}))}(d),a=(n=d).displayMode!=V.softprecache&&T.isPrecache(),n.settings.omidUrl=(i=n,r=I.OMIDService.getVersionData().omidVersion,I.OMIDService.isAdOmidSupported(i)&&v.omidVersionRequiresWebviewPerAd[r]?I.OMIDService.getOmidBundleUrl():""),void 0===n.productType&&(n.productType=E.productType),void 0===n.demandSourceName&&(n.demandSourceName=E.demandSourceName),n.displayOnAdReady=U.displayOnAdReady,n.settings.precache=a,n.settings.sessionDepth=J(),n.settings.viewType=U.viewType,D.AdAssets.isAdAbleToCache(n)&&(n.settings.ableToCache=n.ext.ableToCache,delete n.ext.ableToCache),s&&s.callback&&s.callback.call(null,d)):I.log("line[456]: no current available ad",I.LogLevels.verbose)}var n,i,r,a,o,s,d})),a.push(D.PubSub.subscribe(P.productType+"isVisible",function(e){if(I.log("Bidder ProductInstance | isVisible"),B.shouldReceiveMessage(E,e)){var t=he();if(I.isAdDisplayed(t))return void I.log("Bidder ProductInstance | isVisible | isAdDisplayed=true");if(!t)return void I.log("Bidder ProductInstance | isVisible | ad is null");I.getCurrentDisplayedAdType()!==P.productType&&I.getCurrentDisplayedAd()||I.setCurrentDisplayedAd(t)}}))};function X(e){var t={};if(D.Utils.isDefined(e.ad)){var n=e.ad&&D.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;t=I.AdUtils.updateEventWithAdParams(U,e.ad,t),x.extend(t,{inventoryIndex:n})}return t}a.push(D.PubSub.subscribe("ExternalContainer.duringCreation",function(e){B.shouldReceiveMessage(E,e)&&K.trackEvent(h.duringCreation)}));var $=function(e,t){for(var n=e.length<t?e.length:t,i=t,r=0;r<n;r++)e[r].isCacheable||i--;return i},Y=function(){R.publish("InitiatedAPICall",[B.extendCallbackParamsWithProductConfig(E,{duringInit:!1})])},Z=function(e){var t,n,i;if(I.log("Bidder ProductInstance | handlePossibleAdUnitsReady",I.LogLevels.verbose),oe(e)){var r=p.size(e),a=ne(e);Y(),P.forcePreload||_.canReportAvailable(r,a),n=oe(t=e),i=T.isPrecache(),L.canPreloadCandidateAd(!1,!1,n,!1,i,U.displayOnAdReady)&&function(e){var t=new x.Deferred;if(!R.canPreload())return I.log("Cannot preload at this time, "+R.getStatusMsg(),I.LogLevels.error),D.Utils.returnRejectedPromise(w.errors.showAdFailedReasons.taskManagerPreload);var n=he()||oe(e);n?(x.extend(!0,n,E),De(n,!1,t),t.promise()):(I.log("Cannot preload with no offer",I.LogLevels.error),D.Utils.returnRejectedPromise(w.errors.showAdFailedReasons.preloadNoAd))}(t)}},ee=function(e,t){p.removeOfferById(e,t)&&!p.isEmpty(t)&&T.incrementNextCampaign()},te=function(e,t){var n=p.getOfferById(e,t);n?n.toRemove=!0:I.log("Error in mark current ad to be removed:"+e,I.LogLevels.error)},ne=function(e){for(var t=0,n=p.getOffers(e),i=p.size(e),r=0;r<i;r++)t+=n[r].credits;return t},ie=function(e,t){var n=p.getOfferById(e,t);return n||I.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(p.getOffers(t)),1),n},re=function(e){return x.grep(p.getOffers(e),function(e){return!(D.Utils.isDefined(e.toRemove)&&e.toRemove)})},ae=function(e){var t=re(e);return x.grep(t,function(e){return e.isCacheable})},oe=function(e){var t,n=ie(I.AdUtils.getAdId(le(e)),e);return t=T.isPrecache()&&n&&n.isCacheable?(n=ie(I.AdUtils.getAdId(de(e)),e),V.precache):V.nonprecache,n&&!n.displayMode&&se(n,t),n},se=function(e,t){e&&(e.displayMode=t)},de=function(e){return 0===U.numOfBannersToInitSuccess?T.getCurrentAd(re(e).slice(0,1)):T.getCurrentAd(re(e))},le=function(e){return p.getCurrentOffer(e)},ce=function(e){g=!1;var t=I.AdUtils.getAdId(e);R.publish("Engaged",[B.extendCallbackParamsWithProductConfig(E,{duringEngage:!1})]);var n=ie(t,e.inventoryId);clearTimeout(O),n?(I.log("onEngageEnd with params: "+JSON.stringify(n),I.LogLevels.verbose),D.Utils.isDefined(n)&&n.toRemove&&(I.AdsAssetsManager.unsetReferencesForAds([e],E.instanceUniqueId),I.log("removing ad id: "+t,I.LogLevels.verbose),ee(t,n.inventoryId))):I.log("Tried to end engage with no ad",I.LogLevels.error)},ue=function(e){var t=new x.Deferred;if(D.Utils.isDefined(e.response)&&D.Utils.isDefined(e.response.errorCode)){Y();var n=D.Utils.isDefined(e.response.errorMessage)&&e.response.errorMessage?e.response.errorMessage:P.errors.init[1003];t.reject(n)}else D.Utils.isDefined(e.seatbid)&&D.Utils.isDefined(e.seatbid.bid)&&D.Utils.isDefined(e.seatbid.ext)&&D.Utils.isDefined(e.seatbid.ext.labels)?t.resolve(e):(Y(),t.reject(P.errors.init[1004]));return t.promise()},fe=function(e){var o=function(e){return U.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(ve),function(e){if(e){var t={blacklistedCampaigns:e.join(",")};I.getTokenService().updateToken(t)}}(C.filteredListService.getFilteredListCampaigns())),D.Utils.returnResolvedPromise()},s=function(e){return function(e){for(var t=0;t<e.length;t++){var n=e[t].ext.layoutData;if(D.Utils.isDefined(n)&&D.Utils.isDefined(n.html)&&0<n.html.length)return!0}return!1}(e)?I.libsManager.manageDownloadLibsFileByFiletype(P.libsCacheFiles.dapi):D.Utils.returnResolvedPromise()},d=function(t){return T.isPrecache()&&function(e){for(var t=!1,n=0;n<e.length;n++)if(I.AdUtils.isPlayablePrecachedAd(e[n])){t=!0;break}return t}(t)?I.libsManager.manageDownloadLibsFileByFiletype(P.libsCacheFiles.externalObfuscation).then(function(e){!function(e,t){for(var n=0;n<e.length;n++)I.AdUtils.isPlayablePrecachedAd(e[n])&&(e[n].ext.ableToCache="success"===t)}(t,e)}):D.Utils.returnResolvedPromise()};return function(e){R.setConnection(!0);var t,n,i=e.seatbid.bid,r=e.seatbid.ext,a=p.getAvailableInventoryId();return K.updateBaseData({landingId:r.landingId,strategyId:r.strategyId,adSource:r.adSource}),u=r.deliveryPlumbus,x.when((n=e,void(U=new m(D,I,w,x,P,!0).parse(n))),(t=r,c=t.labels,void(t.templateid==P.customDialog?c.confirmCloseMsg[w.confirmCloseMsgMap[0]].alwaysClose=!0:l=t.labels))).then(function(e){e&&I.DeviceDataService.setPullDataOnLoadAd(e.enablePullDataOnLoadAd)}.bind(null,U)).then(function(e){e&&e.hasOwnProperty(w.numOfBannersToInitSuccess)&&e.hasOwnProperty(w.numOfBannersToCache)&&K.updateBaseData({cacheConfig:e[w.numOfBannersToInitSuccess]+"/"+e[w.numOfBannersToCache]})}.bind(null,U)).then(I.CampaignsFilter.filterByAppInstalled.bind(null,i,U,P.filterDisableTypes)).then(o).then(function(e){for(var t=e&&e.length||0,n="",i=0;i<t;i++)n+=I.AdUtils.getAdType(e[i],U),i<t-1&&(n+=", ");return K.updateBaseData({feedSize:t,feedCampaignOrder:n}),D.Utils.returnResolvedPromise()}.bind(null,i)).then(function(e){return e.some(function(e){return I.OMIDService.isAdOmidSupported(e,P.productType)})&&I.OMIDService.downloadOmidJsBundle(),D.Utils.returnResolvedPromise()}.bind(null,i)).then(T.decidePrecacheStatus.bind(null,{numOfCampaigns:i.length,settings:U})).then(function(){return _.setAMSettings({preFetchAllVasts:U.preFetchAllVasts,isPreCache:T.isPrecache(),numOfBannersToInitSuccess:U.numOfBannersToInitSuccess,reportOnAdunitReady:U.reportOnAdunitReady}),i&&0<i.length?(b=!1,A={productType:P.productType,demandSourceName:E.demandSourceName,retryAttempts:U.adunitRetryAttempts||15,retryInterval:U.adunitRetryInterval||1,assetType:w.assetType.adunitAsset},I.adUnitGlobals.updateAdUnitGlobals(!0,U.purgeAdunitLibsFile,A,K)):D.Utils.returnRejectedPromise(w.errors.noFill)}).then(function(){return x.when(s(i),d(i))}).then(I.AdsAssetsManager.setAdAssetsForAds.bind(null,i)).then(function(e){for(var t=0;t<e.length;t++)e[t].isCacheable=0<e[t].adAssets.length}.bind(null,i)).then(I.AdsAssetsManager.setReferencesForAds.bind(null,i,E.instanceUniqueId)).then(function(e){x.each(e,function(e,t){t.inventoryIndex=e})}.bind(null,i)).then(function(e,t,n){var i,r=new x.Deferred,a=I.AdsAssetsManager.cacheAdsWithClearanceLogic(e,t.numOfBannersToCache,t.numOfBannersToInitSuccess,n,ye(t)).then(function(){clearTimeout(i),r.resolve()}).fail(function(e){clearTimeout(i),r.reject(e)});return i=setTimeout(function(){var e=a.state();"pending"!==e&&"rejected"!==e||(K.trackEvent(h.adLevelCachingTimeout,{callfailreason:"ad level timeout expired when caching ads"}),r.reject("cacheAdsAssets timeout expired")),"resolved"===e&&r.resolve()},P.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow),r.promise()}.bind(null,i,U,E)).then(function(){b=!0;var e=p.setOffers(i.slice(0),a);0!==U.numOfBannersToInitSuccess||P.forcePreload||_.reportAdAvailable({numOfAdUnits:p.size(e),totalNumberCredits:ne(e)}),Z(e)}).fail(function(e){var t=e||"Fail parse adUnit info from api response";I.AdsAssetsManager.unsetReferencesForAds(i,E.instanceUniqueId),p.removeInventory(a),be(),me(null),e&&I.log(e,I.LogLevels.error),_.inventoryEmpty(e||t)}),(new x.Deferred).resolve(x.extend({},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)},ge=function(e,t,n){var i,r=I.AdUtils.getAdId(e);I.log("Error in loading ad - timeout in "+r,I.LogLevels.error),i=n?h.showAdFail:h.adLoadedError;var a,o,s={isprecache:T.isPrecache()};s=I.AdUtils.updateEventWithAdParams(U,e,s),K.trackEvent(i,{callfailreason:"Error in loading ad - timeout"},s),B.extendCallbackParamsWithProductConfig(E,e),te(r,e.inventoryId),me(null),j.removeIframe((a=r,o="",D.Utils.isDefined(E.demandSourceName)&&(o=E.demandSourceName),o+=E.productType+a)),U.viewType===w.viewTypes.externalView?I.removeAdUnitFromExternal(e):I.removeAdUnit(e)},pe=function(e){e&&e.cid?I.blacklistService.addToBlacklistedCampaigns(E.productType,E.demandGroupName,e.cid):I.log("DemandSource | cannot add to blacklist with no ad",I.LogLevels.error)},ve=function(e){e&&e.cid&&C.filteredListService.addToFilteredListCampaigns(e.cid)},me=function(e){i=e},he=function(){return i},be=function(){_.reset(),L.reset()},Se=function(){for(var e=Object.keys(p.getInventories()),t=0;t<e.length;t++)I.AdsAssetsManager.unsetReferencesForAds(p.getOffers(e[t]),E.instanceUniqueId)};function ye(e){return{adAssetRetryAttempts:e.adAssetRetryAttempts||5,adAssetRetryInterval:e.adAssetRetryInterval||1}}function Ae(e){return e?{ringerUpdateDelay:U.ringerUpdateDelay,shouldSetRingerUpdateDelay:I.AdUtils.isPlayableCampaign(e)||I.AdUtils.isMRAIDCampaign(e)||I.AdUtils.isExternalCampaign(e)}:{}}function Ce(e,t){I.log(t,I.LogLevels.error);var n=B.extendCallbackParamsWithDemandConfig(E,{errMsg:t});D.PubSub.publish(P.productType+".failedToShow",[n]);var i=t;i!==w.errors.showAdFailedReasons.preloadNoAd&&i!==w.errors.showAdFailedReasons.showNoAd&&(i+=R.getStatusMsg()),K.trackEvent(h.showAdFail,{callFailReason:i}),I.callSDKFunction(e,B.extendCallbackParamsWithDemandConfig(E,{errMsg:t}))}function De(e,t,n){I.log("Bidder ProductInstance | preloadFlow"),L.preloadAdFinished();var i,r,a,o,s,d,l,c=!1,u=T.isPrecache();e.displayMode===V.softprecache&&(c=!0),o=c,s=e,d=!1,u&&!o&&(I.AdUtils.isPlayablePrecachedAd(s)?D.AdAssets.isAdAbleToCache(s)&&(d=!0):d=!0),d&&(i=e,r=I.AdUtils.getAdId(i),a=T.getConfig().precachePath+r+"/",D.AdAssets.updateAdunitPrecachePath(i,a,I.AdUtils.isPlayablePrecachedAd(i))),e.isWPAD=H.shouldDisplayAdOnExternalWebView(e,U),l=e.isWPAD?(I.AdUtils.setViewType(U,e,w.viewTypes.externalView),M.shouldBuildAdUnitUrlForExternal=!0,2):(I.log("Bidder ProductInstance | ad is not WPAD"),I.AdUtils.removeViewTypeFromSetting(U),M.shouldBuildAdUnitUrlForExternal=!1,1),e.displayStrategy=l;var f=I.AdUtils.updateEventWithAdParams(U,e,{});x.extend(f,{displaystrategy:l}),K.updateBaseData(f),me(e);var g,p,v,m,h,b,S,y,A=!c&&u,C=F.getAdunitUrl(A,E,M,I.getDeviceOs());g=e,p=C,v=t,m=P.timerLengths.loadAdTimeout,clearTimeout(O),O=setTimeout(function(){ge(g,p,v)},m),x.extend(U,{preload:!0}),I.AdUtils.setViewType(U,e),N.shouldShowInStandAloneView(I.getConfig())&&I.AdUtils.extendSettingsWithStandaloneViewSupport(U),e=I.StoreKitService.updateAdWithStoreAppId(e,U),I.loadAdUnitUrl(e,C,E,U),e.isWPAD?(h=e,b=n,S=I.getContainerCreationHandler(h),(y=S.getState())===S.getCreationStates().createdSuccessfully?(I.log("product instance | containerState | createdSuccessfully ",I.LogLevels.info),b.resolve(h)):y===S.getCreationStates().duringCreation?x.when(S.getCreationResultPromise()).then(function(){I.log("product instance | during creation result: success",I.LogLevels.info),b.resolve(h)}).fail(function(e){b.reject("product instance | "+e)}):b.reject("product instance | did not start to create native webview")):n.resolve(e)}function Ie(){K.trackEvent(h.startImpressionSuccess)}function we(e){K.trackEvent(h.startImpressionFailed,{},{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function Pe(){K.trackEvent(h.endImpressionSuccess)}function Te(e){K.trackEvent(h.endImpressionFailed,{},{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}return{name:f,init:function(){n||(be(),z(),a.push(D.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",function(e){if(B.shouldReceiveMessage(E,e)){var t={custom_b:e.maxAdsToSaveInCache};t=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,t),K.trackEvent(h.adLevelCacheReachedMaxCapacity,{},t)}})),a.push(D.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",function(e){if(B.shouldReceiveMessage(E,e)){var t=X(e);t=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,t),K.trackEvent(h.saveAdInCacheSuccess,{},t);var n=I.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(U.numOfBannersToInitSuccess,U.numOfBannersToCache);b&&n&&Z(p.getActiveInventoryId())}})),a.push(D.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",function(e){if(B.shouldReceiveMessage(E,e)){var t=X(e);t=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,t),K.trackEvent(h.saveAdInCacheFailure,{},t),te(I.AdUtils.getAdId(e.ad))}})),a.push(D.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",function(e){if(B.shouldReceiveMessage(E,e)){var t=X(e);t=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,t),K.trackEvent(h.deleteAdFromCacheSuccess,{},t)}})),a.push(D.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",function(e){if(B.shouldReceiveMessage(E,e)){var t=X(e);t=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,t),K.trackEvent(h.deleteAdFromCacheFailure,{},t)}})),a.push(D.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",function(e){if(B.shouldReceiveMessage(E,e)){var t=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,{});t=x.extend(t,e),K.trackEvent(h.adsAlreadyCached,{},t)}})),a.push(D.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",function(e){if(B.shouldReceiveMessage(E,e)){var t=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,{}),n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]";K.trackEvent(h.adAssetRetrySuccess,{generalMessage:n.substring(0,250)},t)}})),a.push(D.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",function(e){if(B.shouldReceiveMessage(E,e)){var t=Q.extendEventDataWithElapsedLoadTime(E.productType,E.demandSourceName,{}),n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]";K.trackEvent(h.adAssetRetryFail,{generalMessage:n.substring(0,250)},t)}})),a.push(D.PubSub.subscribe("AdsAssetsManager.urlNotMatched",function(e){if(B.shouldReceiveMessage(E,e)){var t=X(e);x.extend(t,{generalMessage:JSON.stringify(e.asset)}),K.trackEvent(h.urlNotMatched,{},t)}})),T.init(),R.init(),I.initEventics(B.extendCallbackParamsWithParentProductConfig(E,{})),(P=P||{}).isExhaustInstanceAllowed=!1,n=!0)},initProduct:function(e){e&&e.demandSourceName},loadAdWithAdm:function(e,i){e&&e.adm&&e.demandSourceName===f&&(I.log("loadAdWithAdm | bidder | resetting last response to none",I.LogLevels.verbose),I.unloadAdViewsByProductExceptDisplayedView(E),I.DeviceDataService.shouldPullDataOnLoadAd()&&I.DeviceDataService.pullData(),be(),me(null),o.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer),!R.canEngage()),(R.publish("InitiatedAPICall",[B.extendCallbackParamsWithProductConfig(E,{duringInit:!0})]),D.Utils.returnResolvedPromise(e.adm)).then(ue).then(fe,function(e){var t;switch(t=P.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?t=e.responseText:e.errorMessage&&""!==e.errorMessage&&(t=e.errorMessage);break;case"string":""!==e&&(t=e)}return Y(),D.Utils.returnRejectedPromise(t)}).then(function(){},function(e){try{if("string"==typeof e){var t=parseInt(e);1001<t&&t<1006&&(e=P.errors.load.invalid)}}catch(e){}var n=B.extendCallbackParamsWithDemandConfig(E,{errMsg:e});I.callSDKFunction(i,n),D.PubSub.publish(P.productType+".failedToLoad",[n])}))},showAd:function(e,n,i){var t,r,a=he()||oe(p.getActiveInventoryId());function o(e){return(t=e,t?R.canEngage()?(R.publish("Engaged",[B.extendCallbackParamsWithProductConfig(E,{duringEngage:!0})]),I.displayAdView(t),D.Utils.returnResolvedPromise()):D.Utils.returnRejectedPromise(w.errors.showAdFailedReasons.taskManagerEngage):D.Utils.returnRejectedPromise(w.errors.showAdFailedReasons.showNoAd)).then(function(){var e;e=n,K.trackTimingStop(h.showAdSuccess,{eNameStart:h.showAdCalled}),I.callSDKFunction(e,B.extendCallbackParamsWithDemandConfig(E)),k.onShowSuccess(E)},function(e){Ce(i,e)});var t}a?(I.RingerSwitchService.isInitiated()&&a&&(I.RingerSwitchService.startListener(Ae(a.ext)),I.log("Ringer | startListener from DS.",I.LogLevels.info)),function(){d=new x.Deferred;var t=D.PubSub.subscribe(s+".getDemandSourceStateSuccess",function(e){B.shouldReceiveMessage(E,e)&&(D.PubSub.unsubscribe(t),D.PubSub.unsubscribe(n),"resolved"!==d.state()&&(y=e&&e.state||y,d.resolve(e)))}),n=D.PubSub.subscribe(s+".getDemandSourceStateFail",function(e){B.shouldReceiveMessage(E,e)&&(D.PubSub.unsubscribe(n),D.PubSub.unsubscribe(t),"resolved"!==d.state()&&d.resolve())}),e=B.extendCallbackParamsWithParentProductConfig(E);I.callSDKFunction("getDemandSourceState",e,"getDemandSourceStateSuccess","getDemandSourceStateFail")}(),I.isContainerLoaded(a)?o(a):(t=a,r=new x.Deferred,De(t,!0,r),r.promise()).then(o).fail(function(e){Ce(i,e)})):Ce(i,"ShowAd | Bidding | there is no ad to show.")},onShowAdFailed:Ce,adVisible:function(e){g=!0;var t,n=I.AdUtils.getAdId(e),i=ie(n,e.inventoryId);I.log("Bidder ProductInstance | adVisible | id="+n),R.publish("Engaged",[B.extendCallbackParamsWithParentProductConfig(E,{duringEngage:!0})]),K.trackTimingStop(h.adVisible,{eNameStart:h.showAdCalled}),I.log("Bidder ProductInstance | send event adVisible"),I.SKAdImpressionService.startImpression(i,Ie,we),te(n,e.inventoryId),K.trackTimingStart(h.adVisibleToClose),U.extraOffersInEndCard&&I.ExtraOffers.isSupported(I.getConfig().mobileSDKSettings.deviceOs,I.getConfig().mobileSDKSettings.deviceApiLevel,i,U)&&x.when((t={impressionsCount:J(),firstAttemptToGetFeed:q,retryCounter:r,deliveryPlumbus:u},G.createPayload(t).then(function(e){return e}))).then(function(e){var t=I.getCurrentDisplayedAd();return I.ExtraOffers.fetchExtraOffersInventory(e,t.productType,t.cid,t.settings.requestID,t.ext.opportunityID)}).then(function(e){I.postAdUnitEvent(JSON.stringify({name:"extraOffersEndCardData",data:{inventory:e}}))}).fail(function(e){I.postAdUnitEvent(JSON.stringify({name:"cancelExtraOffersEndCard"}));var t=e&&"string"==typeof e?e:"Extra offers flow failed";I.log("onExtraOffersFetchFail | Reason: "+t),K.trackEvent(h.getExtraOffersInventoryFailed,{callfailreason:t})})},engageEnd:function(e,t){if(I.log("engageEnd",I.LogLevels.verbose),B.shouldReceiveMessage(E,e)){var n;n=e,I.log("_resetPreloadedAd",I.LogLevels.verbose),ce(n),K.resetBaseData(w.baseDataKeys),L.setCanPreloadFlag(!0);var i={handlePrefetchFailedOnBackground:function(e){I.log("_backgroundPrefetchFailed | ManualLoad",I.LogLevels.verbose),this.publishNoMoreOffers(w.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){var t;I.log("handlePrefetchFailedOnVisible | manuel load",I.LogLevels.verbose),t=e,T.isPrecache()&&I.AdsAssetsManager.cacheAssetsOfAd(p.getActiveInventory().getCurrentOffer(),E,ye(U)).then(Z.bind(null,t.inventoryId))},handleAdClosed:function(e){I.log("handleAdClosed | manuel load",I.LogLevels.verbose),I.AdsAssetsManager.unsetReferencesForAds(p.getOffers(e.inventoryId),E.instanceUniqueId),p.removeInventory(e.inventoryId)},publishNoMoreOffers:function(e){I.log("publishNoMoreOffers | ManualLoad",I.LogLevels.verbose);var t=B.extendCallbackParamsWithDemandConfig(E,{errorMsg:e||w.noMoreOffersReason.noMoreOffersToShowInFeed});D.PubSub.publish(P.productType+".NoMoreOffers",[t])}};!function(e){I.log("getAndResetErrorStateFromTaskManager",I.LogLevels.verbose);var t=e.getStatus().adErrorState;return e.publish("AdErrorState",[B.extendCallbackParamsWithProductConfig(E,{error:!1})]),t}(R)?e.engaged?i.handleAdClosed(e):i.handlePrefetchFailedOnBackground(e):e.engaged?i.handlePrefetchFailedOnVisible(e):i.handlePrefetchFailedOnBackground(e),(D.Utils.isFunction(t)?t:function(){})()}},getConfirmCloseMsg:function(){return c&&c.confirmCloseMsg[w.confirmCloseMsgMap[0]]},getDSEventics:function(){return K},reset:function(){Se(),p.reset(),R.publish("InitiatedTimeoutAttempt",[B.extendCallbackParamsWithProductConfig(E,{duringAPITimeoutAttempts:!1})]),be(),me(null)},clearListeners:function(){x.each(a,function(e,t){D.PubSub.unsubscribe(t)})},shouldAvoidHandleFrameClose:function(){return!1}}}},{"../../components/OMIDConstants":41,"../../components/VastService.js":63,"../../components/containers/WPADUtils":76,"../../patches/PatchIOSLoadAfterLoad.js":167,"./../../components/AdFeaturesParser":2,"./../../components/MultipleInventories":35,"./../../components/sdkPluginType/SDKPluginTypeHandler":84,"./../RewardedVideo/availabilityManager.js":138,"./../RewardedVideo/availabilityReporter.js":139,"./../RewardedVideo/dsTaskManager.js":140,"./DemandEntityBuilder.js":114,"./FetchDemand/FetcherPatch.js":118,"./PayloadBuilder.js":119,"./PreloadAdManager":121}],114:[function(i,e,t){e.exports=function(e,t){var n=i("../../components/Constants.js");return{productType:e.productType,demandGroupName:t.demandGroupName||t.demandSourceName,demandSourceName:t.demandSourceName,demandType:t.demandType||n.demandSourceType.demandSource,isInAppBidding:t.isInAppBidding,demandSourceId:t.demandSourceId,waterfallPosition:t.waterfallPosition,originalDemandSourceName:t.originalDemandSourceName||t.demandSourceName,instanceUniqueId:e.productType+"."+t.demandSourceName,adSize:t.adSize}}},{"../../components/Constants.js":13}],115:[function(e,t,n){t.exports=function(){return{initAd:{name:"initAd",id:1},initAdFail:{name:"initAdFail",id:2},showAd:{name:"showAd",id:4},showAdFail:{name:"showAdFail",id:5},showAdSuccess:{name:"showAdSuccess",id:26},showAdCalled:{name:"showAdCalled",id:-3},adVisible:{name:"adVisible",id:8},videoStarted:{name:"videoStarted",id:9},videoCompleted:{name:"videoCompleted",id:10},endCardDisplayed:{name:"endCardDisplayed",id:11},clickDownloadNow:{name:"clickDownloadNow",id:12},endCardDisplayedToClickDownload:{name:"endCardDisplayedToClickDownload",id:-4},campaignSavedCache:{name:"campaignSavedCache",id:106},campaignsAvailableFromCache:{name:"campaignsAvailableFromCache",id:107},noMoreOffers:{name:"noMoreOffers",id:105},clickReplay:{name:"clickReplay",id:111},clickVideoSound:{name:"clickVideoSound",id:112},adVisibleToClose:{name:"adVisibleToClose",id:-5},adUnitRetrySuccess:{name:"adUnitRetrySuccess",id:170},adUnitRetryFail:{name:"adUnitRetryFail",id:171},adLoaded:{name:"adLoaded",id:6},adLoadedError:{name:"adLoadedError",id:7},userAlert:{name:"userAlert",id:113},campaignFailedToCache:{name:"campaignFailedToCache",id:109},campaignDeletedCache:{name:"campaignDeletedCache",id:108},loadAd:{name:"loadAd",id:21},loadAdFailed:{name:"loadAdFailed",id:22},loadAdFailedForExhaustedInstance:{name:"loadAdFailedExhaustedInstance",id:32},loadAdIgnored:{name:"loadAdIgnored",id:24},loadAdSuccess:{name:"loadAdSuccess",id:23},bannerLoaded:{name:"bannerLoaded",id:27},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159},getExtraOffersInventoryFailed:{name:"getExtraOffersInventoryFailed",id:160},bannerDestroyed:{name:"bannerDestroyed",id:30},bannerLoadSuccessToVisible:{name:"bannerLoadSuccessToVisible",id:-7},bannerVisibleToClick:{name:"bannerVisibleToClick",id:-8},bannerReloadDuringLoad:{name:"bannerReloadDuringLoad",id:251},bannerLoadedDuringShow:{name:"bannerLoadedDuringShow",id:232},gatewayRequest:{name:"gatewayRequest",id:310},fallbackToNonPrecache:{name:"fallbackToNonPrecache",id:154},parseVastSuccess:{name:"parseVastSuccess",id:240},parseVast:{name:"parseVast",id:-11},parseVastFail:{name:"parseVastFail",id:241},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},parseVastInfo:{name:"parseVastInfo",id:157},refreshInterval:{name:"refreshInterval",id:164},attemptToBringNewFeed:{name:"attemptToBringNewFeed",id:163},adAssetRetrySuccess:{name:"adAssetRetrySuccess",id:320},adAssetRetryFail:{name:"adAssetRetryFail",id:321},executeRetryFileUrlEmpty:{name:"executeRetryFileUrlEmpty",id:323},saveAdInCacheSuccess:{name:"saveAdInCacheSuccess",id:279},saveAdInCacheFailure:{name:"saveAdInCacheFailure",id:280},deleteAdFromCacheSuccess:{name:"deleteAdFromCacheSuccess",id:281},deleteAdFromCacheFailure:{name:"deleteAdFromCacheFailure",id:282},adLevelCacheReachedMaxCapacity:{name:"adLevelCacheReachedMaxCapacity",id:283},adsAlreadyCached:{name:"adsAlreadyCached",id:284},adLevelCachingTimeout:{name:"adLevelCachingTimeout",id:285},duringCreation:{name:"duringCreation",id:287},startImpressionSuccess:{name:"startImpressionSuccess",id:304},startImpressionFailed:{name:"startImpressionFailed",id:305},endImpressionSuccess:{name:"endImpressionSuccess",id:306},endImpressionFailed:{name:"endImpressionFailed",id:307},overlayDismissed:{name:"overlayDismissed",id:299},overlayDismissFailure:{name:"overlayDismissFailure",id:337},overlayRemovalFailure:{name:"overlayRemovalFailure",id:338},overlayMissing:{name:"overlayMissing",id:339},presentOverlay_c:{name:"presentOverlay_c",id:352},overlayDidFinishPresentation_c:{name:"overlayDidFinishPresentation_c",id:353},presentOverlayFailed_c:{name:"presentOverlayFailed_c",id:354},dismissOverlay_c:{name:"dismissOverlay_c",id:355},overlayWillStartDismissal_c:{name:"overlayWillStartDismissal_c",id:356},overlayDidFinishDismissal_c:{name:"overlayDidFinishDismissal_c",id:357},overlayWillStartPresentation_c:{name:"overlayWillStartPresentation_c",id:358},presentOverlayDuringPendingPresent:{name:"podpp",id:359},noFill:{name:"noFill",id:20},urlNotMatched:{name:"urlNotMatched",id:349}}}},{}],116:[function(e,t,n){t.exports={direct:{http:{method:"GET",dataType:"jsonp"}}}},{}],117:[function(e,t,n){t.exports=function(i){var r=e("./FetchDemandConst.js");return{fetchFeed:function(e,t,n){return i({url:e,data:t,type:r.direct.http.method,dataType:r.direct.http.dataType,timeout:n||1e4})}}}},{"./FetchDemandConst.js":116}],118:[function(e,t,n){t.exports=function(r,i,e,a,o){var s=295e3,d=i.getConfig().mobileSDKSettings.deviceOs,l=i.getConfig().controllerConfig||{},c=!(e.overrideFeedSettings.isSupportFetchFeedOnAdCloseLogic&&!e.overrideFeedSettings.shouldFetchNewFeedOnAdClose),u={applyPatchLogic:{name:"applyPatchLogic",id:841},applyPatchLogicEnd:{name:"applyPatchLogicEnd",id:842}};function f(){setTimeout(function(){i.callSDKFunction("displayWebView",{display:!1}),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer()})}function g(n){var t=r.PubSub.subscribe(o.CB+".viewableChange",function(e){e.isViewable&&(r.PubSub.unsubscribe(t),f())}),i=r.PubSub.subscribe(o.CB+".webviewPatch",function(){var e,t;r.PubSub.unsubscribe(i),e=n,t=window.timerService.timeElapsed(window.lastWebviewClosedTimer)-e,a.trackEvent(u.applyPatchLogicEnd,{generalMessage:0<t?t:-9}),f()})}function p(e){if(d!==o.deviceOs.android)return!1;if("number"!=typeof e||e<s)return!1;var t=(i.getApplicationExternalConfig().getGeneralConfig()||{}).shouldApplyNetworkSolution,n=l.shouldApplyNetworkSolution;return!(c&&(!1===t||!1===n))}return{applyCommunicationSolution:function(e,t){var n;p(e)&&(t||(i.log("applyCommunicationSolution five minutes communication issue | timeElapsed window.lastWebviewClosedTimer > 5 minutes: "+e),n=e,a.trackEvent(u.applyPatchLogic,{generalMessage:0<s?n:-8}),g(e),i.callSDKFunction(o.nativeInterfaceMethod.displayWebView,{display:!0,productType:o.IS,activityThemeTranslucent:!0,success:"webviewPatch"})))},shouldApplyCommunicationSolution:p}}},{}],119:[function(U,e,t){e.exports=function(d,l,c,r,u){var a,o,f=U("./PayloadBuilderConstants.js"),t="PayloadBuilder | ",n=U("../../components/storeKit/SKANModel")(),i=r.productType,s=r.demandSourceName,g=r.demandGroupName,p=0,v=!1,m=0,h=l.getConfig().controllerConfig;function b(e){var t=l.getSDKDataByKey(u.abTests.abt);return t&&t.hasOwnProperty(u.abtParamByProductType[i])&&0<t[u.abtParamByProductType[i]].length&&(e.abt=t[u.abtParamByProductType[i]]),c.Utils.returnResolvedPromise(e)}function S(e){var t=n.extractDataForPayload(h,l.getConfig().applicationSettings);return d.extend(e,t),c.Utils.returnResolvedPromise(e)}function y(e){return d.extend(e,{demandSource:s,impressionsCount:p,auid:l.AppUserIdService.getAUID()}),c.Utils.returnResolvedPromise(e)}function A(e){var t=l.ImpressionsCounterService.getPayloadCounters(r);return d.extend(e,t),c.Utils.returnResolvedPromise(e)}function C(e){var t={},n=l.getApiData({fpf:0});v&&n&&(t.fpf=n.fpf);var i=r.waterfallPosition;return c.Utils.isDefined(i)&&(t.wp=i),t.retryCounter=m,t.delpl=a,o&&(t.sesp=o),d.extend(e,t),c.Utils.returnResolvedPromise(e)}function D(e){var t=l.getApiData({segmentId:0}),n=l.getApiData({segmentName:0});return t&&n&&d.extend(e,{segmentId:t.segmentId,segmentName:n.segmentName}),c.Utils.returnResolvedPromise(e)}function I(e){var t=l.getApiData({coppa:0});return e.cscd=t&&t.coppa,c.Utils.returnResolvedPromise(e)}function w(e){var t=l.getApiData({med_ver:0});return t&&t.med_ver&&(e.medv=t.med_ver),c.Utils.returnResolvedPromise(e)}function P(t){var e=new d.Deferred;return l.shouldExtendApiDataWithDebugData()?l.getSDKDebugParams().then(function(e){return d.extend(t,e),c.Utils.returnResolvedPromise(t)}).always(function(){e.resolve(t)}):e.resolve(t),e.promise()}function T(e){if(!l.blacklistService.isEmpty(i,g)){var t=l.blacklistService.getBlacklistedCampaigns(i,g);d.extend(e,{blacklistedCampaigns:t.join(",")})}return c.Utils.returnResolvedPromise(e)}function O(e){return l.LastSeenCampaignService.shouldAddLastDisplayedAdCampaignIdToPayload(i)&&d.extend(e,{lastSeenCampaignId:l.LastSeenCampaignService.getLastDisplayedAdCampaignId()}),c.Utils.returnResolvedPromise(e)}function F(e){if(l.OMIDService.isNativeServiceActivated()){var t=l.OMIDService.getVersionData();d.extend(e,{omidEnabled:!0,omidVersion:t.omidVersion,omidPartnerVersion:t.omidPartnerVersion})}else d.extend(e,{omidEnabled:!1,moatSupported:!1});return c.Utils.returnResolvedPromise(e)}function e(){var t,n,i=d.Deferred(),r=function(e){c.PubSub.clearHandlers([t,n]),i.resolve(e)};return t=c.PubSub.subscribe(f.CB+"."+f.callbacks.getTokenSuccess,function(e){r(e)}),n=c.PubSub.subscribe(f.CB+"."+f.callbacks.getTokenFailed,function(e){e&&e.errMsg?l.log(f.errorLog+": "+e.errMsg,l.LogLevels.error):l.log(f.errorLog),r({})}),l.callSDKFunction(f.nativeFunction,{functionName:f.nativeAPI.getToken},f.callbacks.getTokenSuccess,f.callbacks.getTokenFailed),i.promise()}function x(s){return e().then(function(e){if("object"!=typeof e)return c.Utils.returnResolvedPromise(s);var t,n,i,r,a,o=(t=l.SupplyConfigurations.getNetworkConfigValueByKey(f.addTokenKeysToPayload),Array.isArray(t)||(t=[]),t);return d.each(e,function(e,t){var n;n=e,(-1<o.indexOf(n)||-1<e.indexOf(f.metaDataPrefix))&&(s[e]=t)}),e.hasOwnProperty(f.metaDataOneTokenKey)&&(n=s,"object"==typeof(i=e[f.metaDataOneTokenKey])&&d.each(i,function(e,t){n[f.metaDataPrefix+e]=t})),l.isIOS()&&!l.isLegacy(l.featureMap.mutableAdvertingTrackingData)&&(r=s,(a=function(e){for(var t,n={},i=u.advertiserIdParamsToUpdate,r=0;r<i.length;r++)t=i[r],void 0!==e[t]&&(n[t]=e[t]);return n}(e))&&(l.getConfigurationHelper().parseConfiguration(a,{},l.getConfig().mobileSDKSettings),l.AdvertisingIdService.decideOnAdvertisingId(l.getConfig().mobileSDKSettings,h),d.each(a,function(e,t){var n=l.getSDKDataByKey(e);void 0!==n&&(r[e]=n)}))),c.Utils.returnResolvedPromise(s)})}function L(e){var t=l.getSDKDataByKey(u.xCodeVersion);return t&&d.extend(e,{xCodeVersion:t}),c.Utils.returnResolvedPromise(e)}function N(e){return l.log(t+"returnPayload | built payload for "+i),c.Utils.returnResolvedPromise(e)}return{createPayload:function(e){return p=e.impressionsCount,v=e.firstAttemptToGetFeed,m=e.retryCounter,a=e.deliveryPlumbus,o=e.sesp,l.getApplicationInfo(l.DemandUtils.extendCallbackParamsWithParentProductConfig(r,{})).then(l.getAPIRequiredData).then(y).then(A).then(C).then(I).then(w).then(D).then(b).then(S).then(P).then(T).then(O).then(F).then(x).then(L).then(N)},getToken:e}}},{"../../components/storeKit/SKANModel":86,"./PayloadBuilderConstants.js":120}],120:[function(e,t,n){t.exports={CB:"NativeCallback",metaDataPrefix:"metadata_",metaDataOneTokenKey:"md",addTokenKeysToPayload:"addTokenKeysToPayload",nativeFunction:"iabTokenAPI",nativeAPI:{getToken:"getToken"},callbacks:{getTokenSuccess:"getTokenSuccess",getTokenFailed:"getTokenFailed"},errorLog:"payloadBuilder | getToken Failed"}},{}],121:[function(e,t,n){t.exports=function(s,d){var l=!0;function e(e){l=!!e}return{canPreloadCandidateAd:function(e,t,n,i,r,a){if(!l)return d.log("PreloadAdManager | Can not preload next ad right now"),!1;if(e&&!t)return d.log("PreloadAdManager | Skipping preload on capped demand"),!1;if(a)return d.log("PreloadAdManager | can preload true | Display when ad ready true"),!0;var o=s.VastUtils.isVastCampaign(n);return t||r&&!o||i?(d.log("PreloadAdManager | preload ad "+d.AdUtils.getAdId(n)),!0):(d.log("PreloadAdManager | skip preload ad "+d.AdUtils.getAdId(n)),!1)},preloadAdFinished:function(){e(!1)},setCanPreloadFlag:e,reset:function(){e(!0)}}}},{}],122:[function(Kn,e,t){function n(c,p,u,e,o,t,a){"use strict";var s,n=!1,d=e.demandSourceName,f=p.adUnitUrl,g=p.jQuery(),i,v=new(Kn("./../../components/MultipleInventories.js")),m=new(Kn("./PreloadAdManager"))(c,p),r=Kn("../../components/OMIDConstants"),l=Kn("./../../components/AdFeaturesParser"),h=new(Kn("../../patches/PublisherPatchEasybrain.js"))(p.getConfigurationHelper()),b=new(Kn("./../../components/sdkPluginType/SDKPluginTypeHandler.js"))(p,c.Utils),S=o.eventicsCategories,y={},A=g.extend({},o.precacheConfig),C=o.displayMode,D=!1,I=0,w=null,P=null,T=null,O=!1,F,x=[],L,N={},U,V=u.closeButtonStates,M=!1,E=[],k=null,K=null,B=null,R=u.CB,j=null,W=0,_={},G={},H,q=p[o.productType],Q=new(Kn("./DemandEntityBuilder.js"))(o,e),J=Kn("../../patches/PatchIOSLoadAfterLoad.js")(c,p,Q),z=t||ge(),X=Kn("./FetchDemand/FetcherPatch.js")(c,p,o,z,u),$=p.DemandUtils,Y=new(Kn("./../RewardedVideo/dsTaskManager.js"))(c,p,Q,u),Z=Kn("../../components/VastService.js")(c,p),ee=new(Kn("./../RewardedVideo/availabilityReporter.js"))(c,p,o,Q,Y),te=new(Kn("./../RewardedVideo/availabilityManager.js"))(c,p,ee,o),ne=new(Kn("./PayloadBuilder.js"))(g,p,c,Q,u),ie=Kn("../../components/containers/WPADUtils")(p),re,ae=!0,oe=1,se=!1,de=p.getExternalContainer(),le=p.InstancesTimers,ce=function(){E.push(c.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",function(e){if($.shouldReceiveMessage(Q,e)){var t,n,i;if(p.log("globals ready: "+D+" initSuccess in settings: "+y.numOfBannersToInitSuccess+" adUnits: "+v.size(e.inventoryId),p.LogLevels.verbose),0===y.numOfBannersToInitSuccess)n=1,t=re.areCampaignsAvailable(et(e.inventoryId).slice(0,n),n);else{var r=tt(e.inventoryId);n=r.length;var a=He(v.getOffers(e.inventoryId),y.numOfBannersToInitSuccess);i=a<=n?a:n,t=re.areCampaignsAvailable(r,i)}p.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+t,p.LogLevels.verbose),D&&t&&Je(e.inventoryId)}})),E.push(c.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",function(e){if($.shouldReceiveMessage(Q,e)){var t,n=-1,i={};c.Utils.isDefined(e.id)&&(t=Ye(e.id,e.inventoryId),i=p.AdUtils.updateEventWithAdParams(y,t,i),n=t&&c.Utils.isDefined(t.inventoryIndex)?t.inventoryIndex:-1),z.trackEvent(S.campaignDeletedCache,{inventoryIndex:n},i)}})),E.push(c.PubSub.subscribe("PrecacheManager.campaignSavedCallback",function(e){if($.shouldReceiveMessage(Q,e)){var t,n=-1,i=null,r={};c.Utils.isDefined(e.id)&&(t=Ye(e.id,e.inventoryId),i=e.id,n=t&&c.Utils.isDefined(t.inventoryIndex)?t.inventoryIndex:-1,r=p.AdUtils.updateEventWithAdParams(y,t,r)),g.extend(r,{eNameStart:{name:S.campaignSavedCache.name+(i||"")},inventoryIndex:n}),z.trackTimingStop(S.campaignSavedCache,r)}})),E.push(c.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",function(e){if($.shouldReceiveMessage(Q,e)){var t=g.extend({},S.campaignSavedCache);t.name=t.name+(e.id||""),z.trackTimingStart(t)}})),E.push(c.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",function(e){$.shouldReceiveMessage(Q,e)&&p.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),p.LogLevels.verbose)})),E.push(c.PubSub.subscribe("PrecacheManager.cacheNextFail",function(o){$.shouldReceiveMessage(Q,o)&&o.deletedAds&&0<o.deletedAds.length&&g.each(o.deletedAds,function(e,t){var n=Ye(t,o.inventoryId),i=p.AdUtils.updateEventWithAdParams(y,n,{}),r=o.deletedAdsData;if(r&&r[e].id==t){var a=r[e].failedAssetsUrlsArray.toString();i.rvnomoreoffersreason=a.substring(0,999)}z.trackEvent(S.campaignFailedToCache,{},i),Xe(t,o.inventoryId)})})),E.push(c.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",function(e){$.shouldReceiveMessage(Q,e)&&(c.PubSub.publish(o.productType+".fallbackToNonPrecache",[e]),z.trackEvent(S.fallbackToNonPrecache))})),E.push(c.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",function(e){if($.shouldReceiveMessage(Q,e)){p.log("RV cacheAdsFailedCallback "+JSON.stringify(e),p.LogLevels.verbose);for(var t,n,i,r=e.deletedOffers.length,a=e.deletedOffers,o=e.deletedAdsData,s=0;s<r;s++){var d=a[s],l=Ye(d,e.inventoryId),c=p.AdUtils.updateEventWithAdParams(y,l,{});if(o&&o[s].id==d){var u=o[s].failedAssetsUrlsArray.toString();c.rvnomoreoffersreason=u.substring(0,999)}z.trackEvent(S.campaignFailedToCache,{},c),ze(d,e.inventoryId)}if(0===y.numOfBannersToInitSuccess)n=1,t=re.areCampaignsAvailable(et(e.inventoryId).slice(0,n),n);else{var f=tt(e.inventoryId);n=f.length;var g=He(v.getOffers(e.inventoryId),y.numOfBannersToInitSuccess);i=g<=n?g:n,t=re.areCampaignsAvailable(f,i)}te.cacheAdsFailed(D,t,e.errorLog,Je.bind(null,e.inventoryId))}})),E.push(c.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",function(e){if($.shouldReceiveMessage(Q,e)){p.log("PM | preProcessingFailedCallback "+e,p.LogLevels.verbose);var t=e.id,n=Ye(t,e.inventoryId);Re(n)&&($.extendCallbackParamsWithProductConfig(Q,n),p.addAdToLoadedCreatives(n),Qe(),ye(n))}})),E.push(c.PubSub.subscribe("Cache.assetRetrySuccess",function(e){if($.shouldReceiveMessage(Q,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,{});e.assetType===u.assetType.adunitAsset?z.trackEvent(S.adUnitRetrySuccess,{generalMessage:t.substring(0,250)},n):e.assetType===u.assetType.adAsset&&z.trackEvent(S.adAssetRetrySuccess,{generalMessage:t.substring(0,250)},n)}})),E.push(c.PubSub.subscribe("Cache.assetRetryFailed",function(e){if($.shouldReceiveMessage(Q,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,{});e.assetType===u.assetType.adunitAsset?z.trackEvent(S.adUnitRetryFail,{generalMessage:t.substring(0,250)},n):e.assetType===u.assetType.adAsset&&z.trackEvent(S.adAssetRetryFail,{generalMessage:t.substring(0,250)},n)}})),E.push(c.PubSub.subscribe("Cache.executeRetryFileUrlEmpty",function(e){var t={},n=e.listOfFilesUrls.toString();t.callfailreason=e.failedCachedFile.substring(0,255),t.rvnomoreoffersreason=n.substring(0,999),z.trackEvent(S.executeRetryFileUrlEmpty,{},t)})),E.push(c.PubSub.subscribe("SDKController.AdTracked",function(e){$.shouldReceiveMessage(Q,e)&&(e=p.AdUtils.formatParamsToAdId(e),p.callSDKFunction("adCredited",$.extendCallbackParamsWithParentProductConfig(Q,{credits:Ye(p.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))})),E.push(c.PubSub.subscribe("SDKController.AdStarted",function(e){if($.shouldReceiveMessage(Q,e)&&p.RingerSwitchService.isInitiated()){var t={},n=Ut();n&&n.ext&&(t=gn(T.ext)),p.RingerSwitchService.startListener(t),p.log("Ringer | startListener ringer status from AdStarted.",p.LogLevels.info)}})),E.push(c.PubSub.subscribe("SDKController.Analytics",function(e){if($.shouldReceiveMessage(Q,e)&&e&&e.action){var t=e.action,n=e.eventParam;"fireEvent"===t?z.trackEvent(n.eName,n.label,n.data):"startTiming"===t?z.trackTimingStart(n.eName,n.data):"stopTiming"===t?z.trackTimingStop(n.eName,n.data):"setCustomData"===t&&(p.log("Controller - setCustomData received",p.LogLevels.verbose),z.updateBaseData(n.data))}})),E.push(c.PubSub.subscribe("SDKController.AdLoaded",function(e){if($.shouldReceiveMessage(Q,e)){var t=p.AdUtils.getAdId(e),n=Ye(t,e.inventoryId),i=e.inventoryId;clearTimeout(F),p.log("ad loaded with params: "+JSON.stringify(e),p.LogLevels.verbose),n&&z.updateBaseData({rvPlayMethod:n.displayMode});var r=0;if(c.VastUtils.isVastCampaign(n)&&(r=c.VastUtils.getVastViewCount(n)),c.Utils.isDefined(e.errMsg)){Y.publish("AdErrorState",[$.extendCallbackParamsWithDemandConfig(Q,{error:!0})]),p.log("Error in loading ad: "+e.errMsg,p.LogLevels.error);var a={generalMessage:e.errMsg,vastViewCount:c.VastUtils.getVastViewCountForEvent(r)};return a=p.AdUtils.updateEventWithAdParams(y,n,a),a=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,a),z.trackEvent(S.adLoadedError,{},a),c.VastUtils.setMaxVastCount(n),Ot(n),void ye(n)}y.viewType===u.viewTypes.externalView&&z.incrementSessionNumber();var o=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,{});z.trackEvent(S.adLoaded,{vastViewCount:c.VastUtils.getVastViewCountForEvent(r)},o),c.Utils.isDefined(e.enableBackButton)&&p.setBackButtonState(e.enableBackButton),e=p.AdUtils.formatParamsToAdId(e),p.onAdLoaded(Ye(p.AdUtils.getAdId(e),e.inventoryId)),te.adLoadedSuccessfully({numOfAdUnits:v.size(i),totalNumberCredits:$e(i)})}})),E.push(c.PubSub.subscribe("SDKController.AdLoadError",function(e){$.shouldReceiveMessage(Q,e)&&(te.adLoadError(),p.unloadAdViewsByProduct(Q),hn()||Rt())})),E.push(c.PubSub.subscribe("SDKController.AdError",function(e){$.shouldReceiveMessage(Q,e)&&p.log("SDKController.AdError:"+JSON.stringify(e),p.LogLevels.verbose)})),E.push(c.PubSub.subscribe("SDKController.dialogBoxResume",function(e){$.shouldReceiveMessage(Q,e)&&z.trackEvent(S.dialogBoxResume)})),E.push(c.PubSub.subscribe("SDKController.dialogBoxExit",function(e){$.shouldReceiveMessage(Q,e)&&z.trackEvent(S.dialogBoxExit)})),E.push(c.PubSub.subscribe("SDKController.adClosed",function(e){$.shouldReceiveMessage(Q,e)&&(p.SKAdImpressionService.endImpression(e.ad,Ln,Nn),z.resetBaseData(u.keysToResetOnAdClosed))})),E.push(c.PubSub.subscribe(o.productType+".GetConfig",function(n){if($.shouldReceiveMessage(Q,n)){p.log("ProductInstance | getConfig received");var e=Ut();if(!e)return void p.log("ProductInstance | getConfig with no loaded ad");c.VastUtils.isVastCampaign(e)&&K?K.then(function(e,t){ve(t||e,n)}):ve(e,n)}})),E.push(c.PubSub.subscribe(o.productType+".isVisible",function(e){if(p.log("ProductInstance | isVisible"),$.shouldReceiveMessage(Q,e)){var t=Ut(),n=p.getCurrentDisplayedAd();if(p.isAdDisplayed(t))return void p.log("ProductInstance | isVisible | isAdDisplayed=true");t?n&&p.getCurrentDisplayedAdType()!==o.productType?z.trackEvent(S.bannerLoadedDuringShow):(p.setCurrentDisplayedAd(t),p.getCurrentDisplayedAdType()===u.BN&&de.shouldReportAdVisibleForBanners()&&(p.log("ProductInstance | isVisible | shouldReportAdVisible"),p.onAdVisible())):p.log("ProductInstance | isVisible | ad is null")}}))};E.push(c.PubSub.subscribe("ExternalContainer.duringCreation",function(e){$.shouldReceiveMessage(Q,e)&&z.trackEvent(S.duringCreation)}));var ue=function(){E.push(c.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",function(e){if($.shouldReceiveMessage(Q,e)){var t={custom_b:e.maxAdsToSaveInCache};t=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,t),z.trackEvent(S.adLevelCacheReachedMaxCapacity,{},t)}})),E.push(c.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",function(e){if($.shouldReceiveMessage(Q,e)){var t=fe(e);t=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,t),z.trackEvent(S.saveAdInCacheSuccess,{},t);var n=p.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(y.numOfBannersToInitSuccess,y.numOfBannersToCache);D&&n&&Je(v.getActiveInventoryId())}})),E.push(c.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",function(e){if($.shouldReceiveMessage(Q,e)){var t=fe(e);t=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,t),z.trackEvent(S.saveAdInCacheFailure,{},t),Xe(p.AdUtils.getAdId(e.ad))}})),E.push(c.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",function(e){if($.shouldReceiveMessage(Q,e)){var t=fe(e);t=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,t),z.trackEvent(S.deleteAdFromCacheSuccess,{},t)}})),E.push(c.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",function(e){if($.shouldReceiveMessage(Q,e)){var t=fe(e);t=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,t),z.trackEvent(S.deleteAdFromCacheFailure,{},t)}})),E.push(c.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",function(e){$.shouldReceiveMessage(Q,e)&&(e=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,e),z.trackEvent(S.adsAlreadyCached,{},e))})),E.push(c.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",function(e){if($.shouldReceiveMessage(Q,e)){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,{});z.trackEvent(S.adAssetRetrySuccess,{generalMessage:t.substring(0,250)},n)}})),E.push(c.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",function(e){if($.shouldReceiveMessage(Q,e)){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=le.extendEventDataWithElapsedLoadTime(Q.productType,Q.demandSourceName,{});z.trackEvent(S.adAssetRetryFail,{generalMessage:t.substring(0,250)},n)}})),E.push(c.PubSub.subscribe("AdsAssetsManager.urlNotMatched",function(e){if($.shouldReceiveMessage(Q,e)){var t=fe(e);g.extend(t,{generalMessage:JSON.stringify(e.asset)}),z.trackEvent(S.urlNotMatched,{},t)}}))};function fe(e){var t={};if(c.Utils.isDefined(e.ad)){var n=e.ad&&c.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;t=p.AdUtils.updateEventWithAdParams(y,e.ad,t),g.extend(t,{inventoryIndex:n})}return t}function ge(){var e={productChance:(p.getEnv(),1),baseData:{productType:Q.productType,demandSourceName:Q.demandSourceName,isBiddingInstance:hn()}};return c.Eventics.createEventic(e,p.EventsManager)}function pe(){return z}function ve(e,t){var n=Ye(p.AdUtils.getAdId(e),e.inventoryId);return n?(c.VastUtils.isVastCampaign(e)||me(n),Ie(n),t&&t.callback&&t.callback.call(null,n)):p.log("line[456]: no current available ad",p.LogLevels.verbose),n}function me(e){y.requestID&&(e.requestID=y.requestID);var t=he(p.getApiData({scdn:1,protocol:0,defaultProtocol:1}).scdn);return g.extend(!0,e,p.getFormattedDeviceData(),be(t))}function he(e){var t=p.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+e;return"prod"!==p.getEnv()&&(t=p.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env),t}function be(e){return{settings:{protocol:p.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:e,appKey:p.getSDKDataByKey(u.requiredSDKDataKeys.applicationKey),appOrientation:p.getSDKDataByKey(u.requiredSDKDataKeys.appOrientation),deviceLanguage:p.getSDKDataByKey(u.requiredSDKDataKeys.deviceLanguage),bundleId:p.getSDKDataByKey(u.requiredSDKDataKeys.bundleId),sdkAbName:p.getSDKDataByKey(u.requiredSDKDataKeys.sdkAbName),deviceId:p.getDeviceId(),skOverlaySupported:p.SKOverlayManager.isSKOverlaySupported()}}}function Se(){k=K=null}function ye(t){var e=p.AdUtils.getAdId(t);Xe(e,t.inventoryId);var n=Y.getStatus().duringEngage;Se();var i=s.getNextAd(n,t.inventoryId);function r(){p.log("RV adLoaded with error | no offers for user - show dialog",p.LogLevels.verbose),p.setCloseButtonState({productType:o.productType,demandSourceName:d,state:V.close});var e={productType:o.productType,message:L&&L.noOffers?L.noOffers:u.labels.noOffers,yes:"close",alwaysClose:!0};p.postAdUnitEvent({name:"alertUserOnError",options:e}),z.trackEvent(S.userAlert,{inventoryIndex:t.inventoryIndex||-1})}n&&t.isWPAD?r():n&&!i?r():(p.log("DemandSource | adLoaded with error - removing and moving to next offer",p.LogLevels.verbose),Nt(null),p.removeAdUnit(Ye(e,t.inventoryId)))}function Ae(e){return e&&e.displayMode?e.displayMode:C.softprecache}function Ce(){var e=v.getActiveInventoryId();z.incrementSessionNumber();var t=Ut()||nt(e);t||(t=it(!0,e));var n=p.AdUtils.updateEventWithAdParams(y,t,{});n.rvPlayMethod=Ae(t),z.updateBaseData(n)}function De(e){var t=p.OMIDService.getVersionData().omidVersion;return p.OMIDService.isAdOmidSupported(e)&&r.omidVersionRequiresWebviewPerAd[t]?p.OMIDService.getOmidBundleUrl():""}function Ie(e){var t=e.displayMode!=C.softprecache&&re.isPrecache();e.settings.omidUrl=De(e),void 0===e.productType&&(e.productType=Q.productType),void 0===e.demandSourceName&&(e.demandSourceName=Q.demandSourceName),e.settings.precache=t,e.settings.sessionDepth=oe,e.settings.viewType=y.viewType,c.AdAssets.isAdAbleToCache(e)&&(e.settings.ableToCache=e.ext.ableToCache,delete e.ext.ableToCache)}var we=function(e){var t="AttemptToBringNewAds | ";if(p.log(t),z.trackEvent(S.attemptToBringNewFeed,{generalMessage:Y.getStatusMsg()}),M)p.log(t+"Cannot bring feed attemptToBringNewAdsInProcess="+M);else{if(M=!0,!Y.allowExternalCallToApi())return p.log(t+"Cannot bring feed: "+Y.getStatusMsg()),void(P=setTimeout(function(){M=!1,p.log(t+"2 minutes delay finished"),we(e)},o.timerLengths.riDelay));te.inventoryEmpty(e),setTimeout(function(){p.log(t+"Can bring feed"),Pe(y.refreshInterval),p.unloadAdViewsByProduct(Q),M=!1,Rt()},0)}},Pe=function(e){p.log("setting refresh interval to: "+e,p.LogLevels.info),w&&clearInterval(w),e&&0!==e&&!hn()?w=setInterval(function(){z.trackEvent(S.refreshInterval),Y.canEngage()?(clearInterval(w),Y.canInitCallToApi().then(we)):(p.log("setDuringRefreshInterval(true)",p.LogLevels.info),Dn(!0))},e*o.timeUnit):p.log("No Refresh interval is needed")};function Te(e){U=e.labels,e.templateid==o.customDialog?U.confirmCloseMsg[u.confirmCloseMsgMap[0]].alwaysClose=!0:L=e.labels}var Oe=function(e){y=new l(c,p,u,g,o,hn()).parse(e)};function Fe(e){w&&clearInterval(w),Ht()&&Pe(e.refreshInterval)}function xe(e){p.DeviceDataService.setPullDataOnLoadAd(e.enablePullDataOnLoadAd)}var Le=function(){return Q.demandSourceName===u.RIS?u.RIS:q.getProductType()},Ne=function(e){g.each(e,function(e,t){t.inventoryIndex=e,re.isPrecache()&&re.setAdInventoryIndex(p.AdUtils.getAdId(t),e)})};function Ue(e){for(var t=0;t<e.length;t++)e[t].isCacheable=0<e[t].adAssets.length}function Ve(e){g.each(e,function(e,t){t.inventoryIndex=e})}function Me(){g.each(E,function(e,t){c.PubSub.unsubscribe(t)})}function Ee(){P&&clearTimeout(P),w&&clearInterval(w)}function ke(e){p.AdsAssetsManager.unsetReferencesForInstance(Q.instanceUniqueId);var t=!!e&&e.engaged;Me(),Ee();var n=g.extend({},Q,{engaged:t});c.PubSub.publish(o.productType+".exhaustedDemandSource",[n])}function Ke(e){var t,n=[];for(t=0;t<e.length;t++)re.isAdInCache(p.AdUtils.getAdId(e[t]))||n.push(e[t]);return n}var Be=function(e){var n=[];return g.each(e,function(e,t){t.ext&&t.ext.appData&&t.ext.appData.adAssets&&(t.ext.appData.appImages=t.ext.appData.adAssets,delete t.ext.appData.adAssets),n.push(t)}),n},Re=function(e){return re.isPrecache()&&c.VastUtils.isVastCampaign(e)&&e.ext.precacheVasts},je=function(e){return 1===e.length&&Re(e[0])&&(O=!0),c.Utils.returnResolvedPromise()},We=function(e){return gt(c.VastUtils.isVastCampaign(e)),e.inventoryId&&St(),ft(e).then(function(e,t){return p.AdUtils.formatVastAdForPrecache(t,We.bind(null,e))})},_e=function(e){var t=[];return O?t.push(p.AdUtils.formatVastAdForPrecache(e[0],We.bind(null,e[0]))):t=p.AdUtils.formatAdsForPrecache(e),t},Ge=function(r,a){var o,s,e,d=re.isPrecache();r=Be(r),Ne(r);var l=v.setOffers(r.slice(0),a);o=_e(r),s=He(r,y.numOfBannersToCache);var t=function(){if(c.VastUtils.isThereVastCampaign(et(l))&&te.setAMSettings({reportOnAdunitReady:!1},!0),d){var e=He(r,y.numOfBannersToInitSuccess),t=re.areCampaignsAvailable(o.slice(0,e),e);t&&z.trackEvent(S.campaignsAvailableFromCache),p.log("DemandSource | updateCurrentAds areCampaignsAvailable "+t,p.LogLevels.verbose),0===y.numOfBannersToInitSuccess&&te.reportAdAvailable({numOfAdUnits:v.size(l),totalNumberCredits:$e(l)}),(t||0===s||0===y.numOfBannersToInitSuccess)&&Je(l);var n=Ke(o),i={cacheTimeoutSuccessCallback:function(){Ge(r,a)},cacheTimeoutFailCallback:qe,applicationUserId:p.getSDKDataByKey(u.requiredSDKDataKeys.applicationUserId),applicationKey:p.getSDKDataByKey(u.requiredSDKDataKeys.applicationKey),newAdsToEnterCache:n,inventoryId:l,adAssetsCacheConfig:G};re.handleCacheAds(i)}else Je(l)};d&&(e=re.mergeCampaigns(o,s),p.log("DemandSource | updateCurrentAds after merge "+JSON.stringify(e),p.LogLevels.verbose)),!d||y.purgeCacheOnInit?(p.log("DemandSource | already purged cache so go strait to adding the new ads",p.LogLevels.verbose),t()):re.clearCacheByType(e).always(t)},He=function(e,t){for(var n=e.length<t?e.length:t,i=t,r=0;r<n;r++)e[r].isCacheable||i--;return i},qe=function(e){te.cacheTimeoutFail(e)},Qe=function(){Y.publish("InitiatedAPICall",[$.extendCallbackParamsWithProductConfig(Q,{duringInit:!1})])},Je=function(e){p.log("ProductInstance | handlePossibleAdUnitsReady",p.LogLevels.verbose);var t=nt(e);if(t){var n=c.VastUtils.isVastCampaign(t);if(O&&gt(n,e))bt(e);else{var i=v.size(e),r=$e(e),a=c.VastUtils.areAllCampaignTypesAreVast(et(e));Qe(),te.canReportAvailable(i,r,a,n)}de&&Q.productType===u.BN?Tn(y,Q,N):s.attemptToPreloadAd(!1,e)}},ze=function(e,t){v.removeOfferById(e,t)&&!v.isEmpty(t)&&re.incrementNextCampaign()},Xe=function(e,t){var n=v.getOfferById(e,t);n?n.toRemove=!0:p.log("Error in mark current ad to be removed:"+e,p.LogLevels.error),B=null},$e=function(e){for(var t=0,n=v.getOffers(e),i=v.size(e),r=0;r<i;r++)t+=n[r].credits;return t},Ye=function(e,t){var n=v.getOfferById(e,t);return n||p.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(v.getOffers(t)),1),n},Ze=function(e,t,n){return v.replaceOfferById(e,t,n)},et=function(e){return g.grep(v.getOffers(e),function(e){return!(c.Utils.isDefined(e.toRemove)&&e.toRemove)})},tt=function(e){var t=et(e);return g.grep(t,function(e){return e.isCacheable})},nt=function(e){var t,n=Ye(p.AdUtils.getAdId(st(e)),e);return t=re.isPrecache()&&n&&n.isCacheable?(n=Ye(p.AdUtils.getAdId(ot(e)),e),C.precache):C.nonprecache,n&&!n.displayMode&&rt(n,t),n},it=function(e,t){if(!e)return null;var n=at(t);return n?Ye(p.AdUtils.getAdId(n),t):null},rt=function(e,t){e&&(e.displayMode=t)},at=function(e){return 0<et(e).length?et(e)[0]:null},ot=function(e){return 0===y.numOfBannersToInitSuccess?re.getCurrentAd(et(e).slice(0,1)):re.getCurrentAd(et(e))},st=function(e){return v.getCurrentOffer(e)},dt=function(e){var t=p.AdUtils.getAdId(e);Y.publish("Engaged",[$.extendCallbackParamsWithProductConfig(Q,{duringEngage:!1})]),Nt(null),Se();var n=Ye(t,e.inventoryId);clearTimeout(F),n?(p.log("onEngageEnd with params: "+JSON.stringify(n),p.LogLevels.verbose),c.Utils.isDefined(n)&&n.toRemove&&(p.AdsAssetsManager.unsetReferencesForAds([e],Q.instanceUniqueId),p.log("removing ad id: "+t,p.LogLevels.verbose),ze(t,n.inventoryId))):p.log("Tried to end engage with no ad",p.LogLevels.error)},lt=function(e){var t=p.AdUtils.getAdId(e),n=Ye(t,e.inventoryId);c.Utils.isDefined(n)&&n.toRemove&&(p.log("removing ad id: "+t,p.LogLevels.verbose),ze(t,n.inventoryId))};function ct(e){k&&"pending"===k.state()&&(c.Utils.isDefined(e)?(p.log("handleVastAvailability - VAST failed to load with reason: "+e),k.reject()):(p.log("handleVastAvailability - VAST verified - resolve"),k.resolve()))}function ut(e){var t="";return c.Utils.isDefined(Q.demandSourceName)&&(t=Q.demandSourceName),t+=Q.productType+e}function ft(r){var a=p.AdUtils.getAdId(r),o=vt(r),s=r.inventoryId;if(r.ext.videoData.isVast&&B){var e=c.VastUtils.getVastViewCount(r),t=r.settings.preload,n=r.displayMode;B=c.VastUtils.setVastViewCount(B,e),(r=B).settings.preload=t,r.displayMode=n}else(r=c.VastUtils.setVastViewCount(r,0)).ext.vastExhaustIndex&&1<r.ext.vastExhaustIndex&&(B=r);return me(r),K=new g.Deferred,r.vastIframeId=ut(a),z.trackTimingStart(S.parseVast),Z.parseVast(r,re.isPrecache(),y).then(function(e){if(null!==K){if(z.trackTimingStop(S.parseVastSuccess,{generalMessage:o,eNameStart:S.parseVast}),!c.Utils.isDefined(r.toRemove)||!r.toRemove){e.ext.videoData.isVast=!0,c.Utils.isDefined(r.displayMode)&&(e.displayMode=r.displayMode),c.VastUtils.incrementVastViewCount(e),ct(e.errMsg);var t=r;return c.VastUtils.incrementVastViewCount(t),Ze(r=e,p.AdUtils.getAdId(r),s),K.resolve(t,e)}Z.removeIframe(ut(a))}},function(e){if(null!==K){var t={generalMessage:o,eNameStart:S.parseVast};if(t=p.AdUtils.updateEventWithAdParams(y,r,t),e.isTimeLimitReached&&(t.callFailReason="timeout"),z.trackTimingStop(S.parseVastFail,t),!c.Utils.isDefined(r.toRemove)||!r.toRemove){var n=c.VastUtils.incrementVastViewCount(r);ct(e.errMsg),Y.publish("AdErrorState",[$.extendCallbackParamsWithProductConfig(Q,{error:!0})]),p.log("Error in loading ad: "+e.errMsg,p.LogLevels.error);var i={generalMessage:e.errMsg,vastViewCount:c.VastUtils.getVastViewCountForEvent(n)};return i=p.AdUtils.updateEventWithAdParams(y,r,i),z.trackEvent(S.adLoadedError,{},i),c.VastUtils.setMaxVastCount(r),Ot(Ye(a,s)),K.reject()}Z.removeIframe(ut(a))}})}function gt(e,t){return pt(e)||mt(t)}function pt(e){return y.preFetchAllVasts&&e}function vt(e){var t;return pt(c.VastUtils.isVastCampaign(e))?t="preFetchAllVasts":mt(e.inventoryId)&&(t="vastAvailabilityValidation"),t}function mt(e){return re.isPrecache()&&c.VastUtils.areAllCampaignTypesAreVast(et(e))}function ht(e){p.log("handleVastAvailability",p.LogLevels.verbose),St(),bt(e),Qe()}function bt(e){g.when(k).then(function(){Qe(),te.canReportAvailable(v.size(e),$e(e))})}function St(){k&&"pending"===k.state()||(k=new g.Deferred)}var yt=function(){return Y.canInitCallToApi().then(function(){},function(){return p.log(o.errors.init[1001]+Y.getStatusMsg(),p.LogLevels.error),o.errors.init[1001]}).then(function(){return Y.publish("InitiatedAPICall",[$.extendCallbackParamsWithProductConfig(Q,{duringInit:!0})]),I++,c.Utils.decodeValues(i),u.BN===o.productType&&z.trackEvent(S.getInventory),X.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer)),p.FetchDirectService.fetchFeed(q.getDestination(d),i,o.timerLengths.serverResponseTimeoutInMilis)}).then(At).then(Dt,function(e,t){var n,i=new g.Deferred;switch(n=o.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?n=e.responseText:e.errorMessage&&""!==e.errorMessage&&(n=e.errorMessage);break;case"string":""!==e&&(n=e)}return Qe(),"timeout"===t?i.reject(o.errors.load.timeout):i.reject(n),i.promise()})},At=function(e){var t=new g.Deferred;if(c.Utils.isDefined(e.response)&&c.Utils.isDefined(e.response.errorCode)){Qe();var n=c.Utils.isDefined(e.response.errorMessage)&&e.response.errorMessage?e.response.errorMessage:o.errors.init[1003];t.reject(n)}else c.Utils.isDefined(e.seatbid)&&c.Utils.isDefined(e.seatbid.bid)&&c.Utils.isDefined(e.seatbid.ext)&&c.Utils.isDefined(e.seatbid.ext.labels)?t.resolve(e):(Qe(),t.reject(o.errors.init[1004]));return t.promise()};function Ct(e){if(e){var t={blacklistedCampaigns:e.join(",")};p.getTokenService().updateToken(t)}}var Dt=function(e){var r=function(e){return hn()&&(y.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(Ft),Ct(q.filteredListService.getFilteredListCampaigns()))),c.Utils.returnResolvedPromise()};return function(e){Y.setConnection(!0);var n=e.seatbid.bid,t=e.seatbid.ext;q.getAmountOfSupportedInventories()===u.DEFAULT_AMOUNT_OF_INVENTORIES&&(Et(),v.reset());var i=v.getAvailableInventoryId();return z.updateBaseData({landingId:t.landingId,strategyId:t.strategyId,adSource:t.adSource}),H=t.deliveryPlumbus,t.sessionPlumbus&&a.setData(o.productType+"sesp",t.sessionPlumbus),g.when(Oe(e),Te(t)).then(Fe.bind(null,y)).then(xe.bind(null,y)).then(Gt.bind(null,y)).then(p.CampaignsFilter.filterByAppInstalled.bind(null,n,y,o.filterDisableTypes)).then(r).then(function(e){for(var t=e&&e.length||0,n="",i=0;i<t;i++)n+=p.AdUtils.getAdType(e[i],y),i<t-1&&(n+=", ");return z.updateBaseData({feedSize:t,feedCampaignOrder:n}),c.Utils.returnResolvedPromise()}.bind(null,n)).then(function(e){return e.some(function(e){return p.OMIDService.isAdOmidSupported(e,o.productType)})&&p.OMIDService.downloadOmidJsBundle(),c.Utils.returnResolvedPromise()}.bind(null,n)).then(re.decidePrecacheStatus.bind(null,{numOfCampaigns:n.length,settings:y})).then(function(){return te.setAMSettings({preFetchAllVasts:y.preFetchAllVasts,isPreCache:re.isPrecache(),numOfBannersToInitSuccess:y.numOfBannersToInitSuccess,reportOnAdunitReady:y.reportOnAdunitReady}),n&&0<n.length?(D=!1,jt(),p.adUnitGlobals.updateAdUnitGlobals(!0,qt(),_,z)):c.Utils.returnRejectedPromise(u.errors.noFill)}).then(function(){return g.when(Qt(n)?p.libsManager.manageDownloadLibsFileByFiletype(o.libsCacheFiles.dapi):c.Utils.returnResolvedPromise(),(t=n,re.isPrecache()&&Jt(t)?p.libsManager.manageDownloadLibsFileByFiletype(o.libsCacheFiles.externalObfuscation).then(function(e){zt(t,e)}):c.Utils.returnResolvedPromise()));var t}).then(function(){return un()?re.handleCacheClear():c.Utils.returnResolvedPromise()}).then(je(n)).then(p.AdsAssetsManager.setAdAssetsForAds.bind(null,n)).then(Ue.bind(null,n)).then(p.AdsAssetsManager.setReferencesForAds.bind(null,n,Q.instanceUniqueId)).then(Ve.bind(null,n)).then(function(e,t,n){if(un())return c.Utils.returnResolvedPromise();var i,r=new g.Deferred,a=p.AdsAssetsManager.cacheAdsWithClearanceLogic(e,t.numOfBannersToCache,t.numOfBannersToInitSuccess,n,_t(t)).then(function(){clearTimeout(i),r.resolve()}).fail(function(e){clearTimeout(i),r.reject(e)});return i=setTimeout(function(){var e=a.state();if("pending"===e||"rejected"===e){var t={callfailreason:"ad level timeout expired when caching ads"};t=le.extendEventDataWithElapsedLoadTime(n.productType,n.demandSourceName,t),z.trackEvent(S.adLevelCachingTimeout,{},t),r.reject("cacheAdsAssets timeout expired")}"resolved"===e&&r.resolve()},o.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow),r.promise()}.bind(null,n,y,Q)).then(function(){if(D=!0,un())return Wt(),Ge(n,i);var e=v.setOffers(n.slice(0),i);0===y.numOfBannersToInitSuccess&&te.reportAdAvailable({numOfAdUnits:v.size(e),totalNumberCredits:$e(e)}),Je(e)}).fail(function(e){var t=e||"Fail parse adUnit info from api response";p.AdsAssetsManager.unsetReferencesForAds(n,Q.instanceUniqueId),v.removeInventory(i),u.BN===o.productType&&z.trackEvent(S.getInventoryFailed,{generalMessage:t}),Vt(),e&&p.log(e,p.LogLevels.error),te.inventoryEmpty(e||t),Mn()&&ke()}),(new g.Deferred).resolve(g.extend({},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)},It=function(){g.each(x,function(e,t){clearTimeout(t)}),x=[]};function wt(){Y.publish("Engaged",[$.extendCallbackParamsWithProductConfig(Q,{duringEngage:!0})])}function Pt(){var e;e={productType:o.productType,message:L&&L.noInternet?L.noInternet:u.labels.noInternet,yes:"close",alwaysClose:!0},p.alert(e)}var Tt=function(e,t,n){var i,r=p.AdUtils.getAdId(e);p.log("Error in loading ad - timeout in "+r,p.LogLevels.error),i=n?S.showAdFail:S.adLoadedError;var a={isprecache:re.isPrecache()};a=p.AdUtils.updateEventWithAdParams(y,e,a),z.trackEvent(i,{callfailreason:"Error in loading ad - timeout"},a),$.extendCallbackParamsWithProductConfig(Q,e),c.VastUtils.isVastCampaign(e)&&Ot(e),Xe(r,e.inventoryId),Nt(null),Se(),Z.removeIframe(ut(r)),y.viewType===u.viewTypes.externalView?p.removeAdUnitFromExternal(e):p.removeAdUnit(e)},Ot=function(e){e&&e.cid?p.blacklistService.addToBlacklistedCampaigns(Q.productType,Q.demandGroupName,e.cid):p.log("DemandSource | cannot add to blacklist with no ad",p.LogLevels.error)},Ft=function(e){e&&e.cid&&q.filteredListService.addToFilteredListCampaigns(e.cid)},xt=function(){var e={errMsg:void 0,didSucceed:!0};return c.Utils.isDefined(y.allowMultiInitCalls)&&!y.allowMultiInitCalls?(e.errMsg=o.errors.init.multi,e.didSucceed=!1):Y.allowExternalCallToApi()?h.shouldFail(p.getConfig())&&(e.errMsg=o.errors.init.deviceOsIsNotSupported,e.didSucceed=!1):(e.errMsg="Already attempting to initiate",e.didSucceed=!1),e},Lt=function(){P&&clearTimeout(P)},Nt=function(e){T=e},Ut=function(){return T},Vt=function(){Nt(null),Se(),te.reset(),m.reset()},Mt=function(){Et(),v.reset(),Y.publish("InitiatedTimeoutAttempt",[$.extendCallbackParamsWithProductConfig(Q,{duringAPITimeoutAttempts:!1})]),Vt()},Et=function(){for(var e=Object.keys(v.getInventories()),t=0;t<e.length;t++)p.AdsAssetsManager.unsetReferencesForAds(v.getOffers(e[t]),Q.instanceUniqueId)},kt=function(){var e=!1;if(Q.productType===u.BN&&v){var t=v.getActiveInventoryId();t&&(e=v.isNextOfferAvailable(t))}return e},Kt=function(){var e=v.getActiveInventoryId();if(e){var t=nt(e);v.removeOfferById(t.id,e),Je(e)}};function Bt(){p.DeviceDataService.shouldPullDataOnLoadAd()&&p.DeviceDataService.pullData()}function Rt(i,r){var e=function(e){if(!a){I=0,Y.publish("InitiatedTimeoutAttempt",[$.extendCallbackParamsWithProductConfig(Q,{duringAPITimeoutAttempts:!1})]),e=e||o.errors.init[1002],u.BN===o.productType&&(z.trackEvent(S.getInventoryFailed,{generalMessage:e}),de.resetExternalAdViewsIdentifiers());try{if("string"==typeof e){var t=parseInt(e);1001<t&&t<1006&&(e=o.errors.load.invalid)}}catch(e){}var n=$.extendCallbackParamsWithDemandConfig(Q,{errMsg:e});p.callSDKFunction(r,n),c.PubSub.publish(o.productType+".failedToLoad",[n]),Mn()&&ke()}};if(Bt(),Vt(),kt())Kt();else{var a=!1;(x.push(setTimeout(function(){e(o.errors.load.timeout),a=!0},7*o.timeUnit)),(new g.Deferred).resolve()).then(Lt).then(mn).then(yt).always(It).then(function(){a||(I=0,Y.publish("InitiatedTimeoutAttempt",[$.extendCallbackParamsWithProductConfig(Q,{duringAPITimeoutAttempts:!1})]),ae=!1)},function(e){var t=new g.Deferred,n=q.doesAllowConsecutiveGatewayRequestsDuringLoad();return a||(e===o.errors.load.timeout&&n&&I<o.maxNumOfAttemptsToCallAPI?(Y.publish("InitiatedTimeoutAttempt",[$.extendCallbackParamsWithProductConfig(Q,{duringAPITimeoutAttempts:!0})]),setTimeout(function(){Rt(i,r)},o.timerLengths.initAttemptsDelay),t.resolve()):t.reject(e)),t.promise()}).then(null,e)}}function jt(){_={productType:o.productType,demandSourceName:Q.demandSourceName,retryAttempts:y.adunitRetryAttempts||15,retryInterval:y.adunitRetryInterval||1,assetType:u.assetType.adunitAsset}}function Wt(){G={productType:o.productType,demandSourceName:Q.demandSourceName,retryAttempts:y.adAssetRetryAttempts,retryInterval:y.adAssetRetryInterval,assetType:u.assetType.adAsset}}function _t(e){return{adAssetRetryAttempts:e.adAssetRetryAttempts||5,adAssetRetryInterval:e.adAssetRetryInterval||1}}function Gt(e){e&&e.hasOwnProperty(u.numOfBannersToInitSuccess)&&e.hasOwnProperty(u.numOfBannersToCache)&&z.updateBaseData({cacheConfig:e[u.numOfBannersToInitSuccess]+"/"+e[u.numOfBannersToCache]})}function Ht(){return!hn()}function qt(){return y.purgeAdunitLibsFile}function Qt(e){for(var t=0;t<e.length;t++){var n=e[t].ext.layoutData;if(c.Utils.isDefined(n)&&c.Utils.isDefined(n.html)&&0<n.html.length)return!0}return!1}function Jt(e){for(var t=!1,n=0;n<e.length;n++)if(p.AdUtils.isPlayablePrecachedAd(e[n])){t=!0;break}return t}function zt(e,t){for(var n=0;n<e.length;n++)p.AdUtils.isPlayablePrecachedAd(e[n])&&(e[n].ext.ableToCache="success"===t)}function Xt(e){var t=y.numOfBannersToCache,n=et(e).slice(0,t),i=!0;return g.each(n,function(e,t){return!p.AdUtils.isCacheableAd(t)||Re(t)||re.isAdInCache(p.AdUtils.getAdId(t))||re.getAdStatusInQueue(p.AdUtils.getAdId(t))===re.cachingStatus.pending||(i=!1),i}),i}function $t(e){var t=re.isPrecache();t&&!un()?p.AdsAssetsManager.cacheAssetsOfAd(v.getActiveInventory().getCurrentOffer(),Q,_t(y)).then(Je.bind(null,e.inventoryId)):t&&!Xt(e.inventoryId)?re.updateCache(G):O&&c.VastUtils.isVastCanPlayAgain(e)&&re.cacheSingleAd(p.AdUtils.formatVastAdForPrecache(e,We.bind(null,e)),G)}function Yt(e,t){if(p.log("engageEnd",p.LogLevels.verbose),$.shouldReceiveMessage(Q,e))if(e.productType!==u.BN){en(e);var n=tn;Zt(Y)?e.engaged?n.handlePrefetchFailedOnVisible(e):n.handlePrefetchFailedOnBackground(e):e.engaged?n.handleAdClosed(e):n.handlePrefetchFailedOnBackground(e),(c.Utils.isFunction(t)?t:function(){})()}else lt(e)}function Zt(e){p.log("getAndResetErrorStateFromTaskManager",p.LogLevels.verbose);var t=e.getStatus().adErrorState;return e.publish("AdErrorState",[$.extendCallbackParamsWithProductConfig(Q,{error:!1})]),t}function en(e){p.log("_resetPreloadedAd",p.LogLevels.verbose),dt(e),z.resetBaseData(u.baseDataKeys),m.setCanPreloadFlag(!0)}var tn={handleCappingOnAdClosed:function(e){p.log("_handleCappingOnAdClosed | ManuelLoad",p.LogLevels.verbose),this.publishNoMoreOffers(u.noMoreOffersReason.noMoreOffersToShowInFeed),ke(e)},handlePrefetchFailedOnBackground:function(e){p.log("_backgroundPrefetchFailed | ManualLoad",p.LogLevels.verbose),s.getNextAd(!1,e.inventoryId,!0)?$t(e):this.publishNoMoreOffers(u.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){p.log("handlePrefetchFailedOnVisible | manuel load",p.LogLevels.verbose),$t(e)},shouldPerformInternalLoad:function(){var e=o.overrideFeedSettings.isSupportFetchFeedOnAdCloseLogic&&o.overrideFeedSettings.shouldFetchNewFeedOnAdClose;return c.Utils.isDefined(y.shouldFetchNewFeedOnAdClose)?y.shouldFetchNewFeedOnAdClose:e},handleAdClosed:function(e){if(p.log("handleAdClosed | manuel load",p.LogLevels.verbose),Un())this.handleCappingOnAdClosed(e);else{if(hn())return p.log("handleAdClosed | manuel load | isInAppBiddingInstance=true"),p.AdsAssetsManager.unsetReferencesForAds(v.getOffers(e.inventoryId),Q.instanceUniqueId),void v.removeInventory(e.inventoryId);if(this.shouldPerformInternalLoad())return p.AdsAssetsManager.unsetReferencesForAds(v.getOffers(e.inventoryId),Q.instanceUniqueId),v.removeInventory(e.inventoryId),void we();p.log("handleAdClosed | manuel load | Do not perform internal load."),Vt(),Et(),v.reset(),c.PubSub.publish(o.productType+".resetStateManager",[Q])}},publishNoMoreOffers:function(e){p.log("publishNoMoreOffers | ManualLoad",p.LogLevels.verbose);var t=$.extendCallbackParamsWithDemandConfig(Q,{errorMsg:e||u.noMoreOffersReason.noMoreOffersToShowInFeed});c.PubSub.publish(o.productType+".NoMoreOffers",[t])}};function nn(e){if($.shouldReceiveMessage(Q,e)){var t=p.AdUtils.getAdId(e),n=Ye(t,e.inventoryId);p.log("ProductInstance | adVisible | id="+t),Y.publish("Engaged",[$.extendCallbackParamsWithParentProductConfig({duringEngage:!0})]),p.SKAdImpressionService.startImpression(n,Fn,xn);n.displayMode;if(c.VastUtils.isVastCampaign(n)){var i=c.VastUtils.getVastViewCount(n);z.trackTimingStop(S.adVisible,{vastViewCount:c.VastUtils.getVastViewCountForEvent(i),eNameStart:S.showAdCalled}),p.log("ProductInstance | send event adVisible"),c.VastUtils.isVastCanPlayAgain(n)||Xe(t,e.inventoryId)}else z.trackTimingStop(S.adVisible,{eNameStart:S.showAdCalled}),p.log("ProductInstance | send event adVisible"),Xe(t,e.inventoryId);oe++,z.trackTimingStart(S.adVisibleToClose),y.extraOffersInEndCard&&p.ExtraOffers.isSupported(p.getConfig().mobileSDKSettings.deviceOs,p.getConfig().mobileSDKSettings.deviceApiLevel,n,y)&&rn()}}function rn(){g.when(mn()).then(function(e){var t=p.getCurrentDisplayedAd();return p.ExtraOffers.fetchExtraOffersInventory(e,t.productType,t.cid,t.settings.requestID,t.ext.opportunityID)}).then(function(e){p.postAdUnitEvent(JSON.stringify({name:"extraOffersEndCardData",data:{inventory:e}}))}).fail(function(e){p.postAdUnitEvent(JSON.stringify({name:"cancelExtraOffersEndCard"}));var t=e&&"string"==typeof e?e:"Extra offers flow failed";p.log("onExtraOffersFetchFail | Reason: "+t),z.trackEvent(S.getExtraOffersInventoryFailed,{callfailreason:t})})}function an(e,t){return new(Kn("../../components/precacheManager.js"))(e,t,on())}function on(){var e=un()?Q.productType+"_"+Q.demandSourceName:u.cacheAdsDirectory;return A.cacheBase=e,A.precachePath="../"+A.cacheBase+"/",g.extend(A,Q),A}function sn(){var e=p.getSDKDataByKey(u.cacheConfiguration);if(e){var t=e&&e.adLevelCacheTimeout?1e4*e.adLevelCacheTimeout:u.defaultTimeoutForCachingAds;o.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow=t}}function dn(e){return Q[e]}function ln(e){e&&e.demandSourceName===d&&mn()}function cn(e,t){var n;if(p.log("in load ad with params: "+JSON.stringify(e),p.LogLevels.verbose),!e||e.demandSourceName!==d)return n=le.extendEventDataWithElapsedLoadTime(o.productType,d,{}),z.trackEvent(S.loadAdIgnored,{callFailReason:o.errors.general.dsNameNotValid},n),void le.clearLoadStartTimeForInstance(o.productType,d);var i=xt();if(i.errMsg){var r=S.loadAdFailed;return n=le.extendEventDataWithElapsedLoadTime(o.productType,d,{}),z.trackEvent(r,{callFailReason:i.errMsg,demandSourceName:d},n),le.clearLoadStartTimeForInstance(o.productType,d),void p.callSDKFunction(t,$.extendCallbackParamsWithDemandConfig(Q,{errMsg:i.errMsg}))}p.unloadAdViewsByProduct(Q),p.log("resetting last response to none",p.LogLevels.verbose),Rt(e,t)}function un(){for(var e=q.getDestination(d),t=[u.gatewayDestinationMap.IS.production,u.gatewayDestinationMap.BN.production,u.gatewayDestinationMap.RV.production],n=0;n<t.length;n++)if(-1!==e.indexOf(t[n]))return!1;return!0}function fn(e,t,n){var i=nt(v.getActiveInventoryId());p.RingerSwitchService.isInitiated()&&i&&(p.RingerSwitchService.startListener(gn(i.ext)),p.log("Ringer | startListener from DS.",p.LogLevels.info)),bn(),s.preload(!0,v.getActiveInventoryId()).then(function(){return s.show(Ut())}).then(function(){pn(t)}).fail(function(e){p.log("Cannot engage at this time "+Y.getStatusMsg(),p.LogLevels.error),vn(n,e)})}function gn(e){return e?{ringerUpdateDelay:y.ringerUpdateDelay,shouldSetRingerUpdateDelay:p.AdUtils.isPlayableCampaign(e)||p.AdUtils.isMRAIDCampaign(e)||p.AdUtils.isExternalCampaign(e)}:{}}function pn(e){z.trackTimingStop(S.showAdSuccess,{eNameStart:S.showAdCalled}),p.callSDKFunction(e,$.extendCallbackParamsWithDemandConfig(Q)),J.onShowSuccess(Q)}function vn(e,t){var n=$.extendCallbackParamsWithDemandConfig(Q,{errMsg:t});c.PubSub.publish(o.productType+".failedToShow",[n]);var i=t;i!==u.errors.showAdFailedReasons.preloadNoAd&&i!==u.errors.showAdFailedReasons.showNoAd&&(i=i+". "+Y.getStatusMsg()),z.trackEvent(S.showAdFail,{callFailReason:i}),p.callSDKFunction(e,$.extendCallbackParamsWithDemandConfig(Q,{errMsg:t}))}function mn(){var e={impressionsCount:oe-1,firstAttemptToGetFeed:ae,retryCounter:I,deliveryPlumbus:H,sesp:a.getData(o.productType+"sesp")};return ne.createPayload(e).then(function(e){return i=e})}function hn(){return e&&e.isInAppBidding}function bn(){j=new g.Deferred;var t=c.PubSub.subscribe(R+".getDemandSourceStateSuccess",function(e){$.shouldReceiveMessage(Q,e)&&(c.PubSub.unsubscribe(t),c.PubSub.unsubscribe(n),"resolved"!==j.state()&&(W=e&&e.state||W,j.resolve(e)))}),n=c.PubSub.subscribe(R+".getDemandSourceStateFail",function(e){$.shouldReceiveMessage(Q,e)&&(c.PubSub.unsubscribe(n),c.PubSub.unsubscribe(t),"resolved"!==j.state()&&j.resolve())}),e=$.extendCallbackParamsWithParentProductConfig(Q);p.callSDKFunction("getDemandSourceState",e,"getDemandSourceStateSuccess","getDemandSourceStateFail")}function Sn(){return U&&U.confirmCloseMsg[u.confirmCloseMsgMap[0]]}function yn(e,t){var n=p.getContainerCreationHandler(e),i=n.getState();i===n.getCreationStates().createdSuccessfully?(p.log("product instance | containerState | createdSuccessfully ",p.LogLevels.info),t.resolve(e)):i===n.getCreationStates().duringCreation?g.when(n.getCreationResultPromise()).then(function(){p.log("product instance | during creation result: success",p.LogLevels.info),t.resolve(e)}).fail(function(e){t.reject("product instance | "+e)}):t.reject("product instance | did not start to create native webview")}function An(e){var t=p.AdUtils.getAdId(e),n=A.precachePath+t+"/";c.AdAssets.updateAdunitPrecachePath(e,n,p.AdUtils.isPlayablePrecachedAd(e))}function Cn(e,t,n){var i=!1;return e&&!t&&(p.AdUtils.isPlayablePrecachedAd(n)?c.AdAssets.isAdAbleToCache(n)&&(i=!0):c.VastUtils.isVastCampaign(n)&&!Re(n)||(i=!0)),i}function Dn(e){se=e}function In(){return se}function wn(e,t,n){var i=o.timerLengths.loadAdTimeout;clearTimeout(F),F=setTimeout(function(){Tt(e,t,n)},i)}function Pn(e){!O&&c.VastUtils.isVastCampaign(e)&&(null!==K||c.Utils.isDefined(e.toRemove)&&e.toRemove||ft(e).then(null,ye.bind(null,e)))}function Tn(r,a,o,s){de.checkStatusOfAdView().then(function(e){var t=nt(s);p.AdUtils.setViewType(r,t,u.viewTypes.externalView);var n=p.AdUtils.updateEventWithAdParams(r,t,{});z.updateBaseData(n),Nt(t),o.shouldBuildAdUnitUrlForExternal=!0;var i=f.getAdunitUrl(!1,a,o,p.getDeviceOs());e.isExternalAdViewInitiated?(ve(t),de.updateAdInAdView(i,t,a,r)):(wn(t,i,!1),g.extend(r,{adViewId:de.getContainerID()}),de.createAdUrlInAdView(i,t,a,r)),p.addAdToLoadedCreatives(t)})}function On(){return e.shouldAvoidHandleFrameClose}function Fn(){z.trackEvent(S.startImpressionSuccess)}function xn(e){z.trackEvent(S.startImpressionFailed,{},{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function Ln(){z.trackEvent(S.endImpressionSuccess)}function Nn(e){z.trackEvent(S.endImpressionFailed,{},{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function Un(){var e=W===u.demandSourceStates.cappedPerSession;return e&&c.Utils.isDefined(Q)&&p.log("isDemandCapped | demandSource "+Q.demandSourceName+" is capped"),e}function Vn(){return!1===y.isExhaustInstanceAllowed}function Mn(){return o.isExhaustInstanceAllowed&&Q.demandType===u.demandSourceType.instance&&!Vn()}function En(){hn()&&o&&(o.isExhaustInstanceAllowed=!1)}var kn={name:d,init:function(){s=this,n||(Vt(),re=an(c,p),ce(),ue(),sn(),re.init(),Y.init(),p.initEventics($.extendCallbackParamsWithParentProductConfig(Q,{})),En(),n=!0)},isNextAvailable:function(e){if(re.isPrecache()){var t=et(e);return re.isNextAvailable(t)||t&&t[0]&&!t[0].isCacheable}return v.isNextOfferAvailable(e)||c.VastUtils.isVastCanPlayAgain(nt(e))},prepareAdToEngageEnd:function(e){return Re(e)?re.deleteCachedCampaign(p.AdUtils.getAdId(e)):c.Utils.returnResolvedPromise()},getNextAd:function(e,t,n){var i=s.isNextAvailable(t);return re.isPrecache()&&!i&&(i=it(n||e,t)),i},attemptToPreloadAd:function(e,t){var n=Un();if(!n||e){var i=et(t),r=nt(t),a=pt(c.VastUtils.isVastCampaign(r))||c.VastUtils.areAllCampaignTypesAreVast(i),o=re.isPrecache();gt(c.VastUtils.isVastCampaign(r),t)&&ht(t),m.canPreloadCandidateAd(n,e,r,a,o,y.displayOnAdReady)&&s.preloadAd(e,t)}else p.log("Skipping preload on capped demand",p.LogLevels.verbose)},preloadAd:function(e,t){s.preload(e,t).then(function(){e&&s.show(Ut())})},preload:function(e,t){var n,i=new g.Deferred;return Y.canPreload()?(n=Ut()||nt(t))||(n=it(e,t),rt(n,C.softprecache),n)?(g.extend(!0,n,Q),p.isContainerLoaded(n)?i.resolve(n):s.preloadFlow(n,e,i),i.promise()):(p.log("Cannot preload with no offer",p.LogLevels.error),c.Utils.returnRejectedPromise(u.errors.showAdFailedReasons.preloadNoAd)):(p.log("Cannot preload at this time, "+Y.getStatusMsg(),p.LogLevels.error),c.Utils.returnRejectedPromise(u.errors.showAdFailedReasons.taskManagerPreload))},preloadFlow:function(e,t,n){p.log("ProductInstance | preloadFlow"),m.preloadAdFinished();var i,r=!1,a=re.isPrecache(),o={preload:!t};e.displayMode==C.softprecache&&(r=!0),Cn(a,r,e)&&An(e),e.isWPAD=ie.shouldDisplayAdOnExternalWebView(e,y),i=e.isWPAD?(p.AdUtils.setViewType(y,e,u.viewTypes.externalView),N.shouldBuildAdUnitUrlForExternal=!0,2):(p.log("ProductInstance | ad is not WPAD"),p.AdUtils.removeViewTypeFromSetting(y),N.shouldBuildAdUnitUrlForExternal=!1,1),e.displayStrategy=i;var s=p.AdUtils.updateEventWithAdParams(y,e,{});g.extend(s,{displaystrategy:i}),z.updateBaseData(s),Nt(e);var d=!r&&a,l=f.getAdunitUrl(d,Q,N,p.getDeviceOs());wn(e,l,t),g.extend(y,o),p.AdUtils.setViewType(y,e),b.shouldShowInStandAloneView(p.getConfig())&&p.AdUtils.extendSettingsWithStandaloneViewSupport(y),e=p.StoreKitService.updateAdWithStoreAppId(e,y),p.loadAdUnitUrl(e,l,Q,y),Pn(e),e.isWPAD?yn(e,n):n.resolve()},show:function(e){return e?Y.canEngage()?(wt(),p.displayAdView(e),c.Utils.returnResolvedPromise()):c.Utils.returnRejectedPromise(u.errors.showAdFailedReasons.taskManagerEngage):c.Utils.returnRejectedPromise(u.errors.showAdFailedReasons.showNoAd)},getConfirmCloseMsg:Sn,getDSEventics:pe,adVisible:nn,engageEnd:Yt,initProduct:ln,loadAd:cn,updateEventicsWithAdData:Ce,showAd:fn,onShowAdFailed:vn,getProperty:dn,isInAppBiddingInstance:hn,isDemandCapped:Un,shouldAvoidHandleFrameClose:On,reset:Mt};return s=kn,kn}e.exports=n},{"../../components/OMIDConstants":41,"../../components/VastService.js":63,"../../components/containers/WPADUtils":76,"../../components/precacheManager.js":81,"../../patches/PatchIOSLoadAfterLoad.js":167,"../../patches/PublisherPatchEasybrain.js":170,"./../../components/AdFeaturesParser":2,"./../../components/MultipleInventories.js":35,"./../../components/sdkPluginType/SDKPluginTypeHandler.js":84,"./../RewardedVideo/availabilityManager.js":138,"./../RewardedVideo/availabilityReporter.js":139,"./../RewardedVideo/dsTaskManager.js":140,"./DemandEntityBuilder.js":114,"./FetchDemand/FetcherPatch.js":118,"./PayloadBuilder.js":119,"./PreloadAdManager":121}],123:[function(e,t,n){t.exports=function(e,t){var n,i=(e=e||{}).retriesLogic||{},r=e.Features||{},a=e.ProductName;return{initiated:!1,overrideFeedSettings:r,productType:a,errors:{init:{missingData:"Failed to get required parameters",multi:"Multiple Init calls not allowed",1001:"Trying to call API while during an un-finished process",1002:"1002",1003:"1003",1004:"Invalid API response",1005:"1005",deviceOsIsNotSupported:"Device OS is not Supported"},load:{noMoreOffers:"Failed to load "+a+" ad",duringLoad:"Load "+a+" is already in progress",duringShow:"Can not Load "+a+" when showing ad",timeout:"API request timeout",invalid:"Invalid API response",instanceExhausted:"Instance already exhausted",inStateVisibleOrInShowingProcess:"in state visible or inShowingProcess",inLoadingStateOrWaitingToLoad:"in state waitingToLoad or internalLoadingProcess",instanceOnHold:"Instance on Hold"},show:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",notLoaded:"ad was not loaded, try to load before calling to show",duringLoad:a+" load is in progress",visible:a+" is already showing",tryingToEngage:a+" is in showing process",instanceExhausted:"Can not show - Instance already exhausted"},vast:{noOffers:"empty"},general:{dsNotSet:"trying to call demandSource function, but demandSource object is not set",dsNameNotValid:"demand source name is not valid"}},displayMode:{nonprecache:"nonprecache",precache:"precache",softprecache:"softprecache"},libsCacheFiles:{dapi:"dapi",externalObfuscation:"externalObfuscation"},responseTypesWithReason:{none:0,ready:1,notReady:2},precacheConfig:{maxCachedCampaigns:10,nonPrecacheFallback:3e5,cacheBase:null,precachePath:null,timeoutForCachingAdsInAdLevelCacheFlow:3e4},timeUnit:6e4,timerLengths:{initAttemptsDelay:i.initAttemptsDelay||500,serverResponseTimeoutInMilis:i.serverResponseTimeoutInMilis,riDelay:12e4,loadAdTimeout:16e3},customDialog:4,filterDisableTypes:[],maxNumOfAttemptsToCallAPI:i.maxNumOfAttemptsToCallAPI||2,eventicsCategories:t,isExhaustInstanceAllowed:(n=r,void 0!==n.isExhaustInstanceAllowed&&n.isExhaustInstanceAllowed),shouldDisplayOnAdReady:!!r.displayOnAdReady,forcePreload:e.forcePreload}}},{}],124:[function(n,e,t){e.exports=function(e){var t={prod:n("./EnvironmentProduction"),staging:n("./EnvironmentStaging")};return t[e.environment]?new t[e.environment](e,n("./constants")):new t.staging(e,n("./constants"))}},{"./EnvironmentProduction":125,"./EnvironmentStaging":126,"./constants":127}],125:[function(e,t,n){t.exports=function(e,t){var n,i,r=t.fileExtension,a=t.controllerFolder,o=t.cacheRootFolder,s=t.jQueryFileName,d=e.controllerVersion,l=e.schema,c=e.cdnDomain,u=e.scdnDomain,f=e.environment,g=o[e.deviceOs],p=e.cdnService,v=e.domain;function m(){return l+"//"+c+"/mobileSDKController"}function h(){return g}return{getControllerHost:m,getControllerJsUrl:function(){return m()+"/versions/"+d+"/sdk_controller"+r+".js"},getJQueryUrls:function(){return[l+"//code.jquery.com/"+s,l+"//"+c+"/libs/"+s]},getConfig:function(){return{controllerVersion:d,schema:l,cdnDomain:c,environment:f,cacheRootFolder:g,serviceCdn:p,domain:v}},getCacheControllerJsUrl:function(){return h()+"/"+a+d+"/sdk_controller"+r+".js"},getCacheJQueryPath:function(){return h()+"/assets/"+s},getAppConfigDomain:function(){return l+"//"+p},getMicroJobUrl:function(){return l+"//"+c+"/users/microjob/sdkconfig.json"},getUrlToCdnAdUnit:function(){return n.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+u},setController:function(e){n=e},getStaticGlobalsUrl:function(e){return l+"//"+u+"/adunit/dist/versions/"+e+"/prod/"},getAssetsJsonUrl:function(){return l+"//"+u+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return l+"//"+p+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){i=e},getBaseServerUrlForOfferwall:function(){return i?l+"//"+i:""},getCacheRootFolder:h,getExternalLibrariesUrl:function(){return m()+"/libs/"},getCacheLibsPath:function(){return h()+"/libs/"}}}},{}],126:[function(e,t,n){t.exports=function(e,t){t.fileExtension;var n=t.controllerFolder,i=t.cacheRootFolder,r=t.jQueryFileName,a=e.controllerVersion,o=e.schema,s=e.cdnDomain,d=(e.scdnDomain,e.environment),l=e.stagingCdnDomain,c=i[e.deviceOs],u=e.cdnService,f=e.domain;function g(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e}function p(){return c}return{getControllerHost:g,getControllerJsUrl:function(){return g()+"/controller/"+a+"/sdk_controller.js"},getJQueryUrls:function(){return[o+"//code.jquery.com/"+r,o+"//"+s+"/libs/"+r]},getConfig:function(){return{controllerVersion:a,schema:o,cdnDomain:s,environment:d,cacheRootFolder:c,stagingCdnDomain:l,domain:f}},getCacheControllerJsUrl:function(){return e=a,p()+"/"+n+e+"/sdk_controller.js";var e},getCacheJQueryPath:function(){return p()+"/assets/"+r},getAppConfigDomain:function(){return o+"//"+u},getMicroJobUrl:function(){return o+"//"+s+"/users/microjob/sdkconfig_staging.json"},getUrlToCdnAdUnit:function(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e},setController:function(e){},getStaticGlobalsUrl:function(e){var t=l.split(".")[0];return o+"//"+l+"/users/staging/"+t+"/adunit/dist/versions/"+e+"/stage/"},getAssetsJsonUrl:function(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return o+"//"+u+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){},getBaseServerUrlForOfferwall:function(){return""},getCacheRootFolder:p,getExternalLibrariesUrl:function(){return g()+"/common/libs/"},getCacheLibsPath:function(){return p()+"/libs/"}}}},{}],127:[function(e,t,n){t.exports={fileExtension:".min.gz",controllerFolder:"controller_",cacheRootFolder:{ios:"../SSAPublisher",android:"../supersonicads"},jQueryFileName:"jquery-1.9.1.min.js"}},{}],128:[function(e,t,n){t.exports=function(e,t,n){var i=t.shouldFetchNewFeedOnAdCloseFlag(n.IS);return i=void 0===i||i,{NativeAPI:e.NativeAPI,ControllerCallbacks:e.ControllerCallbacks,AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,retriesLogic:e.retriesLogic,DemandName:"InterstitialDS",ProductName:n.IS,Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,shouldFetchNewFeedOnAdClose:i,isSupportFetchFeedOnAdCloseLogic:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0,isExhaustInstanceAllowed:!1},gatewayDestinationMap:{prod:n.gatewayDestinationMap.IS.production},amountOfInventories:1,lwsSupported:!1}}},{}],129:[function(e,t,n){t.exports=function(){var i=[];function r(e){return-1!==i.indexOf(e)}return{removeAll:function(e,t){if(!r(t)){for(var n=0;n<i.length;n++)e[i[n]].clearListeners(),delete e[i[n]];i=[]}},add:function(e){r(e)||i.push(e)},clear:function(e){var t=i.indexOf(e);-1!==t&&i.splice(t,1)}}}},{}],130:[function(e,t,n){t.exports=function(){return{showOWCalled:{name:"showOWCalled",id:16},showOWFail:{name:"showOWFail",id:17},owVisible:{name:"owVisible",id:18},inventoryGetToReceived:{name:"inventoryGetToReceived",id:-12},initControllerToShowOWCalled:{name:"initControllerToShowOWCalled",id:-13},showOWCalledToOwVisible:{name:"showOWCalledToOwVisible",id:-14},adVisibleToClose:{name:"adVisibleToClose",id:-5},initOW:{name:"initOW",id:13},initOWFail:{name:"initOWFail",id:14},initOWSuccess:{name:"initOWSuccess",id:127},staticAssetsLoaded:{name:"staticAssetsLoaded",id:126},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159}}}},{}],131:[function(Et,e,t){function n(d,s){"use strict";var i=Et("../../components/Constants.js"),r,a=!1,t=6e4,l="https://guc-api.sonic-us.supersonicads.com/api/v1/guc.php?format=json",n="https://guc-api.sonic-us.supersonicads.com/api/v1/myOffers",o="openRTB",c=i.OW,u="TaskManager",f=i.CB,g=window.jQuery,e,p={},v,m={},h={},b={productType:c},S=i.confirmCloseMsgMap,y={missingData:"Failed to get required parameters",invalid:"Invalid API response",appInfo:"Failed to retrieve application info",timeout:"API request timeout",server:"Server error",engaged:"Already engaged with OfferWall product",adunitAssetsTimeout:"Timeout in loading ad unit static assets",closeBeforeVisible:"User closed before ad loaded",missingDeviceIds:"Missing deviceIds",preconditions:"Failed to initiated OW, preconditions did not pass"},A={adunit:"adunit",inventory:"inventory",inventoryInBackground:"inventoryInBackground",preConditions:"preConditions",close:"close"},C={v:1,controllerId:1,applicationKey:0,applicationUserId:0,debug:0,language:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:1,timezoneOffset:1,itemSignature:0,disableCache:0,showDeliveryLimitationsLog:0,disableSession:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserGender:0,applicationUserAgeGroup:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,att:0,"deviceIds[OpenUDID]":0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,pageSize:0,page:0,landingId:0,customParams:0,admin:0,useClientSideCallbacks:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,appVersion:0,batteryLevel:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,moatSupported:0,mediationType:0},D={settings:{},textData:{},offers:[]},I={SDKVersion:1},w={id:0,url:""},P={openAppStoreSheet:!0,preload:!1},T={osNotSupported:"Sorry, your operating system version is not supported.",dialogErrorMessage:"Sorry, we were unable to display the wall at the moment. Please try again later.",noOffers:"Sorry, we currently have no offers to display. Please try again later.",noInternet:"No internet connection. Please connect and try again."},O={initOWSuccess:null,initOWFailure:null},F=0,x,L={},N,U,V,M,E,k=!1,K=!1,B=null,R=null,j=s.adUnitGlobals,W="#/?productType="+c+"&mode=msdkctrl",_=null,G=null,H=null,q=null,Q=null,J=!1,z=null,X,$={adUnitAssetsTimeout:6e4,pollAPITimeout:1e4},Y={offers:[],settings:{},textData:{noOffers:T.noOffers},ext:{emptyOWReason:"default empty OW reason"}},Z={},ee=Et("./OWEventCategories.js")(),te,ne,ie,re,ae=(oe=!1,se=!1,de=!1,le=!0,ce=!1,{init:function(){oe||(d.PubSub.subscribe(u+".Engaged",function(e){d.Utils.isDefined(e.duringEngage)&&(se=e.duringEngage)}),d.PubSub.subscribe(f+".enterBackground",function(){de=!0}),d.PubSub.subscribe(f+".enterForeground",function(e){de=!1,!pe()||e&&d.Utils.isDefined(e.active)&&!e.active||(s.log("poll on CPI offer closed/external browser offer closed (iOS flow)"),K=!1,Ae())}),d.PubSub.subscribe(f+".viewableChange",function(e){e&&d.Utils.isDefined(e.isViewable)&&(!ce||!e.isViewable||d.Utils.isDefined(e.webview)&&"main"!==e.webview||(ce=!1,s.postAdUnitEvent({name:"OfferClosed"})),pe()&&e.isViewable&&d.Utils.isDefined(e.webview)&&"main"===e.webview&&(s.log("poll on CPI offer closed/external browser offer closed (Android flow)"),K=!1,Ae()))}),d.PubSub.subscribe(f+".deviceStatusChanged",function(e){d.Utils.isDefined(e.connectionType)&&(le="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),oe=!0)},canEngage:function(){if(se||!le)return!1;var e=s.getCurrentDisplayedAd();return!e||e.productType===i.BN},isConnected:function(){return le},setConnection:function(e){le=e},setAdOpened:function(e){ce=e},getStatusMsg:function(){return" duringEngage:"+se+" appInBackground:"+de+" isConnected:"+le},getStatus:function(){return{duringEngage:se,appInBackground:de,isConnected:le,isAdOpened:ce}},duringEngage:function(){return se},publish:function(e,t){d.PubSub.publish(u+"."+e,t)},waitUntilAppInForeground:function(){var e=g.Deferred();return de?(s.log("OfferWall | Waiting for app to be in foreground"),d.PubSub.subscribeOnce(f+".enterForeground",function(){e.resolve()})):e.resolve(),e.promise()},waitUntilConnected:function(){var t=g.Deferred();if(le)t.resolve();else{s.log("OfferWall | waiting for internet connection");var n=d.PubSub.subscribe(f+".deviceStatusChanged",function(e){d.Utils.isDefined(e.connectionType)&&(le="none"!==e.connectionType&&"notReachable"!==e.connectionType)&&(d.PubSub.unsubscribe(n),t.resolve())})}return t.promise()}}),oe,se,de,le,ce,ue=function(){d.PubSub.subscribe(c+".ActionClick",function(e){s.OpenURLService.openForOW(e)||s.log(c+" failed to perform ActionClick")}),d.PubSub.subscribe("SDKController.AdClosed",function(e){e.productType===c&&ae.getStatus().isAdOpened&&s.isIOS()&&(s.postAdUnitEvent({name:"OfferClosed"}),ae.setAdOpened(!1),pe()&&(s.log("OfferWall | poll on ad closed"),Ae()))}),d.PubSub.subscribe("SDKController.AdOpened",function(e){e.productType===c&&(ae.setAdOpened(!0),k&&he(e.bannerId,!0))}),d.PubSub.subscribe("SDKController.engageEnd",function(e,t){e.productType===c&&(s.callSDKFunction("removeCloseEventHandler"),k&&(s.log("OfferWall | poll on engageEnd(ad closed)"),Ae()),ae.publish("Engaged",[{duringEngage:!1,productType:c}]),ne.unsetParamFromBaseData("landingId"),d.Utils.isFunction(t)&&t.call(),J&&"pending"===G.state()&&Ve("User closed before visible"),_&&_.always(function(){_=null;Le(!0)}))}),d.PubSub.subscribe("SDKController.adLoaded",function(e){e.adType===c&&(s.log("OfferWall | received ad loaded event"),s.onAdLoaded(w))}),d.PubSub.subscribe("SDKController.AdVisible",function(e){e.productType===c&&(s.log("OfferWall | ad visible"),ne.trackTimingStop(ee.owVisible,{eNameStart:ee.showOWCalledToOwVisible}),ne.trackTimingStart(ee.adVisibleToClose))}),d.PubSub.subscribe("SDKController.Analytics",function(e){if(e.productType===c&&e&&e.action){var t=e.action,n=e.eventParam;"fireEvent"===t?ne.trackEvent(n.eName,n.label,n.data):"startTiming"===t?ne.trackTimingStart(n.eName,n.data):"stopTiming"===t?ne.trackTimingStop(n.eName,n.data):"setCustomData"===t?ne.updateBaseData(n.data):"unsetCustomData"===t&&(n&&n.data&&"bannerId"===n.data?ne.resetBaseData(i.baseDataKeys):ne.unsetParamFromBaseData(n.data))}}),d.PubSub.subscribe(f+".initOfferWall",function(e,t,n){s.log("OfferWall | CB.init called"),Se(),ne.trackEvent(ee.initOW),s.getApplicationInfo(b).then(bt,function(e){s.callSDKFunction(n,{errMsg:e||y.appInfo})}).then(function(){return ne.trackEvent(ee.initOWSuccess),s.callSDKFunction(t),d.Utils.returnResolvedPromise()},function(e){return ne.trackEvent(ee.initOWFail,{callFailReason:e}),s.callSDKFunction(n,{errMsg:e}),d.Utils.returnResolvedPromise()}).then(Oe).then(function(){k&&Ae()})}),d.PubSub.subscribe(f+".showOfferWall",function(e,t,n){e&&s.AppOrientationManager.updateAppOrientationByNewRestriction(e.orientationRestriction),r.showOfferWall().then(function(){s.callSDKFunction(t,{placementId:nt()})},function(e){s.callSDKFunction(n,{errMsg:e})}).always(function(){Dt(Ct())&&(_=null)})}),d.PubSub.subscribe(f+".getUserCredits",function(e,t,n){if(s.checkRequiredCallbackParams(["applicationKey","applicationUserId","productType"],e,"getOfferWallCredits",n).didSucceed&&e.productType===c){if(d.Utils.decodeValues(e),Tt(e)&&ae.duringEngage()){var i="Could not provide credits, user provided is different from current user";return s.callSDKFunction(n,{errMsg:i}),void s.log(i,s.LogLevels.error)}Oe(!0,e).then(function(){Ae(e,n)},function(e){s.log(e,s.LogLevels.error),s.callSDKFunction(n,{errMsg:"Failed to initiate client side callbacks"})})}}),d.PubSub.subscribe("SDKController.OWOfferClicked",function(e){s.getCurrentDisplayedAdType()===c&&ve(e)}),d.PubSub.subscribe("SDKController.videoOfferClosed",function(){s.RingerSwitchService.isInitiated()&&(s.RingerSwitchService.stopListener(),s.log("OfferWall | Ringer | stop detecting ringer status changes from OW videoOfferClosed event")),pe()&&(K=!1,Ae())}),d.PubSub.subscribe("SDKController.dialogBoxResume",function(e){ge(e)&&ne.trackEvent(ee.dialogBoxResume)}),d.PubSub.subscribe("SDKController.dialogBoxExit",function(e){ge(e)&&ne.trackEvent(ee.dialogBoxExit)}),d.PubSub.subscribe(c+".GetCompletionOffers",function(e){if(d.Utils.isDefined(e.productType)){var t=je();re.getInventory(t.data,n,"json").then(fe.bind(null,e),fe.bind(null,e))}}),d.PubSub.subscribe("SDKController.OWPopupOfferOpened",function(e){te||(te=window.timerService.startTimer())})};function fe(e,t){re.isValidResponseStructure(t)&&(t=ot(t)),e&&e.callback&&e.callback.call(null,t)}function ge(e){return e&&e.productType===b.productType}function pe(){return k&&K}function ve(e){s.log("OfferWall | marked offer clicked for CSC with type "+e.type),K=!0}function me(e){return x=e&&e.placementId||F,s.log("OfferWall | Updated placement to "+x),x}var he=function(e,t){E&&"pending"===E.state()&&g.when(E).always(function(){he(e,t)}),(L[e]=t)?N++:N--,g.when(M).always(function(){s.log("poll counter set to: "+N),E=s.setUserData(m.applicationKey,m.applicationUserId,{counter:N}),g.when(E).always(function(){E=null})})},be=function(){var e=new g.Deferred,t={counter:0,timestamp:0};return g.when(M,E).always(function(){g.when(s.getUserData(R,B)).then(function(e){N=t.counter=d.Utils.isDefined(e.counter)?e.counter:0,U=t.timestamp=d.Utils.isDefined(e.timestamp)?e.timestamp:0}).always(function(){g.when(s.setUserData(R,B,t)).then(function(){s.log("initiation done with resolve"),e.resolve()},function(){s.log("initiation done with reject",s.LogLevels.error),e.reject()})})}),e.promise()};function Se(){if(!ie){ie=!0,s.initEventics(b);var e={owPageNumber:0,isPrecache:Z.precache};ne.updateBaseData(e)}}var ye=function(e){var t,n;if(M){if("pending"===M.state())return M.promise()}else M=new g.Deferred;return t=d.PubSub.subscribe(f+".adCreditedSuccess",function(){U=e.timestamp,M.resolve(),d.PubSub.clearHandlers([t,n])}),n=d.PubSub.subscribe(f+".adCreditedFailed",function(e){M.reject(e.errMsg),d.PubSub.clearHandlers([t,n])}),g.when(E).always(function(){s.callSDKFunction("adCredited",e,"adCreditedSuccess","adCreditedFailed")}),M.promise()},Ae=function(t,n){var i={},r=[];if(s.log("In poll with counter "+N),!d.Utils.isDefined(t)&&N<=0||V&&"pending"===V.state())s.log("Exit poll, p:"+(V?V.state():null)+" a:"+(M?M.state():null));else{var e=s.getApiData(I),a=0;if(d.Utils.isDefined(e.errMsg)||!d.Utils.isDefined(R)||!d.Utils.isDefined(B))return s.log(e.errMsg,s.LogLevels.error),void(d.Utils.isDefined(t)&&d.Utils.isDefined(n)&&s.callSDKFunction(n,{errMsg:"Failed to make polling request, missing data"}));d.Utils.decodeValues(e);var o={aid:R,auid:B,SDKVersion:e.SDKVersion,timestamp:U};Ge(o),V=g.ajax({url:l,data:o,timeout:$.pollAPITimeout,type:"GET",dataType:"jsonp"}),g.when(V).then(function(e){if(s.log("Received poll data"),!(d.Utils.isDefined(e.rewardsData)&&d.Utils.isDefined(e.sig)&&d.Utils.isDefined(e.rewardsSummary)))return s.log("Poll data error",s.LogLevels.error),void(d.Utils.isDefined(t)&&d.Utils.isDefined(n)&&s.callSDKFunction(n,{errMsg:"Failed to retrieve user completion data, data error"}));!d.Utils.isEmptyObject(e.rewardsData)||d.Utils.isDefined(t)?(s.log(a),i={productType:c,credits:e.rewardsFromTime,total:e.rewardsSummary,signature:e.sig,timestamp:e.latestCompletionTime,externalPoll:d.Utils.isDefined(t),totalCreditsFlag:0===U},g.when(M).always(function(){M=null,g.when(ye(i)).then(function(){g.each(e.rewardsData,function(){this.b&&L[this.b]&&he(this.b,!1),r.push(this.id),a+=this.r?this.r:0}),0<r.length&&g.ajax({url:e.callbackURL,type:"GET",dataType:"jsonp",data:{vt:r.join(","),applicationKey:R,applicationUserId:B},success:function(){s.log("successfully updated server on csc")},error:function(e){s.log("failed to update server on csc",s.LogLevels.error)}})}).always(function(){M=null})})):s.log("no new completions")},function(e){s.log("Error retrieve user completion data"),d.Utils.isDefined(t)&&d.Utils.isDefined(n)&&s.callSDKFunction(n,{errMsg:"Failed to retrieve user completion data"})})}};function Ce(){return ae.canEngage()?d.Utils.returnResolvedPromise():ae.isConnected()?d.Utils.returnRejectedPromise(y.engaged):d.Utils.returnRejectedPromise(T.noInternet)}function De(e){e&&(p=e)}function Ie(e){return e in p?p[e]:null}function we(e,t){var n;return n=e?t:m=s.getApiData(C),d.Utils.returnResolvedPromise(n)}function Pe(e){return k=e&&("true"===e.useClientSideCallbacks||"boolean"==typeof e.useClientSideCallbacks&&e.useClientSideCallbacks),d.Utils.returnResolvedPromise(e)}function Te(e){var t=Tt(e);return d.Utils.returnResolvedPromise(t,e)}function Oe(n,e){return we(n,e).then(Pe).then(Te).then(function(e,t){return e&&(k||n)?(s.log("OfferWall | init client side callbacks"),Ot(t),be()):d.Utils.returnResolvedPromise()})}function Fe(){return Ce().then(s.getApplicationInfo.bind(s,b)).then(function(){return me(s.getApiData({placementId:1})),Oe()})}function xe(){s.log("OfferWall | In Refresh Interval"),ae.duringEngage()?s.log("OfferWall | Refresh Interval Popped, but during engage - ignore"):ae.waitUntilAppInForeground().then(ae.waitUntilConnected).then(function(){s.log("OfferWall | Refresh Interval Popped, calling refreshOfferWall"),s.unloadAdViewsByProduct(b),Le()})}function Le(e){Ee(),ae.isConnected()&&($e(),Z.precache?pt():e&&!Z.getInventoryOnInit||Me())}function Ne(){z=setTimeout(function(){s.log("OfferWall | Adunit static assets timer popped"),Ve(y.adunitAssetsTimeout)},$.adUnitAssetsTimeout)}function Ue(e){clearTimeout(z),s.log("OfferWall | Resolve adunit static assets promise"),G.resolve(e)}function Ve(e){clearTimeout(z),s.log("OfferWall | Reject adunit static assets promise - "+JSON.stringify(e)),G.reject.apply(G.reject,arguments)}function Me(){var e=je();e.errMsg||ft(e).always(St)}function Ee(){q=Q=H=null}function ke(){var e=d.PubSub.subscribe(c+".GetConfig",function(e){s.log("OfferWall | Received getConfig event from adunit"),Ue(e)});return function(){d.PubSub.unsubscribe(e)}}function Ke(){var e=d.PubSub.subscribe(u+".Engaged",function(e){e.productType===c&&(J=!0)});return function(){d.PubSub.unsubscribe(e)}}function Be(){s.log("OfferWall | Load Adunit"),G=new g.Deferred,ne.trackTimingStart(ee.staticAssetsLoaded);var e=ke();return g.when(v?(s.log("Using cached adunit url: "+v),d.Utils.returnResolvedPromise({html:v})):j.getGlobalAssetsJSON()).then(function(e){if(v||(j.setAdunitVersion(e),v=j.getAdunitGlobalsHTML()),J)Ve("User closed before visible");else if("rejected"===H.state())Ve("Finished when flow already failed");else{var t=j.getStaticGlobalsUrl()+v+W;setTimeout(function(){s.updateAdUnitUrl(w,t,b,{preload:!0,forceCreation:!0})},0),Ne()}},Ve),G.promise().then(function(e){return ne.trackTimingStop(ee.staticAssetsLoaded),e}).always(function(){e()})}function Re(){var e={pass:!0,reason:"ok"};return ae.isConnected()?s.isSupportedOsVersion(c)?s.isLimitedDeviceModel()&&(e.reason="Device is not supported",e.pass=!1):(e.pass=!1,e.reason="Operating system version "+s.getConfigurationHelper().getDeviceOsVersion()+" is not supported"):(e.pass=!1,e.reason=T.noInternet),e}function je(){var e={data:null,errMsg:null},t=s.getApiData(C);return d.Utils.isDefined(t.errMsg)?e.errMsg=t.errMsg:t==={}?e.errMsg=y.missingData:(t.format=o,Ge(t),_e(t),We(t),d.Utils.decodeValues(t),t.auid=s.AppUserIdService.getAUID(),e.data=t,m=t),e}function We(e){var t=s.getApiData({coppa:0});e.cscd=t&&t.coppa}function _e(e){var t=s.getSDKDataByKey(i.xCodeVersion);t&&(e.xCodeVersion=t)}function Ge(e){var t=s.getSDKDataByKey(i.abTests.abt);t&&t.hasOwnProperty(i.abtParamByProductType[c])&&0<t[i.abtParamByProductType[c]].length&&(e.abt=t[i.abtParamByProductType[c]])}function He(e){H&&"pending"===H.state()&&(s.log("OfferWall | Rejecting Get Inventory | "+e.errMsg),e.errCode&&(eventObj.errorCode=e.errCode),e.failFlow!=A.preConditions&&ne.trackEvent(ee.getInventoryFailed,{callFailReason:e.errMsg}),H.reject(e))}function qe(e,t){return{failFlow:e,errMsg:t}}function Qe(){return qe(A.close,"User closed before visible",!0)}function Je(e,t,n){var i=qe(e,t);return i.errCode=n||0,i}function ze(){return _&&"pending"===_.state()}function Xe(){return H&&"pending"===H.state()}function $e(){X&&(clearTimeout(X),X=null)}function Ye(){var e=s.getApiData({scdn:1,protocol:0,defaultProtocol:1}),t=s.decideUrlProtocolAccordingToHTTPSCompliance(),n=e.scdn;return{protocol:t,urltocdn:"prod"!==s.getEnv()?s.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env:t+"//"+n,preload:Z.precache,hasNotch:s.getNotchService().hasNotch()}}function Ze(e,t){var n=ze(),i=e.offers&&0<e.offers.length;if(n||i)return T.confirmCloseMsg=e.textData.confirmCloseMsg,g.extend(e.settings,Ye(),s.getFormattedDeviceData()),tt(e),it(e).then(function(e){et(e),t.callback.call(null,e)});var r=qe(A.inventoryInBackground,"Empty Inventory");return s.log("No inventory available while preloading in background - Remove iframe"),s.unloadAdViewsByProduct(b),He(r),d.Utils.returnRejectedPromise(r)}function et(e){var t={settings:{deviceId:s.getDeviceId(),appKey:s.getSDKDataByKey(i.requiredSDKDataKeys.applicationKey),userApplicationId:s.getSDKDataByKey(i.requiredSDKDataKeys.applicationUserId),shouldShowOWPopup:Ut()}};return g.extend(!0,e,t)}function tt(e){s.getConfig().mobileSDKSettings.deviceOs!==i.deviceOs.ios&&e.settings.forceOWOrientation&&(w.ext={forceOrientation:e.settings.forceOWOrientation})}function nt(){return x||F}function it(e){var t=new g.Deferred;if(!e.settings.placementsFlow)return t.resolve(ot(e));if(ze())t.resolve(st(e));else{s.log("Waiting for show before resolving getConfig");var n=d.PubSub.subscribe(f+".showOfferWall",function(){d.PubSub.unsubscribe(n),s.getApplicationInfo(b).then(function(){me(s.getApiData({placementId:1})),t.resolve(st(e))})})}return t.promise()}function rt(e,t){if(!e)return!1;if(e.offers&&0<e.offers.length){var n=e.offers[0];return n.rewards&&n.rewards[t]}return!!e.settings.currency&&e.settings.currency[t]}function at(e,t){if(!e.intermediateData||!e.intermediateData.text)return e;var n=e.currency||t,i=e.intermediateData.text.actionButton,r=e.intermediateData.text.instructionDescription,a=e.intermediateData.text.instructions,o={"{{rewardCount}}":e.rewards,"{{currencyName}}":n};if(0<i.length&&(e.intermediateData.text.actionButton=d.Utils.replacePlaceHolder(i,o)),0<r.length&&(e.intermediateData.text.instructionDescription=d.Utils.replacePlaceHolder(r,o)),0<a.length)for(var s=0;s<a.length;s++)a[s]=d.Utils.replacePlaceHolder(a[s],o);return e}function ot(e){for(var t=e.offers,n=0;n<t.length;n++)t[n]=at(t[n],e.settings.currency);return e}function st(e){var t=e.offers,n=nt();rt(e,n)||(n=me({placementId:F})),s.log("Offerwall | currentPlacement: "+n),e.settings.placementId=n;for(var i=0;i<t.length;i++)t[i].textData=t[i].textData[n],t[i].rewards=t[i].rewards[n],t[i].multiCompletionsRewards&&t[i].multiCompletionsRewards[n]&&(t[i].multiCompletionsRewards=t[i].multiCompletionsRewards[n]),t[i]=at(t[i],e.settings.currency[n]);try{e.settings.currency=e.settings.currency[n],e.settings.doublePromotionData&&(e.settings.doublePromotionData=e.settings.doublePromotionData[n]),e.settings.multiCreditPromotionData&&(e.settings.multiCreditPromotionData=e.settings.multiCreditPromotionData[n]),e.settings.linksData.contactSupport.label=e.settings.linksData.contactSupport.label[n],e.textData.header=e.textData.header[n]}catch(e){s.log("OfferWall | Failed to interpolate inventory response",s.LogLevels.error)}return e}function dt(e,n){n.failFlow!==A.close?(ze()?n.failFlow===A.inventory&&(e&&"rejected"!==e.state()||(e=ct()),e.then(function(e){var t=g.extend({},Y);t.ext.emptyOWReason=n.errMsg,et(t),e.callback.call(null,t)})):(n.failFlow===A.inventory&&(n=qe(A.inventoryInBackground,"Failed to get Inventory"),s.log("OfferWall | Inventory failed while preloading in background - Remove iframe")),s.unloadAdViewsByProduct(b)),He(n)):He(n)}function lt(e){s.log("Offerwall | Get Inventory"),ne.trackEvent(ee.getInventory);var t=s.getProtocol()+i.gatewayDestinationMap.OW.production;return re.getInventory(e.data,t).then(function(e){if(J){var t=Qe();return d.Utils.returnRejectedPromise(t)}return e},function(e){return J?Qe():Je(A.inventory,e.errorMessage,e.errorCode)}).then(function(e){return s.CampaignsFilter.filterByAppInstalledOW(e.offers,e.settings).then(function(){return d.Utils.returnResolvedPromise(e)})})}function ct(){var e=Ie(i.offerWallSetting.OWVersion)||i.offerWallSetting.defaultOWVersion;return Mt.bind(null,e)().then(null,function(e){return J?Qe():qe(A.adunit,e)})}function ut(){if(s.log("OfferWall | _handlePreConditions"),q&&"pending"===q.state())return s.log("OfferWall | _handlePreConditions already has deferred "+q.state()),q;var e;q=new g.Deferred,J=!1,$e();var t=!0,n=Re();n.pass||(He(e=qe(A.preConditions,n.reason)),t=!1);var i=je();return i.errMsg&&(He(e=qe(A.preConditions,i.errMsg)),t=!1),t?q.resolve(i):q.reject(e),q.promise()}function ft(e){return s.log("OfferWall | _getInventoryWithPromise"),Q&&"rejected"!==Q.state()?(s.log("OfferWall | _getInventoryWithPromise already has deferred "+Q.state()),Q):Q=lt(e).then(function(e){e.settings=e.settings||{};var t=e.settings;return t.shouldStartMuted=s.AdUtils.isCampaignShouldStartMuted(s.getConfig().controllerConfig,i.OW),De(g.extend(t,s.getApplicationExternalConfig().getABTestConfiguration("Offerwall",e.settings.templateId))),gt({feedSize:e.offers.length,landingId:e.settings.templateId,strategyId:e.settings.strategyId}),d.Utils.returnResolvedPromise(e)})}function gt(e){ne.updateBaseData(e)}function pt(){return s.log("OfferWall | _initOfferWall"),H&&"rejected"!==H.state()?s.log("OfferWall | _initOfferWall using cached promise in Init OW flow"):(H=new g.Deferred,mt().then(function(){H.resolve()})),H.promise()}function vt(t){var n=new g.Deferred;return s.shouldExtendApiDataWithDebugData()?s.extendApiDataWithDebugParams(t.data).then(function(e){t.data=e,n.resolve(t)}):n.resolve(t),n.promise()}function mt(){var t=null;return ut().then(function(e){return vt(e)}).then(function(e){return ft(e)}).then(function(e){return t=ct(),g.when(e,t)}).then(function(e,t){return Ze(e,t)},function(e){return dt(t,e)}).always(St)}function ht(){return ut().then(ft,function(e){return e&&e.errMsg||(e={errMsg:y.preconditions}),s.log("OfferWall.js | CB.init preConditionsFailed "+JSON.stringify(e),s.LogLevels.verbose),d.Utils.returnRejectedPromise(e.errMsg)}).then(null,function(e){return s.log("OfferWall.js | CB.init getInventoryPromise fail",s.LogLevels.verbose),e=e||y.server,d.Utils.returnRejectedPromise(e)}).always(St)}function bt(){return Z.precache?(pt(),d.Utils.returnResolvedPromise()):Z.getInventoryOnInit?ht():d.Utils.returnResolvedPromise()}function St(){if(!X&&(Z.precache||Z.getInventoryOnInit)&&!Dt(Ct())){var e=Z.refreshInterval;s.log("Setting OW refresh interval - "+e+" minutes",s.LogLevels.verbose),X=setTimeout(xe,e*t)}}function yt(){J&&d.Utils.returnRejectedPromise(Qe().errMsg)}function At(e){"object"!=typeof e&&(e={errMsg:e});var t=e.errMsg||"Generic error on ShowOfferWall";return J?t:e.failFlow===A.adunit?(ne.trackEvent(ee.showOWFail,{callFailReason:"l1651: "+t}),xt(t),t):e.failFlow===A.preConditions?(ne.trackEvent(ee.showOWFail,{callFailReason:"l1655: "+t}),xt(t),t):(s.log("Empty OfferWall error",s.LogLevels.verbose),Pt(),d.Utils.returnResolvedPromise())}function Ct(){var e,t=Ie("standaloneOfferWallData");if(t&&t.url){var n=t.url,i=nt();d.Utils.isDefined(i)&&(n=d.Utils.replacePlaceHolder(n,{"{{PlacementId}}":i})),-1===n.indexOf("openOWInStandalone")&&(n+="&openOWInStandalone=true"),e=g.extend({},t,{url:n})}return e}function Dt(e){return e&&e.openInStandaloneOfferWall&&e.url}function It(){return _&&"rejected"!==_.state()?(s.log("line[354]: Recalling showOW before resolving previous flow",s.LogLevels.error),ne.trackEvent(ee.showOWFail,{callFailReason:"Recalling showOW before resolving previous flow"}),_):(_=new g.Deferred,Se(),ne.incrementSessionNumber(),ne.trackTimingStart(ee.initControllerToShowOWCalled,s.getApiData({controllerTimeLoaded:1}).controllerTimeLoaded),ne.trackTimingStop(ee.showOWCalled,{eNameStart:ee.initControllerToShowOWCalled}),ne.trackTimingStart(ee.showOWCalledToOwVisible),Fe().then(function(){if(Dt(n=Ct()))return d.Utils.returnResolvedPromise();var e=pt();return t=Ke(),wt(e),e.then(yt,At)},function(e){return ne.trackEvent(ee.showOWFail,{callFailReason:"l1735: "+e}),xt(e),e}).always(function(){t&&t()}).then(function(){if(Dt(n)){var e={url:n.url,method:"external_browser"};s.openUrl(e)}else Pt();s.log("Resolving ShowOfferWall"),_.resolve.apply(this,arguments)},function(e){s.log("Rejecting ShowOfferWall"),_.reject(e)}),_.promise());var t,n}function wt(e){if(w.url=null,w.isWPAD=!1,"resolved"!==e.state()||!Z.precache){var t={preload:!1,immersive:!!Ie(i.offerWallSetting.immersive)&&Ie(i.offerWallSetting.immersive),OLXD:Ie(i.offerWallSetting.OLXD)};s.loadAdUnitUrl(w,w.url,b,t),s.displayAdView(w)}}function Pt(){w.isWPAD=!1,s.loadAdUnitUrl(w,w.url,b,{preload:!1}),s.displayAdView(w)}var Tt=function(e){var t=e.applicationUserId,n=e.applicationKey;return t!==B||n!==R},Ot=function(e){B=e.applicationUserId,R=e.applicationKey};function Ft(e){return T.dialogErrorMessage}function xt(e){s.log("No OfferWall dialog error");var t={productType:c,message:Ft(e),alwaysClose:!0,yes:"close",no:"OK"};s.alert(t)}function Lt(){var e=s.getProtocol();h={dev:e+i.gatewayDestinationMap.OW.production,stage:e+i.gatewayDestinationMap.OW.production,prod:e+i.gatewayDestinationMap.OW.production}}function Nt(e){return h[e]||h.prod}function Ut(){var e=s.getApplicationExternalConfig().getABTestConfiguration("Offerwall",m.landingId),t=e.OWPopupInterval?e.OWPopupInterval:0;if(!t||!te)return!0;var n=window.timerService.timeElapsed(te);return t*i.timeunit-n<=0&&(window.timerService.stopTimer(te),!(te=void 0))}var Vt={init:function(e){r=this,g=s.jQuery(),Lt();var t=Nt(s.getEnv());if(!a){var n={productChance:(s.getEnv(),1),baseData:{productType:c}};"android"===s.getConfig().mobileSDKSettings.deviceOs&&(C.deviceApiLevel=0),ne=d.Eventics.createEventic(n,s.EventsManager),re=new(Et("../../components/FetcherService.js"))(t,D),ae.init(),ue(),Z=e.supplyConfig,a=!0}},getNextBtnText:function(){return d.Utils.isDefined(T.next)?T.next:"Next"},getConfirmCloseMsg:function(){return T.confirmCloseMsg&&T.confirmCloseMsg[S[0]]},showOfferWall:It,isNextAvailable:function(){return!1},getBack:function(){return w.url}};function Mt(t){s.log("OfferWall | Load external version: "+t),G=new g.Deferred,ne.trackTimingStart(ee.staticAssetsLoaded);var e=ke();if(J)Ve("User closed before visible");else{var n=j.getOWStaticGlobalsUrl(t)+j.getOWGlobalsHTML()+W;s.log("composedUrl: "+n),setTimeout(function(){s.updateAdUnitUrl(w,n,b,{preload:!0,forceCreation:!0})},0),Ne()}return G.promise().then(function(e){return ne.trackTimingStop(ee.staticAssetsLoaded,{custom_a:t}),e}).always(function(){e()})}return g.extend(Vt,{_promisedCanEngage:Ce,_initiateClientSideCallbacks:Oe,_preShowOfferWall:Fe,_refreshInterval:xe,_refreshOfferWall:Le,_setAdunitAssetsTimer:Ne,_resolveAdunitAssetsPromise:Ue,_rejectAdunitAssetsPromise:Ve,_subscribeGetConfig:ke,_subscribeCloseDuringShow:Ke,_loadAdunitToIframe:Be,_verifyRestrictions:Re,_getAPIRequiredData:je,_rejectInitWithReason:He,_generateErrorObject:qe,_generateCloseBeforeVisibleErrorObject:Qe,_isDuringShow:ze,_isDuringInit:Xe,_clearRefreshInterval:$e,_handleDependenciesResolve:Ze,_handleDependenciesReject:dt,_getInventory:lt,_loadAdunit:ct,_handleInitOfferWallError:At,_showLoaderIfNeeded:wt,_initOfferWallByConfig:bt,_displayOfferWall:Pt,_getInventoryAndPreload:mt,_initOfferWall:pt,_setOfferWallSettings:De,_getOfferWallSetting:Ie,shouldAvoidHandleFrameClose:function(){return!1}}),Vt}e.exports=n},{"../../components/Constants.js":13,"../../components/FetcherService.js":22,"./OWEventCategories.js":130}],132:[function(G,e,t){e.exports=function(g,d,l,c){"use strict";var a,t,i,r=d.jQuery(),e=G("./LoadedInstances"),n=new(G("./SDKController/ManualLoadInstancesBuilder.js"))(d.getConfig().controllerConfig,c),u=new(G("./DemandSource/EventCategories"))(l.ProductName),o=new(G("./DataStore")),f=new(G("./DemandSource/dsConfig"))(l,u),p=new(G("./prdTaskManager"))(g,d,l.ProductName,c),s=new(G("../components/FilteredListService")),v={},m={},h=!1,b=d.DemandUtils,S=[],y=new e,A=d.InstancesTimers,C={loadSuccess:null,loadFailure:null};function D(e){A.clearInstanceTimers(l.ProductName,e),delete a[e]}function I(e){return r.extend({},{originalDemandSourceName:R(e)},e)}function w(e,t){var n=V(e);return n||(n=K(t)),n}function P(e){return t=e,!(d.getConfig().mobileSDKSettings.deviceOs===c.deviceOs.ios&&!t.isViewControllerSet);var t}function T(e,t,n){var i=R(e),r=W(e);if(L(r,i),U(i))!function(e,t,n){var i=f.errors.load.instanceExhausted;e.productType=l.ProductName;var r=b.extendCallbackParamsWithDemandConfig(e,{errMsg:i});r=A.extendEventDataWithElapsedLoadTime(e.productType,e.demandSourceName,r),t.trackEvent(u.loadAdFailedForExhaustedInstance,{},r),A.clearLoadStartTimeForInstance(e.productType,e.demandSourceName),d.callSDKFunction(n,r)}(e,r,n);else{var a=w(i,e);if(O(a)){if(e&&e.productType===c.BN){if(!P(e))return o=e,r.trackEvent(u.loadAdFailed,{},{callfailreason:"Missing Parameter : View Controller",timingvalue:A.stopLoadTimer(o.productType,o.demandSourceName)}),void d.callSDKFunction(s,b.extendCallbackParamsWithDemandConfig(o,{errMsg:"Missing Parameter : View Controller"}));d.addExternalAdViewIdAndSetStatus(e)}var o,s;p.canEngage()?a.statesManager.load(a.loadAd,t,n,a.readyStateParams):j(e,r,n,"LWS is not allowed for nonBidding instance")}else F(e,r,n)}}function O(e){return e&&e.statesManager}function F(e,t,n){j(e,t,n,f.errors.general.dsNotSet)}function x(e,t){var n,i,r,a=w(R(e),e),o=_(a),s=(n=e)&&n.dynamicDemandSource?n.dynamicDemandSource:null,d=function(e){if(!e)return null;try{var t=g.Utils.parseJSON(decodeURIComponent(e));return g.Utils.isEmptyObject(t)&&(t=null),t}catch(e){}return null}(e.adm),l=(r="-1",(i=d)&&i.seatbid.ext.hasOwnProperty("auction")?i.seatbid.ext.auction.id:r);o.updateBaseData({auctionId:l,dynamicDemandSource:s});var c,u,f=(u={},(c=e).label&&(u.adsizelabel=c.label),c.height&&c.width&&(u.adsizeheight=c.height,u.adsizewidth=c.width),u);o.updateBaseData(f),L(o,e.originalDemandSourceName),O(a)?d?(e.adm=d,a.statesManager.loadWithADM(function(){a.loadAdWithAdm(e,t)},t)):j(e,o,t,"unable to parse adm from native SDK"):F(e,o,t)}function L(e,t){d.log("productAdapter - load",d.LogLevels.verbose);var n=A.extendEventDataWithElapsedLoadTime(l.ProductName,t,{});e.trackEvent(u.loadAd,{demandSourceName:t},n),f.shouldDisplayOnAdReady&&e.trackTimingStart(u.showAdCalled)}function N(e){return e&&e.productType===l.ProductName}function U(e){return-1!==S.indexOf(e)}function V(e){return e?a[e]:null}function M(e){return g.Eventics.createEventic({productChance:1,baseData:{productType:l.ProductName,demandSourceName:e.originalDemandSourceName,isBiddingInstance:e.isInAppBidding}},d.EventsManager)}function E(e){var t=M(e);i=function(e){if(i)return i;var t={productType:l.ProductName,isInAppBidding:!0,originalDemandSourceName:e.originalDemandSourceName||R(e)},n=r.extend({},f.precacheConfig);return n.cacheBase=c.cacheAdsDirectory,n.precachePath="../"+n.cacheBase+"/",r.extend(n,t),new(G("../components/precacheManager"))(g,d,n)}(e);var n=new(G("./DemandSource/BidderProductInstance"))(g,d,c,e,f,t,i);return n.statesManager=new(G("./ProductAdapter/BidderProductStatesManager"))(g,d,e,f,c,t,l.NativeAPI),n}function k(e){if(e){var t,n,i,r=e.demandSourceName;return a[r]||(d.log("initiating "+l.ProductName+" demand source with configuration "+JSON.stringify(e),d.LogLevels.verbose),e.shouldAvoidHandleFrameClose=l.shouldAvoidHandleFrameClose,a[r]=e.isInAppBidding?E(e):(n=M(t=e),(i=new(G("./DemandSource/ProductInstance"))(g,d,c,t,f,n,o)).statesManager=new(G("./ProductAdapter/ProductStatesManager"))(g,d,t,f,c,n,l.NativeAPI),i),a[r].init()),a[r]}}function K(e){return k(n.createDemandEntityConfigObj({productType:l.ProductName,demandSourceName:R(e),isInAppBidding:B(e),demandSourceId:e.demandSourceId,originalDemandSourceName:e.originalDemandSourceName||R(e),adSize:{width:e.width,height:e.height,label:e.label}}))}function B(e){return!(!e||!e.inAppBidding||"true"!==e.inAppBidding.toLowerCase())}function R(e){return e&&e.demandSourceName?e.demandSourceName:l.DemandName}function j(e,t,n,i){e.productType=l.ProductName;var r=b.extendCallbackParamsWithDemandConfig(e,{errMsg:i});r.callfailreason=i,r.timingvalue=A.stopLoadTimer(e.productType,e.demandSourceName),r=A.extendEventDataWithElapsedLoadTime(e.productType,e.demandSourceName,r),t.trackEvent(u.loadAdFailed,{},r),A.clearLoadStartTimeForInstance(e.productType,e.demandSourceName),d.callSDKFunction(n,r)}function W(e){return _(a[R(e)])}function _(e){return e&&e.getDSEventics&&e.getDSEventics()?e.getDSEventics():t}return{init:function(){if(a=this,!h){var e={productChance:1,baseData:{productType:l.ProductName}};t=g.Eventics.createEventic(e,d.EventsManager),function(){var e=d.getProtocol();v={dev:e+l.gatewayDestinationMap.prod,stage:e+l.gatewayDestinationMap.prod,prod:e+l.gatewayDestinationMap.prod};var t,n,i=d.getApiData({destinationMap:0});if(i&&i.destinationMap)for(t in m=i.destinationMap)n=m[t],m[t]&&0<m[t].length&&-1===m[t].indexOf(e)&&(m[t]=e+n)}(),g.PubSub.subscribe(l.AdUnitCallbacks.engageEnd,function(e,t){if(N(e)){var n=V(e.demandSourceName);n&&n.statesManager&&((e&&e.engaged||l.shouldResetOnEngageEnd)&&n.statesManager.engageEnd(),n.engageEnd(e,function(){p.publish("Engaged",[{duringEngage:!1,productType:l.ProductName}]),g.Utils.isFunction(t)&&t()}))}}),g.PubSub.subscribe(l.AdUnitCallbacks.adClicked,function(e){if(N(e)){var t=d.getCurrentDisplayedAd();t&&d.callSDKFunction(l.ControllerNativeAPI.adClicked,b.extendCallbackParamsWithProductConfig(t,{}))}}),g.PubSub.subscribe(l.AdUnitCallbacks.adVisible,function(e){if(N(e)){var t=V(e.demandSourceName);t?(d.log("ProductAdapter | "+l.AdUnitCallbacks.adVisible+" demandSourceName="+e.demandSourceName),t.adVisible(e),t.statesManager&&t.statesManager.adVisible()):d.log(l.AdUnitCallbacks.adVisible+" called without an active demand source name")}}),g.PubSub.subscribe(l.ProductName+l.ControllerCallbacks.cacheReady,function(e){var t=V(e.demandSourceName);t&&t.statesManager&&(t.readyStateParams=e,t.statesManager.cacheReady(C.loadSuccess,e))}),g.PubSub.subscribe(l.ProductName+l.ControllerCallbacks.noMoreOffers,function(e){var t=V(e.demandSourceName);t&&t.statesManager&&t.statesManager.noMoreOffers(C.loadFailure,e.errorMsg)}),g.PubSub.subscribe(l.ProductName+l.ControllerCallbacks.failedToShow,function(e){var t=V(e.demandSourceName);t&&t.statesManager&&(d.log(l.ProductName+" failed to show - can not engage ad",d.LogLevels.error),t.statesManager.failedToShow())}),g.PubSub.subscribe(l.ProductName+l.ControllerCallbacks.failedToLoad,function(e){var t=V(e.demandSourceName);if(t&&t.statesManager){d.log(l.ProductName+" failed to load",d.LogLevels.error);var n={callFailReason:e.errMsg,timingvalue:A.stopLoadTimer(l.ProductName,e.demandSourceName)};n=A.extendEventDataWithElapsedLoadTime(l.ProductName,e.demandSourceName,n),W(e).trackEvent(u.loadAdFailed,{},n),A.clearLoadStartTimeForInstance(l.ProductName,e.demandSourceName),t.statesManager.failedToLoad()}}),g.PubSub.subscribe(l.ProductName+l.ControllerCallbacks.actionClick,function(e){d.OpenURLService.open(e)||d.log(l.ProductName+" failed to perform ActionClick",d.LogLevels.info)}),g.PubSub.subscribe(l.ProductName+l.ControllerCallbacks.exhaustedDemandSource,function(e){var t=R(e),n=V(t);d.log("exhaustedDemandSource: "+t,d.LogLevels.verbose),n&&(n.exhausted=!0),S.push(t),e&&e.engaged||(d.log("Demand source deleted in BG: "+t,d.LogLevels.verbose),D(t))}),g.PubSub.subscribe(l.ProductName+l.ControllerCallbacks.fallbackToNonPrecache,function(e){var t=V(e.demandSourceName);t&&t.statesManager&&t.statesManager.noMoreOffers(C.loadFailure,"failed due to fallbackToNonPrecache flow on manual load")}),g.PubSub.subscribe(l.ProductName+l.ControllerCallbacks.resetStateManager,function(e){var t=V(R(e));t&&t.statesManager&&t.statesManager.resetAdState()}),g.PubSub.subscribe("SDKController"+l.ControllerCallbacks.onAdWindowsClosed,function(e){if(N(e)){var t=V(e.demandSourceName);if(t)return t.exhausted?(d.log("Demand source deleted: "+e.demandSourceName,d.LogLevels.verbose),void D(e.demandSourceName)):void(e.isInAppBidding&&y.add(e.demandSourceName))}}),l.ControllerCallbacks.reset&&g.PubSub.subscribe(l.ProductName+l.ControllerCallbacks.reset,function(e){var t=V(e.demandSourceName);if(t)return d.getExternalContainer().resetReportAdVisibilityFlags(),W(e).trackEvent(u.bannerDestroyed),t.statesManager.resetAdState(),void t.reset();d.log("Reset called without an active demand source name",d.LogLevels.verbose)}),p.init(),h=!0}},getProductType:function(){return l.ProductName},getDestination:function(e){return m&&m[e]?m[e]:v[d.getEnv()]},getAmountOfSupportedInventories:function(){return l.amountOfInventories},shouldAvoidHandleFrameClose:function(){return l.shouldAvoidHandleFrameClose},doesAllowConsecutiveGatewayRequestsDuringLoad:function(){return l.Features.allowConsecutiveGatewayRequestsDuringLoad},getProductTM:function(){return p},getConfirmCloseMsg:function(e){return a[e]?a[e].getConfirmCloseMsg():null},initProduct:function(e,t,n){R(e),B(e=I(e))&&(e.demandSourceName=e.demandSourceId),A.setLoadStartTimeForInstance(l.ProductName,e.demandSourceName,e.loadStartTime);var i={isBiddingInstance:B(e)};i=A.extendEventDataWithElapsedLoadTime(l.ProductName,e.demandSourceName,i),W(e).trackEvent(u.initAd,{demandSourceName:e.originalDemandSourceName},i);var r=d.getSDKLimitationData(l.ProductName);if(r.didSucceed){var a=K(e);a&&(a.initProduct&&g.Utils.isFunction(a.initProduct)&&a.initProduct(e),a.statesManager&&a.statesManager.init(t))}else _failProduct(e,n,r.errMsg)},loadProduct:function(e,t,n){d.log("productAdapter - loadProduct",d.LogLevels.verbose),e=I(e),A.startLoadTimer(l.ProductName,e.demandSourceName),A.setLoadStartTimeForInstance(l.ProductName,e.demandSourceName,e.loadStartTime),C.loadSuccess=t,C.loadFailure=n,B(e)?((e.productType!==c.BN||d.isBannerAndLoadWhileShowSupported(e.productType))&&(y.removeAll(a,e.demandSourceId),y.add(e.demandSourceId),e.demandSourceName=e.demandSourceId),x(e,n)):T(e,t,n)},showProduct:function(e,t,n){B(e=I(e))&&(y.clear(e.demandSourceId),e.demandSourceName=e.demandSourceId);var i=R(e),r=V(i),a=e&&e.orientationRestriction;W(e).updateBaseData({sessionDepth:d.ImpressionsCounterService.getCountersByProduct(f.productType).totalSessionImpressions+1}),W(e).trackEvent(u.showAd),d.AppOrientationManager.updateAppOrientationByNewRestriction(a),function(e,t,n,i){if(U(n)){var r={errMsg:f.errors.show.instanceExhausted,demandSourceName:n};return W(e).trackEvent(u.showAdFail,{callfailreason:f.errors.show.instanceExhausted}),d.callSDKFunction(t,r),!1}return!!i||(W(e).trackEvent(u.showAdFail,{callfailreason:f.errors.general.dsNotSet}),d.callSDKFunction(t,{errMsg:f.errors.general.dsNotSet}),!1)}(e,n,i,r)&&(p.canEngage()?(W(e).trackTimingStart(u.showAdCalled),r.statesManager&&r.statesManager.show(r.showAd,t,n)):r.onShowAdFailed(n,"Cannot engage offer at this time"))},initProductFail:function(e,t,n){var i=b.extendCallbackParamsWithDemandConfig(e,{errMsg:n});i.callfailreason=n,i.timingvalue=A.stopLoadTimer(e.productType,e.demandSourceName),i=A.extendEventDataWithElapsedLoadTime(e.productType,e.demandSourceName,i),W(e).trackEvent(u.initAdFail,{},i),A.clearLoadStartTimeForInstance(e.productType,e.demandSourceName),d.callSDKFunction(t,i)},className:"ProductAdapter",filteredListService:s}}},{"../components/FilteredListService":24,"../components/precacheManager":81,"./DataStore":112,"./DemandSource/BidderProductInstance":113,"./DemandSource/EventCategories":115,"./DemandSource/ProductInstance":122,"./DemandSource/dsConfig":123,"./LoadedInstances":129,"./ProductAdapter/BidderProductStatesManager":133,"./ProductAdapter/ProductStatesManager":135,"./SDKController/ManualLoadInstancesBuilder.js":145,"./prdTaskManager":165}],133:[function(e,t,n){function i(a,o,s,d,l,c,e){var u=o.jQuery(),f={readyToLoad:0,inLoadingProcess:1,loaded:2,readyToShow:3,inShowingProcess:4,visible:5},t=f.readyToLoad,n=f.readyToShow,g=d.eventicsCategories,p=o.DemandUtils,v=!1,m=p.extendCallbackParamsWithDemandConfig(s),h=o.InstancesTimers;function r(e){return t===e}function b(e){return n===e}function S(e){t=parseInt(e,10)}function y(e){n=parseInt(e,10)}function A(){return S(f.readyToLoad)}function i(){return y(f.readyToShow)}function C(){return r(f.readyToLoad)?d.errors.show.notLoaded:r(f.inLoadingProcess)?d.errors.show.duringLoad:b(f.inShowingProcess)?d.errors.show.tryingToEngage:b(f.visible)?d.errors.show.visible:"fail reason is unknown."}function D(e){if(b(f.visible)||b(f.inShowingProcess))o.log(C(),o.LogLevels.error);else if(!r(f.loaded)){var t=p.extendCallbackParamsWithDemandConfig(s,{errMsg:C()});o.callSDKFunction(e,t)}}function I(e){var t=p.isLegacy(s)?{}:m;v=!0,o.callSDKFunction(e,t)}function w(e,t){if(o.log("_loadWithADM",o.LogLevels.error),!v){var n="instance was not initiated",i=p.extendCallbackParamsWithDemandConfig(s,{errMsg:n}),r=u.extend({},m,{demandSourceName:s.originalDemandSourceName,callfailreason:n,timingvalue:h.stopLoadTimer(s.productType,s.originalDemandSourceName)});return r=h.extendEventDataWithElapsedLoadTime(s.productType,s.originalDemandSourceName,r),c.trackEvent(g.loadAdFailed,{},r),h.clearLoadStartTimeForInstance(s.productType,s.originalDemandSourceName),void o.callSDKFunction(t,i)}S(f.inLoadingProcess),e()}function P(e,t,n){if(r(f.loaded)&&b(f.readyToShow))y(f.inShowingProcess),e(m,t,n);else{var i=u.extend({},m,{demandSourceName:s.originalDemandSourceName});c.trackEvent(g.showAdFail,{callfailreason:C()},i),D(n)}}function T(e,t){S(f.loaded);var n=u.extend({},m,{demandSourceName:s.originalDemandSourceName,timingvalue:h.stopLoadTimer(s.productType,s.originalDemandSourceName)});n=h.extendEventDataWithElapsedLoadTime(s.productType,s.originalDemandSourceName,n),c.trackEvent(g.loadAdSuccess,{},n),h.clearLoadStartTimeForInstance(s.productType,s.originalDemandSourceName),o.callSDKFunction(e,p.extendCallbackParamsWithDemandConfig(s,t)),a.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(s,{response:!0})])}function O(e,t){var n=t===l.errors.noFill?g.noFill:g.loadAdFailed,i=u.extend({},m,{demandSourceName:s.originalDemandSourceName,callFailReason:t,timingvalue:h.stopLoadTimer(s.productType,s.originalDemandSourceName)});i=h.extendEventDataWithElapsedLoadTime(s.productType,s.originalDemandSourceName,i),c.trackEvent(n,{},i),h.clearLoadStartTimeForInstance(s.productType,s.originalDemandSourceName);var r=p.extendCallbackParamsWithDemandConfig(s,{errMsg:d.errors.load.noMoreOffers});o.callSDKFunction(e,r),a.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(s,{response:!1})]),A()}function F(){i()}function x(){A()}function L(){y(f.readyToShow)}function N(){S(f.readyToLoad),y(f.visible)}function U(){return!!v}var V={init:I,show:P,cacheReady:T,noMoreOffers:O,failedToShow:F,failedToLoad:x,engageEnd:L,adVisible:N,loadWithADM:w,resetAdState:i,isInitiated:U};return V}t.exports=i},{}],134:[function(e,t,n){t.exports={NativePrefix:"NativeCallback",className:"ProductAdapter",adStates:{notSet:0,waitingToLoad:1,inLoadingProcess:2,internalLoadingProcess:3,loaded:4,loadedFromInternalLoad:5,visible:6,inShowingProcess:7,failedInBackground:8}}},{}],135:[function(_,e,t){function n(o,s,d,l,a,c,u){var e=_("./ProductAdapterConstants.js"),f=e.adStates,t=f.notSet,g=l.eventicsCategories,p=!1,v=!1,m=s.DemandUtils,n=!1,h=m.extendCallbackParamsWithDemandConfig(d),b=s.InstancesTimers;function S(e){return t===e}function y(e){t=parseInt(e,10)}function i(){return t}function A(){return y(f.notSet)}function r(){return S(f.loadedFromInternalLoad)||S(f.loaded)}function C(e,t,n){if(p)p=!1;else if(S(f.waitingToLoad))y(f.internalLoadingProcess);else{if(S(f.inLoadingProcess)||v||d.productType===a.BN&&S(f.loaded)){n.name===g.loadAdFailed.name&&t===a.errors.noFill&&(n=g.noFill);var i=jQuery.extend({},h);i=b.extendEventDataWithElapsedLoadTime(d.productType,d.demandSourceName,i),c.trackEvent(n,{callFailReason:t},i),b.clearLoadStartTimeForInstance(d.productType,d.demandSourceName);var r=m.extendCallbackParamsWithDemandConfig(d,{errMsg:l.errors.load.noMoreOffers});s.callSDKFunction(e,r),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(d,{response:!1})])}v=!1,A()}}function D(e){if(u)if(e===u.load){if(S(f.inLoadingProcess)||S(f.waitingToLoad))return l.errors.load.duringLoad;if(S(f.visible)||S(f.inShowingProcess))return l.errors.load.duringShow}else if(e===u.show){if(S(f.notSet))return l.errors.show.notLoaded;if(S(f.inLoadingProcess)||S(f.waitingToLoad))return l.errors.show.duringLoad;if(S(f.visible)||S(f.inShowingProcess))return l.errors.show.visible}}function I(e,t){if(u)if(e===u.load)(S(f.inLoadingProcess)||S(f.waitingToLoad))&&s.log(D(u.load),s.LogLevels.error);else if(e===u.show)if(S(f.notSet)||V()||S(f.inLoadingProcess)){var n=m.extendCallbackParamsWithDemandConfig(d,{errMsg:D(u.show)});s.callSDKFunction(t,n)}else(S(f.visible)||S(f.inShowingProcess))&&s.log(D(u.show),s.LogLevels.error)}function w(e){var t=m.isLegacy(d)?{}:h;n=!0,s.callSDKFunction(e,t)}function P(e,t,n,i){d.productType!==a.BN?T(e,t,n,i):O(e,n)}function T(e,t,n,i){var r;if(S(f.notSet)||S(f.loaded))y(f.inLoadingProcess),e(h,n);else if(S(f.loadedFromInternalLoad))r={timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)},r=b.extendEventDataWithElapsedLoadTime(d.productType,d.demandSourceName,r),c.trackEvent(g.loadAdSuccess,{},jQuery.extend({},h,r)),s.callSDKFunction(t,m.extendCallbackParamsWithDemandConfig(d,i)),y(f.loaded),b.clearLoadStartTimeForInstance(d.productType,d.demandSourceName),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(d,{response:!0})]);else if(p||v){var a=p?l.errors.load.inStateVisibleOrInShowingProcess:l.errors.load.inLoadingStateOrWaitingToLoad;r=jQuery.extend({},h),r=b.extendEventDataWithElapsedLoadTime(d.productType,d.demandSourceName,r),c.trackEvent(g.loadAdIgnored,{callfailreason:a},r),b.clearLoadStartTimeForInstance(d.productType,d.demandSourceName)}else S(f.visible)||S(f.inShowingProcess)?p=!0:V()?v=!0:(c.trackEvent(g.loadAdFailed,{},jQuery.extend({},h,{callfailreason:D(u.load),timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)})),I(u.load))}function O(e,t){var n=function(){};if(S(f.notSet))y(f.inLoadingProcess),e(h,n,t);else if(S(f.loaded))y(f.notSet),e(h,void 0,t);else if(S(f.visible)||S(f.inShowingProcess))y(f.inLoadingProcess),e(h,n,t);else if(V())v=!0;else if(S(f.inLoadingProcess))c.trackEvent(g.bannerReloadDuringLoad,m.extendCallbackParamsWithDemandConfig(d));else{var i=jQuery.extend({},h,{callfailreason:D(u.load),timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)});c.trackEvent(g.loadAdFailed,{},i),I(u.load)}}function F(e,t,n){r()?(y(f.inShowingProcess),e(h,t,n)):(c.trackEvent(g.showAdFail,{callfailreason:D(u.show)},h),I(u.show,n))}function x(e,t){d.productType!==a.BN?L(e,t):N(e,t)}function L(e,t){var n=!1;if((S(f.inLoadingProcess)||v)&&(n=!0),v=!1,S(f.internalLoadingProcess)?y(f.loadedFromInternalLoad):y(f.loaded),n){var i=jQuery.extend({},h,{timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)});i=b.extendEventDataWithElapsedLoadTime(d.productType,d.demandSourceName,i),c.trackEvent(g.loadAdSuccess,{},i),b.clearLoadStartTimeForInstance(d.productType,d.demandSourceName),s.callSDKFunction(e,m.extendCallbackParamsWithDemandConfig(d,t)),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(d,{response:!0})])}}function N(e,t){(S(f.inLoadingProcess)||S(f.visible)||v)&&(c.trackEvent(g.loadAdSuccess,{},{timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)}),c.trackTimingStart(g.bannerLoadSuccessToVisible),s.callSDKFunction(e,m.extendCallbackParamsWithDemandConfig(d,t)),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(d,{response:!0})])),v=!1,y(f.loaded)}function U(e,t){C(e,t,g.loadAdFailed)}function V(){return S(f.waitingToLoad)||S(f.internalLoadingProcess)}function M(){A()}function E(){A()}function k(){d.productType===a.BN?B():K()}function K(){y(p?f.inLoadingProcess:f.waitingToLoad)}function B(){y(f.notSet)}function R(){y(f.visible)}function j(){return S(f.failedInBackground)}var W={getAdState:i,init:w,load:P,show:F,cacheReady:x,noMoreOffers:U,failedToShow:M,failedToLoad:E,engageEnd:k,isFailedInBG:j,adVisible:R,resetAdState:A};return W}e.exports=n},{"./ProductAdapterConstants.js":134}],136:[function(c,e,t){e.exports=function(n,r,i){"use strict";var e,t=c("./AdapterSharedConfig"),a=c("./ProductAdapter"),o=[],s=!1;function d(){if(!r.RewardedVideo){var e=c("./AdapterSharedConfig"),t=c("./RewardedVideo/RewardedAdConfiguration")(e,r.SupplyConfigurations,i);r.RewardedVideo=new a(n,r,t,i),r.RewardedVideo.init()}return r.RewardedVideo}function l(e){return e&&"true"===e.rewarded?d():function(){if(!r.Interstitial){var e=c("./InterstitialDemandSource/AdConfiguration")(t,r.SupplyConfigurations,i);r.Interstitial=new a(n,r,e,i),r.Interstitial.init()}return r.Interstitial}()}return{initModule:function(){e||(o.push(n.PubSub.subscribe(i.CB+t.NativeAPI.init,function(e,t,n){r.log("productRouter | NativeAPI.init"),t=n=function(){},l(e).initProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+t.NativeAPI.load,function(e,t,n){r.log("productRouter | NativeAPI.load"),l(e).loadProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+t.NativeAPI.show,function(e,t,n){var i;(i=e,i&&"true"===i.rewarded?r.RewardedVideo:r.Interstitial).showProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+".initRewardedVideo",function(e,t,n){d().initProductFail(e,n,"Unsupported API function, use Manual RV instead.")})),o.push(n.PubSub.subscribe(i.CB+".showRewardedVideo",function(e,t,n){d().initProductFail(e,n,"Unsupported API function, use Manual RV instead.")})),o.push(n.PubSub.subscribe(i.CB+".initBanner",function(e,t,n){var i;!e||e.inAppBidding||s||(s=!0,r.initBannerExternalService()),(i=e,r.Banner||(r.Banner=r.BannerFactory.create(i),r.Banner.init()),r.Banner).initProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+".loadBanner",function(e,t,n){e.productType=i.BN,r.Banner.loadProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+".bannerViewVisible",function(e,t,n){r.Banner.showProduct(e,t,n)})),e=!0)},destroyListeners:function(){jQuery.each(o,function(e,t){n.PubSub.unsubscribe(t)}),e=!1},className:"ProductRouter"}}},{"./AdapterSharedConfig":101,"./InterstitialDemandSource/AdConfiguration":128,"./ProductAdapter":132,"./RewardedVideo/RewardedAdConfiguration":137}],137:[function(e,t,n){t.exports=function(e,t,n){var i=t.shouldFetchNewFeedOnAdCloseFlag(n.RV);return i=void 0===i||i,{NativeAPI:e.NativeAPI,ControllerCallbacks:e.ControllerCallbacks,AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,retriesLogic:e.retriesLogic,DemandName:"SupersonicAds",ProductName:n.RV,Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,shouldFetchNewFeedOnAdClose:i,isSupportFetchFeedOnAdCloseLogic:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0,isExhaustInstanceAllowed:!1},gatewayDestinationMap:{prod:n.gatewayDestinationMap.RV.production},amountOfInventories:1,lwsSupported:!0}}},{}],138:[function(e,t,n){t.exports=function(e,t,n,i){var r=i.responseTypesWithReason,a={};function o(e){n.publishAvailabilityFalse("NoMoreOffers",e)}function s(e){t.log("Availability Manager | reportAdAvailable",t.LogLevels.verbose),n.isCurrentState(r.ready)||n.publishAvailabilityTrue(e)}return{setAMSettings:function(e,t){e&&"object"==typeof e&&(t?jQuery.extend(a,e):a=e)},cacheAdsFailed:function(e,t,n,i){e&&t?i():o(n)},cacheTimeoutFail:function(e){o(e)},canReportAvailable:function(e,t){a.reportOnAdunitReady&&a.isPreCache&&0!==a.numOfBannersToInitSuccess||s({numOfAdUnits:e,totalNumberCredits:t})},adLoadError:function(){o("Ad loaded with error")},inventoryEmpty:function(e){o(e)},reportAdAvailable:s,reset:function(){n.setLastResponse(r.none),a={}},adLoadedSuccessfully:function(e,t){t?s(e):(a.reportOnAdunitReady||a.preFetchAllVasts)&&a.isPreCache&&s(e)}}}},{}],139:[function(e,t,n){t.exports=function(n,e,i,r,t){var a=i.responseTypesWithReason,o=a.none,s=e.DemandUtils;function d(e){return o===e}function l(e,t){n.PubSub.publish(i.productType+"."+e,[s.extendCallbackParamsWithParentProductConfig(r,t)])}function c(){t.publish("InitiatedAPICall",[s.extendCallbackParamsWithProductConfig(r,{duringInit:!1})])}return{setLastResponse:function(e){o=e},getLastResponse:function(){return o},publishAvailabilityTrue:function(e){c(),l("CacheReady",jQuery.extend(e,{firstCampaignCredits:1})),o=a.ready},publishAvailabilityFalse:function(e,t){c(),d(a.notReady)||"NoMoreOffers"===e&&(l(e,{numOfAdUnits:0,firstCampaignCredits:0,totalNumberCredits:0,errorMsg:t}),o=a.notReady)},isCurrentState:d}}},{}],140:[function(e,t,n){t.exports=function(n,t,i,r){var a,e=!1,o=!1,s=!1,d=!1,l=!1,c=!1;function u(e){return e&&e.productType===i.productType&&(!i.demandSourceName||e.demandSourceName===i.demandSourceName)}return{init:function(){e||(n.PubSub.subscribe(r.taskManager+".InitiatedAPICall",function(e){u(e)&&n.Utils.isDefined(e.duringInit)&&(o=e.duringInit)}),n.PubSub.subscribe(r.taskManager+".AdErrorState",function(e){u(e)&&n.Utils.isDefined(e.error)&&(l=e.error)}),n.PubSub.subscribe(r.taskManager+".Engaged",function(e){u(e)&&n.Utils.isDefined(e.duringEngage)&&(s=e.duringEngage,t.log("duringEngage "+s+" on demand "+i.demandSourceName,t.LogLevels.verbose))}),n.PubSub.subscribe(r.taskManager+".CacheUpdateStatus",function(e){u(e)&&n.Utils.isDefined(e.duringCacheUpdate)&&(d=e.duringCacheUpdate)}),n.PubSub.subscribe(r.taskManager+".InitiatedTimeoutAttempt",function(e){u(e)&&n.Utils.isDefined(e.duringAPITimeoutAttempts)&&(c=e.duringAPITimeoutAttempts)}),e=!0,a=t[i.productType].getProductTM())},canEngage:function(){return!o&&!s&&a.canEngage()},canPreload:function(){var e=!l&&!o&&a.isConnected();return i&&i.isInAppBidding||(e=e&&!s),e},canInitCallToApi:function(){return s||o||d||!a.isConnected()?n.Utils.returnRejectedPromise():a.canInitCallToApi()},allowExternalCallToApi:function(){return!c},setConnection:function(e){return a.setConnection(e)},getStatusMsg:function(){return" duringInit:"+o+" duringEngage:"+s+" duringCacheUpdate:"+d+" error state:"+l+" during timeout attempts:"+c+a.getStatusMsg()},getStatus:function(){return{duringInit:o,duringEngage:s,duringCacheUpdate:d,adErrorState:l,timeoutAttempts:c,isConnected:a.isConnected()}},publish:function(e,t){n.PubSub.publish(r.taskManager+"."+e,t)}}}},{}],141:[function(n,e,t){e.exports=function(t,e,s,d){var l=n("./configurationValidator.js")(s,d.DebugLevels,d.errors),c=function(){var n=!0;return e.each(t.mobileSDKSettings,function(e,t){return e.match(/^deviceIds/)&&s.isDefined(t)&&t&&(n=!1),n}),n};return{parseConfiguration:function(e,t,n){var i,r,a=[],o=t.length;for(r=0;r<o;r++)s.isDefined(e[t[r]])||("applicationUserId"!==t[r]||c())&&a.push(t[r]);return 0<a.length?{didSucceed:(i={errMsg:d.errors.missing+JSON.stringify(a)},!1),errMsg:i}:l(e,n)},getDeviceApiLevel:function(){var e=t.mobileSDKSettings.deviceApiLevel;return"android"!==t.mobileSDKSettings.deviceOs||e?"ios"!==t.mobileSDKSettings.deviceOs||e||(e=t.mobileSDKSettings.deviceOSVersion.split(".")[0]):e=t.mobileSDKSettings.deviceOSVersion,e},getDeviceOsVersion:function(){var e=t.mobileSDKSettings.deviceOSVersion;return"android"===t.mobileSDKSettings.deviceOs&&(e=t.mobileSDKSettings.deviceApiLevel?t.mobileSDKSettings.deviceOSVersion:""),e}}}},{"./configurationValidator.js":149}],142:[function(e,t,n){t.exports=function(){return{adVisibleToClose:{name:"adVisibleToClose",id:-5},adClosed:{name:"adClosed",id:100},OWClosed:{name:"OWClosed",id:104},getExternalApplicationConfigurationError:{name:"getExternalApplicationConfigurationError",id:136},openUrlError:{name:"openUrlError",id:114},failedToStartStoreActivity:{name:"failedToStartStoreActivity",id:209},cdnABTestSuccess:{name:"cdnABTestSuccess",id:223},cdnABTestFail:{name:"cdnABTestFail",id:224},cdnABTestException:{name:"cdnABTestException",id:225},latencyTestSuccess:{name:"latencyTestSuccess",id:244},latencyTestFail:{name:"latencyTestFail",id:245},latencyTestException:{name:"latencyTestException",id:246},userClosedBeforeAdVisible:{name:"userClosedBeforeAdVisible",id:151},controllerException:{name:"controllerException",id:153},mismatchAdLoadError:{name:"mismatchAdLoadError",id:206},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},updateTokenFail:{name:"updateTokenFail",id:184},globalsInOldFormat:{name:"globalsInOldFormat",id:274},unauthorizedMessage:{name:"unauthorizedMessage",id:268},omidServiceFailure:{name:"omidServiceFailure",id:270},omidStartSessionRequired:{name:"omidStartSessionRequired",id:364},omidStartSessionSuccess:{name:"omidStartSessionSuccess",id:365},omidFinishSessionRequired:{name:"omidFinishSessionRequired",id:366},omidFinishSessionSuccess:{name:"omidFinishSessionSuccess",id:367},removeContainerError:{name:"removeContainerError",id:190},linkActivationOnAd:{name:"linkActivationOnAd",id:324},auidFail:{name:"auidFail",id:197},patchOrientation:{name:"patchOrientation",id:343},initFailed:{name:"initFailed",id:344},setAdDisplayAlreadyAdShown:{name:"setAdDisplayAlreadyAdShown",id:350}}}},{}],143:[function(e,t,n){t.exports=function(){var a={},o="loadTimer",r={};function s(e,t){return e&&t?e+"."+t:null}function d(e,t){var n=s(e,t);return r.hasOwnProperty(n)?{timeElapsed:Date.now()-r[n],columnName:"custom_c"}:{timeElapsed:Date.now(),columnName:"custom_d"}}return{startLoadTimer:function(e,t){var n=s(e,t);n&&(a.hasOwnProperty(n)?a[n][o]&&window.timerService.stopTimer(a[n][o]):a[n]={},a[n][o]=window.timerService.startTimer())},stopLoadTimer:function(e,t){var n=s(e,t);if(!(n&&a[n]&&a[n][o]))return-1;var i=a[n][o],r=window.timerService.stopTimer(i);return delete a[n][o],r},clearInstanceTimers:function(e,t){var n=s(e,t);if(n&&a[n]){var i=a[n];for(var r in i)i.hasOwnProperty(r)&&window.timerService.stopTimer(i[r]);delete a[n]}},setLoadStartTimeForInstance:function(e,t,n){var i=s(e,t);!r.hasOwnProperty(i)&&n&&(r[i]=n)},getTimeElapsedFromLoadForInstance:d,clearLoadStartTimeForInstance:function(e,t){var n=s(e,t);r.hasOwnProperty(n)&&delete r[n]},extendEventDataWithElapsedLoadTime:function(e,t,n){var i=d(e,t);return n[i.columnName]=i.timeElapsed,n}}}},{}],144:[function(e,t,n){t.exports=function(t){var n="LoadedCreatives | ",i=t.AdUtils,r=[];function a(e){return e?void 0!==l(i.getAdId(e),e):(c("in _isExistAd without ad"),!1)}function o(){return r.length}function s(e,t){return e.productType===t.productType&&(!t.demandSourceName||e.demandSourceName===t.demandSourceName)}function d(t,n){return function(e){return s(e,n)&&i.getAdId(e)==t}}function l(e,t){var n=d(e,t),i=r.filter(n);return 0<i.length?i[0]:void 0}function c(e){t.log(n+e)}return{isExistAd:a,addAd:function(e){return c("_addAd"),e?a(e)?(c("_addAd ad already exist"),!1):(r.push(e),!0):(c("_addAd ad is undefined"),!1)},removeAdById:function(e,t){c("_isExistAd adId = "+e);var n=d(e,t),i=o();return r=r.filter(function(e){return!n(e)}),i!==o()},getAdById:l,getAds:function(t){return r.filter(function(e){return s(e,t)})},getAdsByProductType:function(t){return r.filter(function(e){return e.productType===t.productType})},size:o,toArray:function(){return r.slice()},printAll:function(){r.forEach(function(e){t.log("adViewId "+e.adViewId)})}}}},{}],145:[function(t,e,n){e.exports=function(e,r){var a=t("../DemandSource/DemandEntityBuilder.js"),o=e&&e.instancesMap,s=e&&e.waterfallMap;return{createDemandEntityConfigObj:function(e){var t=function(e,t){var n=o&&o[r.sspProductNames[e]];if(n)for(var i=0;i<n.length;i++)if(-1!==n[i].instances.indexOf(t))return{demandGroupName:n[i].demandGroupName,isInstance:!0}}(e.productType,e.demandSourceName)||{},n=!0===t.isInstance?r.demandSourceType.instance:r.demandSourceType.demandSource,i={demandGroupName:t.demandGroupName,demandSourceName:e.demandSourceName,demandType:n,isInAppBidding:e.isInAppBidding,demandSourceId:e.demandSourceId,waterfallPosition:function(e,t){var n=s&&s[r.sspProductNames[e]];if(n)return n[t]}(e.productType,e.demandSourceName),originalDemandSourceName:e.originalDemandSourceName,adSize:e.adSize};return new a({productType:e.productType},i)}}}},{"../DemandSource/DemandEntityBuilder.js":114}],146:[function(e,t,n){t.exports=function(i,r,a,n){var o="$$";return{handler:function(e){return!!((t=e)&&"string"==typeof t.data&&0<t.data.length)&&(0===e.data.indexOf(o)?function(e){var t=e.slice(o.length);if(!t)return!1;var n=a.getParams(t);return a.isDefined(n.event)?(r.log("received event: "+n.event,r.LogLevels.verbose),i.publish("SDKController."+n.event,[n]),!0):a.isDefined(n.name)&&a.isDefined(n.parameters)?(r.log("received event: "+n.name,r.LogLevels.verbose),i.publish("SDKController."+n.name,[n.parameters]),!0):void 0}(e.data):function(t){try{var e=JSON.parse(t);return a.extend(e.arguments,{callback:n(e.id)}),i.publish("SDKController."+e.method,[e.arguments]),!0}catch(e){r.log("SDKController | unable to parse message: "+JSON.stringify(t),r.LogLevels.error)}return!1}(e.data));var t}}}},{}],147:[function(Si,e,t){function R(p,v,m){var h="SDKController | ",o=Si("../../patches/PatchAppOrientation"),i=Si("./MessageHandler"),c=Si("../../presenter/uiConfig.js"),n=Si("../../components/Logger.js")(p.Utils),r=Si("../AdUnitManager/AdUnitGlobals.js")(m),e=Si("../AdUnitManager/LibsManager.js")(p.Utils),t=Si("../../components/DisplayedAdManager.js"),a=Si("../AdUnitUrl.js")(r,p.Utils),s=Si("./mainConfig.js")(),d=new(Si("../../components/ExternalConfig")),l=new(Si("../../components/BlacklistService"))(m),b=new(Si("../../components/FrameHelper.js"))(n,v),u=Si("./ConfigurationHelper.js"),f=Si("../../components/AdOrientationManager"),g=Si("../../components/containers/WebViewManager.js"),S=Si("../../components/containers/AdViewsManager.js"),y=Si("../../components/containers/BannerExternalContainer.js"),A=Si("./sessionConfig")(),C=Si("../../components/NativeLifeCycleEventsConstants.js"),D=new(Si("../../components/NotchFactory.js"))(v,m),I=Si("../../components/token/TokenService.js"),w=Si("../UserSegmentation/SegmentationManager"),P=Si("../UserSegmentation/SegmentationAllocator.js"),T=Si("../../components/NativeAPIAdapter.js"),O=Si("../../constants/SDKFeatureNames"),F,x,L,N,U,V,M,E,k,K,B,R,j,W,_,G,H=!1,q,Q,J=p.Utils,z=p.PubSub,X=null,$,Y=!1,Z=!0,ee=!1,te=m.CB,ne=m.RV,ie=m.OW,re=m.IS,ae=m.BN,oe=m.errors,se=m.videoStates,de=m.closeButtonStates,le=m.featureCompatibilityMap,ce=m.confirmCloseMsg,ue=m.requiredDeviceInfo,fe=m.requiredAppInfo,ge=m.optionalAppInfo,pe={v:"3.1.40",controllerbn:"242",controllerId:(new Date).getTime()+"_"+Math.random(),controllerTimeLoaded:(new Date).getTime(),mobileSDKSettings:{protocol:null,defaultProtocol:null,securedProtocol:null,domain:null,overrideDebug:!1,defaultDebug:0,debug:0,appOrientation:null,mobileCarrier:null,connectionType:null,iphoneAppOnIpadDevice:null,deviceOs:"",SDKVersion:null,deviceOSVersion:null,deviceApiLevel:null,bundleId:null,deviceOEM:null,deviceScreenScale:null,"deviceScreenSize[width]":null,"deviceScreenSize[height]":null,"deviceIds[OpenUDID]":null,"deviceIds[IFA]":null,"deviceIds[IDFV]":null,"deviceIds[SERIAL]":null,"deviceIds[AndroidID]":null,"deviceIds[IMEI]":null,"deviceIds[AID]":null,deviceWidthDP:null,deviceHeightDP:null,deviceLanguage:null,deviceModel:null,diskFreeSize:null,geoLocation:null,isLimitAdTrackingEnabled:null,unLocked:null,gpi:null,webviewType:null,allowArbitraryLoads:null,allowArbitraryLoadsInWebContent:null,mcc:null,mnc:null,appVersion:null,batteryLevel:null,safeAreaInsets:null},applicationSettings:{preCache:"device",applicationKey:null,applicationUserId:null,numOfCampaigns:null,campaignId:null,pageSize:null,landingId:null,page:null,applicationUserGender:null,applicationUserAgeGroup:null,applicationUserCreationDate:null,applicationUserCreationDateSignature:null,useClientSideCallbacks:null,SDKPluginType:null,disableCache:null,showDeliveryLimitationsLog:null,country:null,admin:null,placementId:null,consent:null,skd:null},configMapping:{jb:function(){return pe.mobileSDKSettings.unLocked}},controllerConfig:{fpf:null,destinationMap:null,isSecured:null,segmentId:null,segmentName:null,instancesMap:null,abt:null,waterfallMap:null},userType:SuperSonicGlobalConfig.userType},ve={localTime:function(){return(new Date).getTime()},timezoneOffset:function(){return(new Date).getTimezoneOffset()}},me="mobileController.min.css",he=SuperSonicGlobalConfig.mobileSDKSettings.isProd?"/versions/"+pe.v+"/"+me:pe.v+"/"+me,be,Se,ye,Ae,Ce,De,Ie,we=!1,Pe=!1,Te=0,Oe=3,Fe,xe={defaultBehavior:0,adunitResponsibility:1},Le={close:1,nextFrame:2},Ne=m.defaultOrientation,Ue={none:0,device:1,controller:2},Ve=c.style.defaultControlFrames,Me=m.blockedProductsPerApiLevel,Ee=m.storeSearchKeys,ke={scrollHeight:""},Ke={RewardedVideo:{},Interstitial:{},OfferWall:xe.defaultBehavior,Banner:xe.defaultBehavior},Be={RewardedVideo:{},Interstitial:{},OfferWall:de.close,Banner:de.closeBanner},Re={RewardedVideo:de.close,Interstitial:de.close,OfferWall:de.close,Banner:de.closeBanner},je={cdns:[{cdnName:"a.akamaihd.net",assets:["https://akm.ssacdn.com/users/cdn/jsonFile.json","https://akm.ssacdn.com/users/cdn/videoFile.mp4","https://akm.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"cncn.ssacdn.com",assets:["https://cncn.ssacdn.com/users/cdn/jsonFile.json","https://cncn.ssacdn.com/users/cdn/videoFile.mp4","https://cncn.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"itcn.ssacdn.com",assets:["https://itcn.ssacdn.com/users/cdn/jsonFile.json","https://itcn.ssacdn.com/users/cdn/videoFile.mp4","https://itcn.ssacdn.com/users/cdn/imgFile.png"]}]},We=[{url:"https://pm-gateway.supersonicads.com/test",method:"GET",region:"all"},{url:"https://init.supersonicads.com/admin/healthCheck",method:"GET",region:"all"},{url:"https://ow-gateway.supersonicads.com/delivery/mobilePanel.php",method:"GET",region:"all"}],_e,Ge,He=!1,qe=m.appExtConfigPath,Qe=m.appExtConfigPathStaging,Je=Math.floor(100*Math.random()),ze=!1,Xe=c.templates.mainDefaultTemplate,$e=c.templates.defaultDialogBoxTemplate,Ye=c.templates.defaultNavigationTemplate,Ze=c.templates.loaderOWTemplate,et=c.templates.loaderOWOfferTemplate,tt=p.Eventics,nt=Si("../../modules/SDKController/EventCategories")(),it=function(e,t){var n=R.getDisplayedAdType(),i={productType:"UnKnown",action:"stopTiming",eventParam:{eName:nt.adClosed,data:{eNameStart:nt.adVisibleToClose}}};if(t&&t.customData&&t.customData.click&&v.extend(i.eventParam.data,t.customData.click),t&&t.frameType&&(i.eventParam.data.frameType=t.frameType),e&&(i.eventParam.data.generalMessage=e),n){n===m.OW&&(i.eventParam.eName=nt.OWClosed,q.callSDKFunction("removeCloseEventHandler")),i.productType=n;var r=R.getDisplayedAdDemandName();r&&(i.demandSourceName=r);var a={productType:i.productType,demandSourceName:i.demandSourceName};t&&t.customData&&"object"==typeof t.customData&&v.extend(a,t.customData),a.ad=R.get(),z.publish("SDKController.Analytics",[i]),z.publish("SDKController.adClosed",[a])}else z.publish("SDKController.Analytics",[i])},rt=function(e,t,n,i){var r,a=e.length,o=!0,s=[],d=null;for(r=0;r<a;r++)J.isDefined(t[e[r]])||(s.push(e[r]),o=!1);return o||(d=oe.missing+JSON.stringify(s)+" in "+n,J.isDefined(i)&&i&&q.callSDKFunction(i,{errMsg:d}),q.log(d,q.LogLevels.error)),{didSucceed:o,errMsg:d}},at=function(){v.fn.textfill2=function(e){var t,n,i=e.maxFontPixels,r=e.maxHeight,a=e.maxWidth,o=void 0!==e.parentContainer?v(e.parentContainer):null,s=v(this),d=null!==o?o.height():v(this).parent().height(),l=null!==o?o.width():v(this).parent().width();return void 0!==r&&(d=r),void 0!==a&&(l=a),s.each(function(){for(i=e.maxFontPixels;v(this).css({"font-size":i}),i-=1,e.lineHeight&&o.css({"line-height":e.lineHeight+"em"}),t=v(this).height(),n=v(this).width(),d<t||l<n&&3<i;);}),this},v.fn.textWidth=function(){var e,t=v(this).children(),n=v('<span style="display: inline-block;" />');return t.wrap(n),e=t.parent().width(),t.unwrap(),e}},ot=function(){z.subscribe(te+".initProducts",function(e,t,n){v.when(bt(e)).then(function(){"use strict";J.isDefined(t)&&q.callSDKFunction(t),St(e)},function(e){"use strict";J.isDefined(n)&&q.callSDKFunction(n,{errMsg:e})})}),z.subscribe(te+".nativeNavigationPressed",function(){if(R.isDisplayed()){var e,t=R.getDisplayedAdType(),n=R.getDisplayedAdDemandName();if(!ee&&((e=d.getABTestConfiguration(t)).hasOwnProperty("disableBB")&&!e.disableBB))(n?Ke[t][n]:Ke[t])===xe.adunitResponsibility?Ft({name:"backButtonPressed"}):Ht()}}),z.subscribe(te+".engageEnd",function(e){if(!lt())if("forceClose"===e.action)it(),Kt(!1,!1),W.onEngageEnd();else if("secondaryClose"===e.action){var t=R.getDisplayedAdType();k.returnFromNavigationMode(Ct,ke,t,It),t===ie&&z.publish("SDKController.AdClosed",[R.get()])}}),z.subscribe(te+".failedToStartStoreActivity",function(e){if(e){q.log("failedToStartStoreActivity | params: "+JSON.stringify(e),q.LogLevels.info);var t={};t.rvnomoreoffersreason=decodeURIComponent(e.url);var n=R.getDisplayedAdType();n&&(t.productType=n),Ae.trackEvent(nt.failedToStartStoreActivity,{generalMessage:decodeURIComponent(e.errMsg)},t)}}),z.subscribe(te+".interceptedUrlToStore",function(e){R.isDisplayed()&&Ft({name:"interceptedUrlToStore",intercept:!0})}),z.subscribe(te+".pageFinished",function(){Ft({name:"pageFinished"})}),z.subscribe(te+".enterBackground",function(e){q.log("entered BG");var t={name:"enterBackground"};e&&J.isDefined(e.action)&&(t.action=e.action),Ft(t)}),z.subscribe(te+".enterForeground",function(e){var t=E.getContainerState();q.log("entered FG | webview is "+JSON.stringify(t));var n={name:"enterForeground"};e&&J.isDefined(e.active)&&(n.active=e.active),t.engaged&&t.opened&&pe.mobileSDKSettings.deviceOs===m.deviceOs.android&&!t.standalone&&(R.isDisplayed()&&it(),Kt(!1,!1)),Ft(n)}),z.subscribe(te+".viewableChange",function(e){var t={name:"viewableChange"};if(e&&J.isDefined(e.isViewable)){var n=R.getDisplayedAdType();if("Banner"===n&&(e.changeReason===m.viewableChangeReasons.storeKitClose||e.changeReason===m.viewableChangeReasons.storeKitOpen))return void q.log("viewableChange from Banner storeKit - ignored",q.LogLevels.info);if(we=e.isViewable,q.StoreKitService.isStoreKitVisible()&&(Ft({name:"viewableChangeInSK",isViewable:we}),we))return;q.SKOverlayManager.isSKOverlayVisible()&&Ft({name:"viewableChangeInOV",isViewable:we}),q.log("viewableChange to:"+e.isViewable),J.isDefined(e.webview)&&"main"!==e.webview||E.setContainerVisibility(e.isViewable),t.isViewable=e.isViewable,R.isDisplayed()&&jt(),J.isDefined(e.webview)&&(t.webview=e.webview),n&&(t.productType=n),e.changeReason&&(t.changeReason=e.changeReason)}Ft(t),e&&J.isDefined(e.isViewable)&&E.triggerRedraw()}),z.subscribe(te+".deviceStatusChanged",function(e){var t=v.extend({name:"deviceStatusChanged"},e);Ft(t),p.Utils.isDefined(e.connectionType)&&(tt.updateBaseData({connectionType:e.connectionType}),Z="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),z.subscribe(te+".parseBandwidth",function(e){q.log(JSON.stringify(e),3)}),z.subscribe(te+".getBandwidthFailed",function(e){q.log(JSON.stringify(e),3),q.log("getBandwidth Failed",q.LogLevels.error)}),z.subscribe("SDKController.GetConfig",function(e){e&&e.productType&&z.publish(e.productType+".GetConfig",[e])}),z.subscribe("SDKController.GetCompletionOffers",function(e){e&&e.productType&&z.publish(e.productType+".GetCompletionOffers",[e])}),z.subscribe("SDKController.ActionClick",function(e){e&&e.productType&&z.publish(e.productType+".ActionClick",[e])}),z.subscribe("SDKController.OpenUrl",function(e){rt(["url","method"],e,"openUrl").didSucceed?(q.log("Request to open external url",q.LogLevels.info),Dt(e)):q.log("error calling open url with "+JSON.stringify(e),q.LogLevels.error)}),z.subscribe("SDKController.nativePixel",function(e){rt(["url"],e,"nativePixel").didSucceed?(q.log("Request to send click in native api",q.LogLevels.info),$n(e.url)):q.log("error sending safe click "+JSON.stringify(e),q.LogLevels.error)}),z.subscribe("SDKController.FirePixel",function(e){rt(["url"],e,"FirePixel").didSucceed?(q.log("Request to fire pixel from controller",q.LogLevels.info),"native"===e.type&&$n(e.url)||Yn(e)):q.log("error firing pixel "+JSON.stringify(e),q.LogLevels.error)}),z.subscribe("SDKController.adEventNotification",function(e){q.log("ad notified controller with event: "+JSON.stringify(e),q.LogLevels.info),rt(["eventName","productType","dsName"],e,"adEventNotification").didSucceed&&Zn(e.eventName,e.productType,e.dsName,e.extData)}),z.subscribe("SDKController.hideClose",function(e){var t=$.getAdById(q.AdUtils.getAdId(e),e);if(t){var n=E.getAdViewByAd(t);n.data("close",!1),E.isViewDisplayed(n,t)&&yt()}else q.log("line[1196]: ERROR",q.LogLevels.error)}),z.subscribe("SDKController.AdClose",function(e){e.ignoreClick?zt():Ht(e)}),z.subscribe("SDKController.closeAdunit",function(e){it(),Kt(!1)}),z.subscribe("SDKController.setBackButtonState",function(e){if(e&&e.state&&e.productType){var t="default"===e.state?xe.defaultBehavior:xe[e.state];e.demandSourceName?Ke[e.productType][e.demandSourceName]=t:Ke[e.productType]=t}}),z.subscribe("SDKController.setCloseButtonState",function(e){Bn(e)}),z.subscribe("SDKController.ScrollHeight",function(e){var t,n,i;p.Utils.isDefined(e.value)&&(t=e.value,q.log("scroll height is: "+t,q.LogLevels.info),v.when(qt()).then(function(e){i=R.getDisplayedAdType(),n=i&&"application"===Ne[i]&&V.isAppOrientation("portrait")?Math.max(e.height,e.width):i&&J.isDefined(i)&&"application"===Ne[i]&&V.isAppOrientation("landscape")?Math.min(e.height,e.width):e.height,t<n&&(t=n),q.log("min scroll height is: "+n+"scroll height was set to: "+t+" screen height: "+e.height,q.LogLevels.verbose),ke.scrollHeight=t,pe.mobileSDKSettings.deviceOs!==m.deviceOs.android&&v("body").css("height",ke.scrollHeight)}))}),z.subscribe("SDKController.scrollTop",function(){q.log("scrollTop",q.LogLevels.verbose),setTimeout(function(){v("html,body").scrollTop(0)},1e3)}),z.subscribe("SDKController.getScreenSize",function(){v.when(qt()).then(function(e){Ft({name:"screenSize",width:e.width,height:e.height,orientation:e.orientation,scrollTop:e.scrollTop})})}),z.subscribe("SDKController.showNoConnectionMessage",function(){var e={productType:ie,message:"You are not connected to the internet, please connect and try again.",yes:"close",no:"OK"};q.alert(e)}),z.subscribe("SDKController.GetDeviceVolume",function(e){J.isDefined(e.callback)&&Vn(e.callback)}),z.subscribe(C.serviceCallback+"."+C.AndroidEvents.onDestroy,function(e){q.log("SDKController | received event | onDestroy",q.LogLevels.verbose),lt()?q.log("SDKController | onDestroy - shouldAvoidHandleFrameClose, with params: "+JSON.stringify(e),q.LogLevels.verbose):ct()}),z.subscribe(m.CB+".unauthorizedMessage",function(e){Ae.trackEvent(nt.unauthorizedMessage,{generalMessage:JSON.stringify(e)}),q.log("SDKController | Failed to authorize message",q.LogLevels.error)}),z.subscribe(m.CB+".linkActivationOnAd",function(e){e&&e.url&&Ae.trackEvent(nt.linkActivationOnAd,{generalMessage:e.url})}),z.subscribe("SDKController.onOmidStartSessionRequired",function(e){Ae.trackEvent(nt.omidStartSessionRequired,{generalMessage:e})}),z.subscribe("SDKController.onOmidStartSessionSuccess",function(e){Ae.trackEvent(nt.omidStartSessionSuccess,{generalMessage:e})}),z.subscribe("SDKController.onOmidFinishSessionRequired",function(e){Ae.trackEvent(nt.omidFinishSessionRequired,{generalMessage:e})}),z.subscribe("SDKController.onOmidFinishSessionSuccess",function(e){Ae.trackEvent(nt.omidFinishSessionSuccess,{generalMessage:e})}),z.subscribe("SDKController.onOmidServiceFailure",function(e){Ae.trackEvent(nt.omidServiceFailure,{generalMessage:e})}),z.subscribe("SDKController.removeContainerError",function(e){e&&e.errMsg&&Ae.trackEvent(nt.removeContainerError,{callFailReason:e.errMsg})})};function st(){_=Si("./videoStateHandler.js")(p.PubSub,q),G=Si("./nativeConfigHandler.js")(p.PubSub,q)}function dt(){var e={productChance:(q.getEnv(),1),protocol:pe.mobileSDKSettings.protocol?pe.mobileSDKSettings.protocol:"https:",baseData:{productType:"controller"}};Ae=tt.createEventic(e,q.EventsManager)}function lt(){var e=Wn(R.get());return!e||!p.Utils.isFunction(e.shouldAvoidHandleFrameClose)||e.shouldAvoidHandleFrameClose()}function ct(){q.log("SDKController.js | handleFrameDestroyed",q.LogLevels.verbose),R.isDisplayed()&&it(m.adClosedErrorReason.unexpectedCloseActivityDestroy),Kt(!1,!1),$t()}var ut=function(){v("body").append(Xe+$e+Ye+Ze);for(var e="",t=0;t<10;t++)e+=et;v(".loaderOW .offers").prepend(e),en()};function ft(){z.subscribe(te+".acknowledgeMessage",function(e){L.acknowledgeMessage(e)})}function gt(e){var t=new i(p.PubSub,q,p.Utils,In);p.Msg.init(q,t.handler,tn),z.init();var n=Si("../SDKInterface.js");Se=new n(pe.mobileSDKSettings,m,q,e),L=new T(q,p,Se,v),ft()}function pt(){n.init(pe.mobileSDKSettings.deviceOs,Se,pe.mobileSDKSettings.debug,q.PixelTrackingService.firePixel),z.subscribe("SDKController.log",function(e){J.isDefined(e.debugLevel)&&J.isDefined(e.msg)&&("string"==typeof e.msg&&(e.msg=decodeURI(e.msg)),q.log(e.msg,e.debugLevel,e.origin))})}var vt=function(){e.init(n,v,q.Cache),r.init(n,pe.mobileSDKSettings,v,q.Cache,an(),a,e,q.getEnv(),p,nt),l.init(n),R=new t(q,Ae,nt,m),q.ProductRouter=Si("../ProductRouter.js")(p,q,m),q.ProductRouter.initModule(),q.OfferWall.init({supplyConfig:q.SupplyConfigurations.getOfferWallConfig()})};function mt(){q.HTTPService.init(),q.OrientationService.init(Ae),q.GDPRService.init(),ht()&&q.RingerSwitchService.init(),q.NativeLifeCycleEventsService.init(),gn();var e=Si("../../components/containers/WebView"),t=Si("../../components/containers/BackgroundController"),n=Si("../../components/containers/NavigationModeView"),i=Si("../../components/IframeManager"),r=Si("../../components/containers/BannerExternalAdViewService"),a=new t(q,m,c),o=Si("../../components/containers/WPADUtils")(q),s=new e(p,q,c.style.forceCloseProperties,m,a,U),d=new i(q,m,b,R),l=new g(p,q,m,R);E=new S(q,d,l,s,R),k=new n(q,E,s),B=new r(p,q,m,R),K=new y(p,q,B,o.generateBannerAdViewId()),j=new I(p,q,m,Ae,nt),q.AppUserIdService.init(Ae),(F=new w(p,q)).init(),x=new P(F),q.AndroidNomediaFileHandler.init(Ae),q.DeviceDataService.init(Ae)}function ht(){return pe.mobileSDKSettings.deviceOs===m.deviceOs.ios&&"wk"===pe.mobileSDKSettings.webviewType}var bt=function(e){var t=new v.Deferred;q.log("Products info received: "+JSON.stringify(e),q.LogLevels.info);var n,i,r,a=ge.length,o=[];for(n=0;n<a;n++)J.isDefined(e[ge[n]])||(pe.applicationSettings[ge[n]]=null);for(i in e)e.hasOwnProperty(i)&&i.match(/^custom/)&&o.push(i);return on(o),(r=M.parseConfiguration(e,fe,pe.applicationSettings)).didSucceed?t.resolve():t.reject(r.errMsg),t.promise()},St=function(e){v.each(e.products,function(e,t){p.hasOwnProperty(t)&&J.isFunction(p[t].init)&&p[t].init()})},yt=function(){ye.addClass("ssaOnAdUnitCloseVisible")},At=function(){ye.removeClass("ssaOnAdUnitCloseVisible")},Ct=function(e,t,n){if(kt()&&Ft({name:"dialogBoxAboutToClose",shouldResume:e}),!t||!kt()){if(v(".dialogBox").css("visibility","hidden"),v("#ssaDialogBoxOverlay").css("display","none"),J.isFunction(n))return void n.call();b.getDisplayedAdFrame()&&Ft({name:"showFrame"})}Ce.fadeOut(100,function(){v(".dialogBox").css("visibility","hidden"),v("#ssaDialogBoxOverlay").fadeOut(100,function(){J.isFunction(n)?n.call():b.getDisplayedAdFrame()&&Ft({name:"showFrame"})})})},Dt=function(t,n){var i,r=[],e=null,a=null;function o(){var e=R.getDisplayedAdType();R.isDisplayed()&&z.publish("SDKController.AdOpened",[{productType:e}]),n&&n.call(null)}a=z.subscribe(te+".openUrlFailure",function(e){clearTimeout(i),z.clearHandlers(r),z.unsubscribe(a);var t=J.isDefined(e.errMsg)?e.errMsg:"Unknown reason for error",n=R.getDisplayedAdType()||"";Ae.trackEvent(nt.openUrlError,{generalMessage:t},{productType:n}),q.log("SDK failed to open url",q.LogLevels.verbose)}),e=ci()&&"webview"===t.method?z.subscribe(te+".openUrlSuccess",function(){if(clearTimeout(i),z.clearHandlers(r),t.controls){var e=R.getDisplayedAdType();k.changeToNavigationMode(Ct,ye,ke,e,It)}o()}):z.subscribe(te+".viewableChange",function(e){clearTimeout(i),z.clearHandlers(r),!J.isDefined(e.isViewable)||e.isViewable||pe.mobileSDKSettings.deviceOs===m.deviceOs.android&&"main"!==e.webview||o()}),r.push(a),r.push(e),"storeKit"===t.method&&(pe.mobileSDKSettings.deviceOs!==m.deviceOs.ios||q.isLegacy({ios:"5.17",android:"99"})?t.method="external_browser":t.method="store"),"webview"===t.method&&t.controls?pe.mobileSDKSettings.deviceOs===m.deviceOs.android?q.callSDKFunction("openUrl",{url:t.url,method:"webview"},"openUrlSuccess","openUrlFailure"):q.callSDKFunction("openUrl",{url:t.url,method:t.method,controlFrames:Ve},"openUrlSuccess","openUrlFailure"):q.callSDKFunction("openUrl",{url:t.url,method:t.method,appId:t.appId,viewUniqueId:t.viewUniqueId},"openUrlSuccess","openUrlFailure"),i=setTimeout(function(){z.unsubscribe(e),"ios"===q.getApiData({deviceOs:1}).deviceOs&&parseFloat(q.getConfigurationHelper().getDeviceOsVersion())<8&&n&&n.call(null)},500)},It=function(){ye.unbind("touchend").bind("touchend",Ht),wt(Le.close),Ie.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault(),z.publish("SDKController.dialogBoxResume",[R.get()]),Ct(!0,!0)})},wt=function(n){De.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault();var t=Z?n:Le.close;switch(z.publish("SDKController.dialogBoxExit",[R.get()]),t){case Le.nextFrame:Ft({name:"moveToNextFrame"}),Ct(!1,!0);break;case Le.close:R.isDisplayed()?(Ft({name:"confirmCloseClicked"}),Ct(!1,!0)):Kt(!0)}})};function Pt(t){q.log(h+"broadcastMessageToAllAdViews"),K.checkStatusOfAdView().then(function(e){e&&e.isExternalAdViewInitiated&&K.sendMessageToExternalAdView(t)}),E.sendMessageToAllAdViews(t)}function Tt(e){return e===m.BN&&!q.isBannerAndLoadWhileShowSupported(e)}function Ot(e,t){if(t)return t.settings.viewType===m.viewTypes.externalView&&Tt(t.productType)?K.sendMessageToExternalAdView(e):(q.log("sendMessageToDisplayedAdView | posting to DISPLAYED ad unit"),E.sendMessageToAdView(e,t));var n="";try{n=JSON.stringify(e)}catch(e){}q.log("sendMessageToDisplayedAdView | can't find displayed ad. "+n)}var Ft=function(e,t){if("string"==typeof e)throw new Error("postAdUnitEvent message type not supported "+typeof e);return q.log(h+"postAdUnitEvent | before posting to ad unit"+JSON.stringify(e)),t?Pt(e):Ot(e,R.get())};function xt(){var e=R.getDisplayedAdType(),t=R.getDisplayedAdDemandName();q.log("in setDefaultBackAndCloseBehavior with product "+e+" and demand "+t,q.LogLevels.verbose),e&&(t?(Be[e][t]=de.close,Ke[e][t]=xe.defaultBehavior):(Be[e]=de.close,Ke[e]=xe.defaultBehavior))}function Lt(e){for(var t=v("#ssaDialogBox"),n=t[0]&&t[0].className.split(" "),i=0;i<n.length;i++){var r=n[i];r!==m.styleAccordingToProtocol.secured&&r!==m.styleAccordingToProtocol.unsecured||t.removeClass(r),r.match(/template.*/)&&t.removeClass(r)}var a=pe.mobileSDKSettings.protocol===m.protocol.https?m.styleAccordingToProtocol.secured:m.styleAccordingToProtocol.unsecured;t.addClass(a),e.settings.templateid&&t.addClass("template"+e.settings.templateid)}function Nt(e){e?At():yt()}function Ut(){Et()}var Vt=function(e,t){var n=v.Deferred();return q.log("SDKController | onAdUnitOpen"),wt(Le.close),E.displayContainer(e),v.when(Qt(e)).then(function(){Xt(),Lt(e),E.handleScreenVisible(t,e),n.resolve()}),n.promise()};function Mt(e){e&&(q.ImpressionsCounterService.setInstanceImpressionsCounter(e),j.updateToken(q.ImpressionsCounterService.getTokenCounters()))}var Et=function(){var e=R.get(),t=R.getDisplayedAdType();try{Pe=!0,clearTimeout(Fe),e?Wt():q.log("_shouldReceiveMessage"),e&&e.settings&&q.LastSeenCampaignService.setLastDisplayedAdCampaignId(e.cid,e.settings.landingId,t),Mt(e),q.log("SDKController | onAdVisible"),z.publish("SDKController.AdVisible",[e]),Ft({name:"adVisible",productType:t})}catch(e){throw q.log("SDKController | onAdVisible | Exception"),e}};function kt(){return J.isVisible(Ce)}var Kt=function(e,t){q.RingerSwitchService.isInitiated()&&q.RingerSwitchService.stopListener(),ke.scrollHeight="",v("body").css("height",ke.scrollHeight);var n=function(){Bt(t)};kt()?Ct(!1,e,n):n()};function Bt(e){var t=function(){},n=R.get();if(R.reset(),e&&E.displayLoader(n.productType),q.callSDKFunction("setBackButtonState",{state:Ue.controller}),e?At():t=Rt.bind(this,n),n)return n.engaged=!0,void bn(n,{preloadNextInBG:!e},t);E.unloadProductFromContainer(),t()}var Rt=function(e){q.log("SDKController | ad unit close done",q.LogLevels.verbose),e&&e.isWPAD?(q.log("SDKController | ad unit close done wpad",q.LogLevels.verbose),E.hideContainer(e)):(setTimeout(function(){q.log("SDKController | closing webview with currentAd "+JSON.stringify(e),q.LogLevels.verbose),E.hideContainer(e)},250),e&&e.settings&&e.settings.setContainerBGColorBlack&&E.setContainerBGColorTransparent())},jt=function(){if(!ee){var e,t=R.getDisplayedAdType(),n=R.getDisplayedAdDemandName(),i=R.getDisplayedAdSettings();e=t===m.OW?i&&(i.OLXD||0===i.OLXD)?1e3*i.OLXD:m.closeAndBackDisabledTimerOW:m.closeAndBackDisabledTimer;var r={eventParam:{eName:nt.userClosedBeforeAdVisible},action:"startTiming",productType:t,demandSourceName:n};z.publish("SDKController.Analytics",[r]),_t(),ee=!0,Fe=setTimeout(function(){Wt()},e)}},Wt=function(){Gt(),ee=!1},_t=function(){v("#ssaNavigatorCloseButton").addClass("invisible")},Gt=function(){v("#ssaNavigatorCloseButton").removeClass("invisible")},Ht=function(e){E.hideLoader(),zt();var t=R.getDisplayedAdType(),n=R.getDisplayedAdDemandName();if(!t)return it(null,e),void Kt(!1);if(!Pe&&!ee){var i={eventParam:{eName:nt.userClosedBeforeAdVisible},action:"stopTiming",productType:t,demandSourceName:n};z.publish("SDKController.Analytics",[i])}switch(Yt(t)){case de.close:q.ViewsManager.waitForAllViews().then(function(){$t(),it(null,e),Kt(!1)});break;case de.closeBanner:$t(),Kt(!1);break;case de.confirm:wt(Le.close),q.alert(Zt(productType,n));break;case de.confirmNextFrame:wt(Le.nextFrame),q.alert(Zt(productType,n));break;case de.nextFrame:Ft({name:"moveToNextFrame"});break;case de.ignore:}},qt=function(){var n="deviceScreenSize[width]",i="deviceScreenSize[height]",r=m.appInfo.orientation.portrait,a=m.appInfo.orientation.landscape,o=m.defaultOrientation,s=pe.mobileSDKSettings[n],d=pe.mobileSDKSettings[n],l=new v.Deferred;return v.when(q.OrientationService.oldGetOrientation()).then(function(e){var t=R.getDisplayedAdType();!t||o[t]!==a&&o[t]!==r||(e=o[t]),e===a&&(s=Math.max(pe.mobileSDKSettings[n],pe.mobileSDKSettings[i]),d=Math.min(pe.mobileSDKSettings[n],pe.mobileSDKSettings[i])),e===r&&(s=Math.min(pe.mobileSDKSettings[n],pe.mobileSDKSettings[i]),d=Math.max(pe.mobileSDKSettings[n],pe.mobileSDKSettings[i])),pe.mobileSDKSettings.deviceOs===m.deviceOs.android&&(s/=pe.mobileSDKSettings.deviceScreenScale,d/=pe.mobileSDKSettings.deviceScreenScale),l.resolve({width:s,height:d,orientation:e,scrollTop:v(window).scrollTop()})}),l.promise()},Qt=function(){var t,n=new v.Deferred;return we?n.resolve():t=z.subscribe(te+".viewableChange",function(e){e&&J.isDefined(e.isViewable)&&e.isViewable&&(q.log("SDKController | viewableChange(screenVisible) to:"+e.isViewable,q.LogLevels.info),z.unsubscribe(t),n.resolve())}),n.promise()},Jt=function(e){if(e.productType!==m.BN||e.isInAppBidding)q.isBannerAndLoadWhileShowSupported(e.productType)&&R.set(e),E.onAdUnitLoaded(e,Nt,Ut);else{K.onBannerViewLoaded(function(){R.set(e)},Ut)}},zt=function(){q.callSDKFunction("removeCloseEventHandler",q.ViewsManager.getDisplayWebViewParams(!1))};function Xt(){q.NativeLifeCycleEventsService.startNotify(C.AndroidEvents.onDestroy)}function $t(){q.NativeLifeCycleEventsService.stopNotify(C.AndroidEvents.onDestroy)}function Yt(e){var t=R.getDisplayedAdDemandName();if(e)return(t?Be[e][t]:Be[e])||Re[e]}function Zt(e,t){var n=q[e];return n&&n.getConfirmCloseMsg&&n.getConfirmCloseMsg(t)||ce}var en=function(){ye=v("#ssaNavigatorCloseButton"),Ce=v("#ssaDialogBox"),De=v("#ssaDialogConfirmBtn"),Ie=v("#ssaDialogCancelBtn"),be=v("#ssaViewWrap"),It()},tn=function(){return!0},nn=function(e){q.log(e,q.LogLevels.error)},rn=function(e){var t,n={};return J.isString(e)?(t=e.split(/\?(.+)/),n.name=t[0],n.parameters=e.split(/parameters=(.+)/)[1],n):null},an=function(){return pe.mobileSDKSettings.deviceOs===m.deviceOs.android?"supersonicads":"SSAPublisher"},on=function(t){v.each(pe.applicationSettings,function(e){e.match(/^custom/)&&-1===v.inArray(e,t)&&delete pe.applicationSettings[e]})},sn=function(){var t={};return v.each(pe.applicationSettings,function(e){e.match(/^custom/)&&(t[e]=pe.applicationSettings[e])}),t},dn=function(e){var t=pe.mobileSDKSettings.protocol+"//"+pe.mobileSDKSettings.domain+"/l/?type={{logType}}&count={{count}}&applicationKey={{applicationKey}}&applicationUserId={{applicationUserId}}&SDKVersion={{SDKVersion}}&deviceOs={{deviceOs}}&deviceOSVersion={{deviceOSVersion}}&{{customQueryString}}",n=new Image,i={},r={logType:"",count:1,applicationKey:pe.applicationSettings.applicationKey,applicationUserId:pe.applicationSettings.applicationUserId,SDKVersion:pe.mobileSDKSettings.SDKVersion,deviceOs:pe.mobileSDKSettings.deviceOs,deviceOSVersion:pe.mobileSDKSettings.deviceOSVersion,customQueryString:""};e=v.extend({"deviceIds[OpenUDID]":pe.mobileSDKSettings["deviceIds[OpenUDID]"],"deviceIds[IFA]":pe.mobileSDKSettings["deviceIds[IFA]"],"deviceIds[IDFV]":pe.mobileSDKSettings["deviceIds[IDFV]"],"deviceIds[SERIAL]":pe.mobileSDKSettings["deviceIds[SERIAL]"],"deviceIds[AndroidID]":pe.mobileSDKSettings["deviceIds[AndroidID]"],"deviceIds[IMEI]":pe.mobileSDKSettings["deviceIds[IMEI]"]},r,e),v.each(e,function(e,t){J.isDefined(r[e])||(i[e]=t)}),v.isEmptyObject(i)||(e.customQueryString+=J.serialize(i)),n.src=J.renderTemplate(t,e)},ln=function(e){var n="";return J.isDefined(e)||(e=pe),v.each(e,function(e,t){return!e.match(/^deviceIds/)||!J.isDefined(t)||null===t||(n=t,!1)}),n},cn=function(){var e=pe.mobileSDKSettings;if(e.deviceScreenScale)try{var t=parseInt(e["deviceScreenSize[width]"])/(e.deviceOs!==m.deviceOs.ios?e.deviceScreenScale:1),n=parseInt(e["deviceScreenSize[height]"])/(e.deviceOs!==m.deviceOs.ios?e.deviceScreenScale:1);e.deviceHeightDP=parseInt(n),e.deviceWidthDP=parseInt(t)}catch(e){q.log("SDKController | Failed to parse screen DP",q.LogLevels.error)}},un=function(){var t=new v.Deferred,n=!1,i=pe.mobileSDKSettings;return si()?t.resolve():q.CampaignsFilter.checkIfAppInstallOnDevice(["com.google.market","com.android.vending"]).then(function(e){v.each(e,function(e,t){t.isInstalled&&(n=!0)}),i.gpi=n,t.resolve()},function(){i.gpi=n,t.reject("Unable to check if Google play services is installed on the device")}),t.promise()},fn=function(){var e,t,i,r=[],a=new v.Deferred;return e=z.subscribe(te+".parseDeviceStatus",function(e,t){z.clearHandlers(r),q.log(h+"parseDeviceStatus received");var n=o(e.appOrientation);n.patch&&(Ae.trackEvent(nt.patchOrientation,{},{generalMessage:decodeURIComponent(e.appOrientation)}),e.appOrientation=n.appOrientation),(i=M.parseConfiguration(e,ue,pe.mobileSDKSettings)).didSucceed?(q.callSDKFunction(t),V.init(pe.controllerConfig.appOrientation,pe.mobileSDKSettings),pe.mobileSDKSettings.appOrientation=V.getOrientation(),pe.mobileSDKSettings.displaySizeWidth=pe.mobileSDKSettings["deviceScreenSize[width]"],pe.mobileSDKSettings.displaySizeHeight=pe.mobileSDKSettings["deviceScreenSize[height]"],cn(),W=D.create(pe.mobileSDKSettings),q.AdvertisingIdService.decideOnAdvertisingId(pe.mobileSDKSettings,pe.controllerConfig),a.resolve()):a.reject(i.errMsg)}),r.push(e),t=z.subscribe(te+".getDeviceStatusFailed",function(e){z.clearHandlers(r),nn(e),a.reject(oe.device)}),r.push(t),q.callSDKFunction("getDeviceStatus",{},"parseDeviceStatus","getDeviceStatusFailed"),a.promise()},gn=function(){pe.mobileSDKSettings.deviceOs!==m.deviceOs.ios&&q.callSDKFunction("setStoreSearchKeys",{searchKeys:Ee[pe.mobileSDKSettings.deviceOs]})},pn=function(e){return J.isDefined(pe[e])&&null!==pe[e]||J.isDefined(pe.applicationSettings[e])&&null!==pe.applicationSettings[e]||J.isDefined(pe.mobileSDKSettings[e])&&null!==pe.mobileSDKSettings[e]||J.isDefined(pe.controllerConfig[e])&&null!==pe.controllerConfig[e]||J.isDefined(pe.configMapping[e])&&null!==pe.configMapping[e]()},vn=function(e){return J.isDefined(ve[e])},mn=function(e){var t;return J.isDefined(pe[e])?t=pe[e]:J.isDefined(pe.applicationSettings[e])?t=pe.applicationSettings[e]:J.isDefined(pe.mobileSDKSettings[e])?t=pe.mobileSDKSettings[e]:J.isDefined(pe.controllerConfig[e])?t=pe.controllerConfig[e]:J.isDefined(pe.configMapping[e])?t=pe.configMapping[e]():"customParam"===e&&(t=sn()),t},hn=function(){var e,t,n=[],o=new v.Deferred;return e=z.subscribe(te+".parseCachedFilesMap",function(e,t){var n,i,r,a={};(r=rt(["path"],e,"parseCachedFileMap")).didSucceed?(n=decodeURIComponent(e.path).split("/"),""!==e.path?a[i=n[n.length-1]]=J.isDefined(e[i])?e[i]:e:a=e,q.log("SDKController | successfully received files map:"+JSON.stringify(e),q.LogLevels.info),delete e.path,Dn(a).then(function(e){q.log("SDKController | Finished purging cache on controller init, calling init with sorted:"+JSON.stringify(Q.cachePriorityArray),q.LogLevels.verbose),q.log("SDKController | The file map after:"+JSON.stringify(e),q.LogLevels.verbose);var t=q.Cache.init(e,Q.cachePriorityArray);return q.AdsAssetsManager.init(q.Cache,pe.controllerConfig.cacheConfig),t}).then(function(){q.log("SDKController | Cache module initiated",q.LogLevels.info),q.callSDKFunction(t),o.resolve()}).fail(function(e){e="SDKController | Cache module failed to initiated",q.log(e,q.LogLevels.error),o.reject(e)})):o.reject(r.errMsg)}),n.push(e),t=z.subscribe(te+".getCachedFilesMapFailed",function(e){q.log("SDKController | failed to receive files map:"+e,q.LogLevels.error),o.reject(oe.filemap)}),n.push(t),q.callSDKFunction("getCachedFilesMap",{path:""},"parseCachedFilesMap","getCachedFilesMapFailed"),o.promise()},bn=function(t,n,i){n=n||{preloadNextInBG:!0},E.unloadAdView(t),$.removeAdById(q.AdUtils.getAdId(t),t);var r=Wn(t),a=!1;r&&p.Utils.isFunction(r.prepareAdToEngageEnd)&&r.prepareAdToEngageEnd(t).then(function(){a=r.getNextAd(!n.preloadNextInBG,t.inventoryId)}),q.log("engageEnd on controller with :"+t.engaged,q.LogLevels.verbose),p.PubSub.publish("SDKController.engageEnd",[t,function(){t.engaged&&E.unloadProductFromContainer(t);var e=!n.preloadNextInBG;r&&p.Utils.isFunction(r.attemptToPreloadAd)&&a&&r.attemptToPreloadAd(e,t.inventoryId),i&&i(),_.getState()===se.play&&_.handleOnEngageEnd(t)}])},Sn=function(){var e=Ue.controller;return pe.mobileSDKSettings.deviceOs===m.deviceOs.android&&10==M.getDeviceApiLevel()&&(e=Ue.device),e},yn=function(e){return An(e),Cn(e),e&&e.applicationKey&&(pe.applicationSettings.applicationKey=e.applicationKey),M.parseConfiguration(e,fe,pe.applicationSettings)},An=function(e){var t,n=ge.length;for(t=0;t<n;t++)J.isDefined(e[ge[t]])||(pe.applicationSettings[ge[t]]=null)},Cn=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&t.match(/^custom/)&&n.push(t);on(n)};function Dn(a){var e,r,t,o=[],n=new v.Deferred,s=[],d=["temp","files","assets","libs","graphicAssets"],i=function(){var t=new v.Deferred,n=0;function i(){var e;(e=new v.Deferred,0<s.length&&v.each(s,function(e,t){Q.cachePriorityArray&&Q.cachePriorityArray[t]&&delete Q.cachePriorityArray[t],delete a[t]}),"0"!==Q.controllerVersion?(Q.controllerVersion=pe.v,q.setGlobalAppData(Q).then(function(){e.resolve()},function(){e.reject("NewController: Save app global data failed")})):e.resolve(),e.promise()).then(function(){t.resolve(a)},function(e){t.reject(e)}),z.clearHandlers(o)}return e=z.subscribe(te+".deleteFolderSuccess",function(){q.log("NewController: A new controller version detected. Folder deleted successfully",q.LogLevels.verbose),++n>=s.length&&i()}),r=z.subscribe(te+".deleteFolderFailed",function(e){if(z.clearHandlers(o),p.Utils.isDefined(e.errCode)&&1==e.errCode)q.log("NewController: The folder requested for deletion was not found. Continue...",q.LogLevels.verbose),++n>=s.length&&i();else{z.clearHandlers(o),t.reject("NewController: Purge cache for new controller version failed.")}}),function(){var e=m.cacheAdsDirectory,t="purgeCampaignsCache",n="purgeGlobalsCache",i=pe.mobileSDKSettings;if(i.hasOwnProperty(t)&&!1===i[t])for(var r in a)r!==e&&-1===r.indexOf("RewardedVideo")&&-1===r.indexOf("Interstitial")||d.push(r);i.hasOwnProperty(n)&&!1===i[n]&&d.push("globals")}(),o.push(e),o.push(r),v.each(a,function(e,t){-1===d.indexOf(e)&&s.push(e)}),q.log(s+JSON.stringify(s),q.LogLevels.verbose),0<s.length?v.each(s,function(e,t){q.deleteFolder(t)}):i(),t.promise()};return q.getGlobalAppData().then(function(e){q.log("SDKController | getGlobalAppData: "+JSON.stringify(e),q.LogLevels.verbose),t=(Q=e).controllerVersion,J.isDefined(t)&&t!==pe.v||!J.isDefined(t)?(q.log("NewController: A new controller version detected. Purging cache... old: "+t+"new: "+pe.v,q.LogLevels.verbose),He=!0,i().then(function(e){n.resolve(e)},function(){n.reject()})):(q.log("NewController: Controller version did not change. Saved version: "+t+" Current version: "+pe.v,q.LogLevels.verbose),n.resolve(a))},function(){q.log("SDKController | getGlobalAppData: failed! ",q.LogLevels.verbose),n.reject("getGlobalAppData: failed! ")}),n.promise()}function In(t){return function(e){Ft({data:e,id:t},!0)}}function wn(){return pe.controllerConfig&&void 0!==pe.controllerConfig.abTest?pe.controllerConfig.abTest:-4}function Pn(e){_e||q.getApplicationInfo(e).then(null,function(){var e=v.Deferred();return e.resolve(q.getConfig()),e.promise()}).always(function(e){var t=Tn(e);tt.init(t),_e=!0})}function Tn(e){var t=-1;try{t=parseInt(M.getDeviceApiLevel())}catch(e){q.log("getEventicsBaseData | Error converting deviceApiLevel to Integer "+e,q.LogLevels.verbose)}return{sdkVersion:e.mobileSDKSettings.SDKVersion,controllerVersion:e.v,controllerbn:e.controllerbn,bundleId:e.mobileSDKSettings.bundleId,connectionType:e.mobileSDKSettings.connectionType,applicationKey:e.applicationSettings.applicationKey,deviceId:_n(e.mobileSDKSettings),applicationUserId:e.applicationSettings.applicationUserId,deviceOs:e.mobileSDKSettings.deviceOs,deviceOsVersion:M.getDeviceOsVersion(),deviceApiLevel:t,deviceOEM:e.mobileSDKSettings.deviceOEM,deviceModel:e.mobileSDKSettings.deviceModel,appOrientation:V.getOrientation(),env:bi.getEnv(),lat:"true"===e.mobileSDKSettings.isLimitAdTrackingEnabled,abTest:wn(),usertype:e.userType,platformABGroup:q.getSDKDataByKey(m.abTests.controllerConfigGroup),mediationType:e.controllerConfig.mediationType,appVersion:e.mobileSDKSettings.appVersion,SDKpluginType:e.applicationSettings.SDKPluginType}}function On(e,t){var n,i=[],r=new v.Deferred,a=t.length;for(n=0;n<a;n++)i.push(Fn(e,t[n]));return v.when.apply(null,i).always(function(){q.deleteFolder(e),r.resolve(0)}),r.promise()}function Fn(r,a){var o=new v.Deferred,e=function(e){var t={timingValue:(new Date).getTime()-void 0,success:e},n=t.success?nt.cdnABTestSuccess:nt.cdnABTestFail,i={eNameStart:nt.cdnABTestSuccess,timingValue:t.timingValue,rvnomoreoffersreason:r,generalMessage:a};Ae.trackTimingStop(n,i),o.resolve()};return Ae.trackTimingStart(nt.cdnABTestSuccess),q.cacheAsset(r,a).then(e.bind(null,!0),e.bind(null,!1)),o.promise()}function xn(){try{var e=je,n=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},t=(a=d.getExtConfig()).Interstitial&&a.Interstitial.abtest&&a.Interstitial.abtest[3e3]&&a.Interstitial.abtest[3e3].cdnPercent?a.Interstitial.abtest[3e3].cdnPercent:0;if(0<t&&n(0,100)<t&&pe&&pe.controllerConfig&&"CN"===pe.controllerConfig.country){var i=e.cdns,r=function(){if(0!==i.length){var e=n(0,i.length-1),t=i[e];i.splice(e,1),On(t.cdnName,t.assets).then(r)}};r()}}catch(e){q.log("_manageCdnABTest | catch: "+e,q.LogLevels.verbose),Ae.trackEvent(nt.cdnABTestException,null,{generalMessage:e})}var a}function Ln(i){var r=new v.Deferred,e=function(e){var t=e?nt.latencyTestSuccess:nt.latencyTestFail,n={eNameStart:nt.latencyTestSuccess,generalMessage:i.url};Ae.trackTimingStop(t,n),r.resolve()};return Ae.trackTimingStart(nt.latencyTestSuccess),v.ajax({url:i.url,type:i.method?i.method:"GET",cache:!0,timeout:6e4}).then(e.bind(null,!0),e.bind(null,!1)),r.promise()}function Nn(){try{var e=We,n=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},t=(a=d.getExtConfig()).Interstitial&&a.Interstitial.abtest&&a.Interstitial.abtest[5e3]&&a.Interstitial.abtest[5e3].latencyTestPercent?a.Interstitial.abtest[5e3].latencyTestPercent:0;if(0<t&&n(0,100)<t){var i=e,r=function(){if(0!==i.length){var e=n(0,i.length-1),t=i[e];i.splice(e,1),Ln(t).then(r)}};r()}}catch(e){q.log("_manageLatencyABTest | catch: "+e,q.LogLevels.verbose),Ae.trackEvent(nt.latencyTestException,null,{generalMessage:e})}var a;return p.Utils.returnResolvedPromise()}function Un(){if(X&&"rejected"!==X.state())return p.Utils.returnResolvedPromise();var e="prod"===q.getEnv()?qe:Qe,t=q.getBaseCdnUrl()+e;return X=v.ajax({url:t,type:"GET",dataType:"jsonp",cache:!0,jsonpCallback:"getExtConfig",timeout:2e4}).then(function(e,t,n){q.log(h+"MicroJob | Got Application configuration"),d.setConfig(e);var i=e&&e.general&&e.general.eventProb||0;ze=Je<i;var r=e&&e.general&&e.general.pullingDeviceDataInterval;q.DeviceDataService.startPullingDataWithInterval(r)},function(e,t,n){var i=h+"MicroJob | Failed to receive configuration from server "+n;q.log(i,q.LogLevels.verbose),Ae.trackEvent(nt.getExternalApplicationConfigurationError,{generalMessage:i})}).then(Nn).then(xn),p.Utils.returnResolvedPromise()}function Vn(t){var e="deviceVolumeSuccess";z.subscribe(te+"."+e,function(e){q.log("Device volume received: "+(e?JSON.stringify(e):"empty")),t&&e&&t.call(null,{deviceVolume:e.deviceVolume||"0"})}),q.callSDKFunction("getDeviceVolume",{},e,e)}function Mn(){var n,i,r=new v.Deferred;return n=z.subscribe(te+".getDebugParamsSuccess",function(e){q.log(h+"getDebugParamsSuccess "+JSON.stringify(e));try{var t={};pe.mobileSDKSettings.deviceOs===m.deviceOs.android?t=J.parseJSON(decodeURIComponent(e.SDK5DebugParams)):"object"==typeof e.SDK5DebugParams&&(t=e.SDK5DebugParams),r.resolve(t)}catch(e){q.log("getSDKDebugParams | getDebugParamsSuccess | parseJSONFailed |"+e,q.LogLevels.verbose),r.reject("failed to parse received SDK5 params")}z.clearHandlers([n,i])}),i=z.subscribe(te+".getDebugParamsFailed",function(e){var t="failed to get debug param";q.log("getSDKDebugParams | getDebugParamsFailed | "+t,q.LogLevels.verbose),r.reject(t),z.clearHandlers([n,i])}),q.callSDKFunction("getUserData",{key:"SDK5DebugParams"},"getDebugParamsSuccess","getDebugParamsFailed"),r.promise()}function En(t){var n=new v.Deferred;return Mn().then(function(e){return p.Utils.returnResolvedPromise(v.extend(t,e))}).always(function(e){n.resolve(e||t)}),n.promise()}function kn(e){var t="false";!0===e&&(t="true"),q.callSDKFunction("setAllowFileAccessFromFileURLs",{allowFileAccess:t})}function Kn(){return pe.mobileSDKSettings&&pe.mobileSDKSettings.bundleId&&-1!==m.testAppBundleIds.indexOf(pe.mobileSDKSettings.bundleId)}function Bn(e){q.log("setCloseButtonState params "+JSON.stringify(e),q.LogLevels.verbose),e&&e.state&&e.productType&&(e.demandSourceName?Be[e.productType][e.demandSourceName]=de[e.state]:Be[e.productType]=de[e.state])}function Rn(){if(!Ge){var e=q.getApiData(s.deviceDataRequestObject);e&&0<Object.keys(e).length&&(Ge={os:e.deviceOs,osv:e.deviceOSVersion,apilvl:M.getDeviceApiLevel(),sdkv:e.SDKVersion,webviewType:pe.mobileSDKSettings.webviewType})}return Ge||{}}function jn(){var e;return pe.controllerConfig&&!0===pe.controllerConfig.isSecured?e=m.protocol.https:pe.mobileSDKSettings.deviceOs===m.deviceOs.android?e=m.protocol.http:pe.mobileSDKSettings.deviceOs===m.deviceOs.ios&&(pe.mobileSDKSettings.deviceOSVersion&&0<=J.versionCompare(pe.mobileSDKSettings.deviceOSVersion,"10")?pe.mobileSDKSettings.allowArbitraryLoadsInWebContent?(e=m.protocol.http,H=!0):pe.mobileSDKSettings.allowArbitraryLoads?e=m.protocol.http:(e=m.protocol.https,H=!0):e=pe.mobileSDKSettings.allowArbitraryLoads?m.protocol.http:m.protocol.https),e}function Wn(e){if(e&&e.productType){var t=q[e.productType];return e.demandSourceName&&t&&(t=t[e.demandSourceName]),t}}function _n(e){return ci()?Gn(e):e["deviceIds[AID]"]}function Gn(e){return 0<=J.versionCompare(e.deviceOSVersion,"10")&&"true"===e.isLimitAdTrackingEnabled?e["deviceIds[IDFV]"]:e["deviceIds[IFA]"]}function Hn(){var e=q.Cache.getCacheByType({cacheBase:"assets"}),t=pe.mobileSDKSettings.jQueryUrls;e&&-1<q.Cache.getFileIndexInCache(e.cache,t[0])?q.log(h+"jQuery file already cache"):(q.log(h+"Start save jQuery to cache"),q.cacheAsset("assets",t).then(function(){q.log(h+"jQuery file saved successfully")},function(){q.log(h+"jQuery file cache failed")}))}function qn(){var e=pe.mobileSDKSettings.controllerPathFolder+pe.v,t=q.Cache.getCacheByType({cacheBase:e});t&&-1<q.Cache.getFileIndexInCache(t.cache,pe.mobileSDKSettings.controllerJSUrl)?q.log(h+"controller js file already cache"):Jn(e,pe.mobileSDKSettings.controllerJSUrl)}function Qn(){var e=pe.mobileSDKSettings.controllerPathFolder+pe.v,t=q.Cache.getCacheByType({cacheBase:e}),n=pe.mobileSDKSettings.rootPath+he,i=pe.mobileSDKSettings.cacheFolderPath+"/"+me;t&&-1<q.Cache.getFileIndexInCache(t.cache,n)?zn(i):Jn(e,n).then(function(){q.log("updateControllerCssToCache - cache css file succeeded",q.LogLevels.verbose),zn(i)},function(){q.log("updateControllerCssToCache - cache css file failed",q.LogLevels.verbose),zn(n)})}function Jn(e,t){return q.log(h+"Start saving file to cache, url: "+t),q.cacheAsset(e,t).then(function(){q.log(h+"File save success | "+t)},function(e){return q.log(h+"File save fail | "+t+" "+e),e})}function zn(e){var t=v("head");0<v("#ssaMobileControllerCss").length||t.prepend('<link rel="stylesheet" id="ssaMobileControllerCss" type="text/css" />'),v("#ssaMobileControllerCss").attr("href",e)}function Xn(){Hn(),qn(),Qn(),pe.mobileSDKSettings.deviceOs===m.deviceOs.android&&q.AndroidNomediaFileHandler.updateNomediaFileToCache()}function $n(e){if(!q.HTTPService.getIsNativeEngineExist())return!1;return q.HTTPService.GETRequest(e,{allowNative:!0,background:!0,retries:3}),!0}function Yn(e){q.PixelTrackingService.firePixel(e)}function Zn(e,t,n,i){var r,a,o=new v.Deferred,s=[];if(!J.isString(e)||!J.isString(t))return J.returnRejectedPromise("missing or corrupted params");r=z.subscribe(te+".postAdEventNotificationSuccess",function(e){q.log("postAdEventNotificationSuccess"+JSON.stringify(e)),z.clearHandlers(s),o.resolve()}),s.push(r),a=z.subscribe(te+".postAdEventNotificationFailed",function(e){var t=e.errMsg?e.errMsg:"unknown reason";q.log("error calling postAdEventNotificationFailed: "+t,q.LogLevels.error),z.clearHandlers(s),o.reject(t)}),s.push(a);var d={eventName:e,dsName:n,productType:t,extData:i||{}};return q.log("Controller - Notifies SDK on Event: "+d.eventName+" in Product: "+d.productType),q.callSDKFunction("postAdEventNotification",d,"postAdEventNotificationSuccess","postAdEventNotificationFailed"),o.promise()}function ei(e){var t,n=v("#ssaDialogBox");switch(e){case"template4":t={dialogText:{maxFontPixels:29,maxHeight:87,parentContainer:n},buttonText:{maxFontPixels:24,maxHeight:43,maxWidth:ti(e).maxDialogBtnTextWidth,parentContainer:De}};break;default:t={dialogText:{maxFontPixels:24,maxHeight:87,parentContainer:n},buttonText:{maxFontPixels:20,maxHeight:44,maxWidth:ti(e).maxDialogBtnTextWidth,parentContainer:De}}}return t}function ti(e){return m.templateStyle[e]?m.templateStyle[e]:m.templateStyle.defaultTemplate}function ni(){var n="",e=v("#ssaDialogBox"),t=e[0]&&e[0].classList;return v.each(t,function(e,t){t.match(/template.*/)&&(n=t)}),n}function ii(e,t,n,i){p.PubSub.publish(te+"."+e,[t,n,i])}function ri(){for(;0<nativeQueue.length;){var e=nativeQueue.shift();ii(e.name,e.parameters,e.successCallback,e.errorCallback)}}function ai(e){return q.SDKLimitations.getLimitData(e)}function oi(e){q.OMIDService.isSupported(e)&&q.OMIDService.init(N)}function si(){return q.CompatibilityService.isFeatureSupportedInNativeSDK(O.limitAppFiltering)||q.CompatibilityService.isFeatureSupportedInNativeSDK(O.noPackagesInstallationPolling)}function di(){q.SKOverlayManager.init(),li()}function li(){ci()&&q.callSDKFunction("toggleUDIA",{getByFlag:-1},"toggleUDIAStatusSuccess","toggleUDIAStatusFailed")}function ci(){return fi()===m.deviceOs.ios}function ui(){return fi()===m.deviceOs.android}function fi(){return pe.mobileSDKSettings.deviceOs}function gi(e){E.unloadAdView(e),vi(e)}function pi(t){var n=R.get();$.getAdsByProductType(t).forEach(function(e){e!==n&&q.OMIDService.finishSession(e).always(function(){gi(e),$.removeAdById(q.AdUtils.getAdId(e),t)})})}function vi(e){e.productType===m.BN&&q.callSDKFunction("cleanAdInstance",{demandSourceId:e.demandSourceId,productType:e.productType},"cleanAdInstanceSuccess","cleanAdInstanceFailure")}function mi(t){var e=R.get(),n=$.getAds(t);if(e){var i=E.getDisplayedAdView(e);q.log("Removing all current "+t.productType+" frames"),i&&i.hasClass&&i.hasClass(b.getAdUnitClassObj(t).class)&&R.isDisplayed()&&(it(),Kt())}n.forEach(E.unloadAdView),n.forEach(function(e){q.log("remove from load creative "+q.AdUtils.getAdId(e)),$.removeAdById(q.AdUtils.getAdId(e),t)})}function hi(e){if(e){q.getSegmentationAllocator().addControllerSourceSegment(e.controllerSourceStrategy);var t=e.controllerSourceCode;p.Utils.isDefined(t)&&tt.updateBaseData({controllerSource:t})}}window.onerror=function(e,t,n,i,r){try{if(!r||!r.message)return;var a={url:t,lineNo:n,colNo:i,error:r&&r.message.substring(0,500)||""};_e&&ze&&Ae.trackEvent(nt.controllerException,{generalMessage:e},{rvnomoreoffersreason:JSON.stringify(a)}),q.log(h+"onError handler. Exception:"+JSON.stringify(a))}catch(e){}};var bi={adUnitGlobals:r,libsManager:e,adUnitUrl:a,LogLevels:{none:0,error:1,info:2,verbose:3},featureMap:le,debugMsg:n.debugMsg,decideUrlProtocolAccordingToHTTPSCompliance:jn,blacklistService:l,jQuery:function(){return v},api:function(){return jn()+"//"+pe.mobileSDKSettings.domain},apiWithCdn:function(){return pe.mobileSDKSettings.protocol+"//"+pe.mobileSDKSettings.serviceCdn},getBaseCdnUrl:function(){return pe.mobileSDKSettings.protocol+"//"+pe.mobileSDKSettings.cdn},init:function(e,t){return q=this,v=window.jQuery,Y||(v.extend(pe.mobileSDKSettings,e.mobileSDKSettings),v.extend(pe.controllerConfig,e.controllerConfig),N=new(Si("../Environment/EnvironmentManager"))({controllerVersion:pe.mobileSDKSettings.controllerVersion,schema:pe.mobileSDKSettings.protocol,cdnDomain:pe.mobileSDKSettings.cdn,scdnDomain:pe.mobileSDKSettings.scdn,environment:pe.mobileSDKSettings.env,deviceOs:pe.mobileSDKSettings.deviceOs,cdnService:pe.mobileSDKSettings.serviceCdn,stagingCdnDomain:pe.mobileSDKSettings.domain,domain:pe.mobileSDKSettings.domain}),pe.mobileSDKSettings.overrideDebug&&(pe.mobileSDKSettings.debug=pe.mobileSDKSettings.defaultDebug),q.APIConfigurations.init(),M=new u(pe,v,p.Utils,m),V=q.AppOrientationManager,U=new f(n,m,V),$=new(Si("./LoadedCreatives"))(q),gt(t),pt(),dt(),at(),ut(),vt(),mt(),ot(),st(),hi(pe.controllerConfig.controllerSourceData),q.log(h+"Controller initiated"),G.setNativeConfiguration(A.native[pe.mobileSDKSettings.deviceOs]),oi(pe.controllerConfig),v.when(fn(),hn()).then(function(){r.setProtocol(jn()),window.queueValidMessages={},ri(),di()},function(e){try{Ae.trackEvent(nt.initFailed,{},{generalMessage:decodeURIComponent(e)})}catch(e){}q.callSDKFunction("initController",{stage:"failed",errMsg:e})}).then(Un).then(function(){v.when(Xn(),un()).always(function(){var e={};si()||(e.gpi=pe.mobileSDKSettings.gpi),j.updateToken(e)})}).fail(function(e){e?q.log(h+e):q.log(h+"failed promise on get app config")}),Y=!0),Y},getConfigurationHelper:function(){return M},getAPIRequiredData:function(){var e=q.APIConfigurations.getCommonRequiredData(),t=q.getApiData(e),n=new v.Deferred;return t&&t!=={}?p.Utils.isDefined(t.errMsg)?n.reject(t.errMsg):n.resolve(t):n.reject("Failed to get required parameters"),n.promise()},isIOS:ci,isAndroid:ui,getDeviceOs:fi,getApiData:function(e){var t,n={};for(t in e)if(e.hasOwnProperty(t)){if(1===e[t]&&!pn(t)&&!vn(t)){n={errMsg:oe.missing+t};break}pn(t)?n[t]=mn(t):"customParams"===t?v.extend(n,sn()):vn(t)&&(n[t]=ve[t]())}return n},getSDKDataByKey:function(e){return mn(e)},isAppsInstalledInfoRestricted:si,runFunction:function(e,t,n){var i=rn(e);if(queueValidMessages[i.name])nativeCommunicator.runFunction(e,t,n);else{if("acknowledgeMessage"!==i.name||!window.shouldReportReady){var r,a=!0;r=J.parseJSON(i.parameters);try{J.isDefined(i.name)&&ii(i.name,r,t,n)}catch(e){q.log("error running function:"+i.name+", error:"+e,q.LogLevels.error),a=!1}return a}nativeCommunicator.runFunction(e,t,n)}},callSDKFunction:function(e,t,n,i){L.callSDKFunction(e,t,n,i)},callSDKFunctionWithCallback:function(e,t,n,i){L.callSDKFunctionWithCallback(e,t,n,i)},callSDKService:function(e,t,n,i,r){L.callSDKService(e,t,n,i,r)},getApplicationInfo:function(r,e){var n,i,a=v.Deferred(),o=function(e,t){z.clearHandlers([n,i]),e?a.resolve(pe):a.reject(oe.appInfo,t)};if(n=z.subscribe(te+".parseApplicationInfo",function(e,t,n){var i;J.isDefined(e.productType)&&e.productType!==r.productType&&e.demandSourceName!==r.demandSourceName?q.log(h+"parseApplicationInfo | info sent for the wrong product"):(q.log(h+"parseApplicationInfo: "+JSON.stringify(e)),delete e.productType,delete e.demandSourceName,(i=yn(e)).didSucceed?(J.isDefined(t)&&q.callSDKFunction(t),o(!0)):(J.isDefined(n)&&q.callSDKFunction(n,{errMsg:i.errMsg}),o(!1,i.errMsg)))}),i=z.subscribe(te+".getApplicationInfoFailed",function(e){nn(e),o(!1,"Failed retrieving application info")}),J.isDefined(e)&&e){var t=yn(e);t.didSucceed?o(!0):(q.log(t.errMsg,q.LogLevels.error),o(!1,t.errMsg))}else q.callSDKFunction("getApplicationInfo",r,"parseApplicationInfo","getApplicationInfoFailed");return a.promise()},setCloseButtonState:Bn,getEnv:function(){m.environment.production;return pe.mobileSDKSettings.debug&&0<parseInt(pe.mobileSDKSettings.debug)&&pe.mobileSDKSettings.domain!==m.domainUrls.prod?pe.mobileSDKSettings.domain===m.domainUrls.local?m.environment.develop:m.environment.stage:m.environment.production},getProtocol:function(){return pe.mobileSDKSettings.protocol},isLegacy:function(e){var t=-1;try{var n="android"===pe.mobileSDKSettings.deviceOs?e.android:e.ios;t=J.versionCompare(pe.mobileSDKSettings.SDKVersion,n)}catch(e){q.log(e,q.LogLevels.error)}return t<0},cacheAdUnitAssets:function(t,e){var n,i=e.assets,r=e.lastUpdateTime,a=i.length,o=new v.Deferred,s=[],d=0;for(0===a&&o.resolve(0),n=0;n<a;n++)s.push(q.cacheAsset(t,i[n],r));return v.when.apply(null,s).always(function(){var e=arguments;for(n in e)q.log(h+"path: "+t+" res: "+e[n],3),e[n]&&d++;o.resolve(d)}),o.promise()},cacheAsset:function(t,n,e,i){var r,a,o,s=[],d=new v.Deferred;if(J.isString(n)&&(n=[n]),"device"===pe.applicationSettings.preCache){var l,c={path:J.isString(t)?t:t.toString(),overrideExistingFile:i},u=-1,f=function(e){d.reject(e),z.clearHandlers(s)},g=function(e){++u>=n.length?f(e||"Index error in array assets url"):(l=n[u],c.file=H?J.changeUrlProtocol(l,m.protocol.https):l,q.log(h+"saveFile | "+c.file+" path: "+decodeURIComponent(c.path)),q.callSDKFunction("saveFile",c,"preCacheFileSuccess","preCacheFileFailed"))};J.isDefined(e)&&(c.lastUpdateTime=e.toString()),r=z.subscribe(te+".assetCached",function(e){if(!rt(["path","file"],e,"preCacheFileSuccess").didSucceed)return q.log("error calling assetCached "+JSON.stringify(e),q.LogLevels.error),void f("error calling assetCached");decodeURIComponent(e.path)===t&&l.match(e.file)&&(z.clearHandlers(s),q.log(h+"saveFile | success: "+decodeURIComponent(e.path)+"/"+e.file),d.resolve(!0))}),a=z.subscribe(te+".assetCachedFailed",function(e){decodeURIComponent(e.path)===t&&l.match(e.file)&&(q.log(h+"saveFile | fail "+decodeURIComponent(e.path)+"/"+e.file),g("failed saved file"))}),o=z.subscribe(te+".preCacheFileFailed",function(e){decodeURIComponent(e.path)===t&&l.match(e.file)&&(q.log(e.errMsg+": "+decodeURIComponent(e.path)+"/"+e.file,q.LogLevels.error),g(e.errMsg))}),s.push(r),s.push(a),s.push(o),g()}else d.resolve(!0);return d.promise()},deleteFolder:function(e){J.isString(e)||e.toString(),q.callSDKFunction("deleteFolder",{path:e},"deleteFolderSuccess","deleteFolderFailed")},deleteAsset:function(t,n){var e,i,r=new v.Deferred,a=[];return J.isString(t)||t.toString(),J.isString(n)||n.toString(),e=z.subscribe(te+".deleteFileSuccess",function(e){if(!rt(["path","file"],e,"deleteFileSuccess").didSucceed)return q.log("error calling deleteFileSuccess "+JSON.stringify(e),q.LogLevels.error),r.reject("failed to delete file: "+e.file),void z.clearHandlers(a);decodeURIComponent(e.path)===t&&n.match(e.file)&&(z.clearHandlers(a),q.log("successfully deleted file: "+decodeURIComponent(e.path)+"/"+e.file),r.resolve())}),a.push(e),i=z.subscribe(te+".deleteFileFailed",function(e){if(!rt(["path","file"],e,"deleteFileFailed").didSucceed)return q.log("error calling deleteFileFailed "+JSON.stringify(e),q.LogLevels.error),r.reject("failed to delete file: "+e.file),void z.clearHandlers(a);decodeURIComponent(e.path)===t&&n.match(e.file)&&(z.clearHandlers(a),q.log("failed to delete file: "+e.file),r.reject("failed to delete file: "+e.file))}),a.push(i),q.callSDKFunction("deleteFile",{path:t,file:n},"deleteFileSuccess","deleteFileFailed"),r.promise()},setBackButtonState:function(e){var t=e?Sn():Ue.none;q.callSDKFunction("setBackButtonState",{state:t})},addAdToLoadedCreatives:function(e){return $.addAd(e)},isContainerLoaded:function(e){return E.isContainerLoaded(e)},getContainerCreationHandler:function(e){return E.getContainerCreationHandler(e)},loadAdUnitUrl:function(e,t,n,i){E.createAndLoadView(e,t,n,i),$.addAd(e)},displayAdView:function(e){E.displayAdView(e,Nt,Ut,Vt)},updateAdUnitUrl:function(e,t,n,i){E.updateFrameUrl(e,t,n,i),$.addAd(e)},onAdLoaded:function(e){q.log(h+"onAdLoaded | "+JSON.stringify(e));var t=function(){q.log(h+"ad loaded mismatch",q.LogLevels.error),Te<Oe&&(z.publish("SDKController.AdLoadError",[e]),Te++)};if(e&&e.productType)if($.getAdById(q.AdUtils.getAdId(e),e))Jt(e);else{var n={eventParam:{eName:nt.mismatchAdLoadError},action:"fireEvent",productType:e.productType};e.demandSourceName&&(n.demandSourceName=e.demandSourceName),z.publish("SDKController.Analytics",[n]),q.log(h+"onAdLoaded | mismatch from not being in loadedcreatives"),t()}else t()},removeAdUnit:function(e){if(R.isAdDisplayed(e)){var t=Wn(e);xt();var n=!(!t||!J.isFunction(t.getNextAd))&&t.getNextAd(!0,e.inventoryId);Kt(!1,n)}else{var i=$.getAdById(q.AdUtils.getAdId(e),e);i.engaged=!1,bn(i,{preloadNextInBG:!0})}},removeAdUnitFromExternal:function(e){$.removeAdById(q.AdUtils.getAdId(e),e),p.PubSub.publish("SDKController.engageEnd",[e])},unloadAdViewsByProduct:mi,unloadAdViewsByProductExceptDisplayedView:pi,isRootFolder:function(e){return ci()?"SSAPublisher"===e:"supersonicads"===e},getCurrentDisplayedAd:function(){return R.get()},setCurrentDisplayedAd:function(e){return R.set(e)},getCurrentDisplayedAdType:function(){return R.getDisplayedAdType()},isAdDisplayed:function(e){return R.isAdDisplayed(e)},getGlobalAppData:function(){var t,n,i,r,a=new v.Deferred;return t=z.subscribe(te+".parseGlobalData",function(e){if(r="string"==typeof e.ssaGlobalAppData?J.parseJSON(decodeURIComponent(e.ssaGlobalAppData)):e.ssaGlobalAppData,q.log("Full global app data is: "+JSON.stringify(r)),!r)return a.reject("Invalid Global Data response"),void z.clearHandlers([t,n]);a.resolve(r),z.clearHandlers([t,n])}),n=z.subscribe(te+".getGlobalDataFailed",function(e){i=rt(["errMsg"],e,"getGlobalDataFailed").didSucceed?e.errMsg:rt(["errMsg"],e,"getGlobalDataFailed").errMsg,a.reject(i),z.clearHandlers([t,n])}),q.callSDKFunction("getUserData",{key:"ssaGlobalAppData"},"parseGlobalData","getGlobalDataFailed"),a.promise()},setCachePriorityArrayKey:function(t,n){return n?q.getGlobalAppData().then(function(e){return e.cachePriorityArray=e.cachePriorityArray||{},e.cachePriorityArray[t.cacheBase]=n,q.setGlobalAppData(e)}):p.Utils.returnResolvedPromise()},setGlobalAppData:function(e){var t,n,i,r=new v.Deferred;return t=z.subscribe(te+".setGlobalDataSuccess",function(){r.resolve(),z.clearHandlers([t,n])}),n=z.subscribe(te+".setGlobalDataFailed",function(e){i=rt(["errMsg"],e,"setGlobalDataFailed").didSucceed?e.errMsg:rt(["errMsg"],e,"setGlobalDataFailed").errMsg,r.reject(i),z.clearHandlers([t,n])}),q.callSDKFunction("setUserData",{key:"ssaGlobalAppData",value:JSON.stringify(e)},"setGlobalDataSuccess","setGlobalDataFailed"),r.promise()},getUserData:function(t,n){var i,r,a,o,s=new v.Deferred;return J.isDefined(n)&&!J.isDefined(t)?s.reject("Missing info to retrieve user data."):(i=z.subscribe(te+".parseUserData",function(e){return rt(["ssaUserData"],e,"parseUserData").didSucceed?(o="string"==typeof e.ssaUserData?J.parseJSON(decodeURIComponent(e.ssaUserData)):e.ssaUserData,q.log("Full user data is: "+JSON.stringify(o)),o?(J.isDefined(t)&&(o=o[t]||{},J.isDefined(n)&&(o=o[n]||{})),q.log("Get user data response: "+JSON.stringify(o)+" for appKey "+t+" and userId "+n),s.resolve(o)):s.reject("Invalid User Data response"),void z.clearHandlers([i,r])):(a=rt(["errMsg"],e,"parseUserData").errMsg,s.reject(a),void z.clearHandlers([i,r]))}),r=z.subscribe(te+".getUserDataFailed",function(e){a=rt(["errMsg"],e,"getUserDataFailed").didSucceed?e.errMsg:rt(["errMsg"],e,"getUserDataFailed").errMsg,s.reject(a),z.clearHandlers([i,r])}),q.callSDKFunction("getUserData",{key:"ssaUserData"},"parseUserData","getUserDataFailed")),s.promise()},setUserData:function(t,n,i){var r,a,o,s,d=new v.Deferred;return J.isDefined(t)&&J.isDefined(n)?v.when(q.getUserData()).then(function(e){s=e,J.isDefined(s[t])||(s[t]={}),J.isDefined(s[t][n])||(s[t][n]={}),i==={}?s[t][n]={}:v.extend(s[t][n],i),r=z.subscribe(te+".setUserDataSuccess",function(){d.resolve(),z.clearHandlers([r,a])}),a=z.subscribe(te+".setUserDataFailed",function(e){o=rt(["errMsg"],e,"setUserDataFailed").didSucceed?e.errMsg:rt(["errMsg"],e,"setUserDataFailed").errMsg,d.reject(o),z.clearHandlers([r,a])}),q.callSDKFunction("setUserData",{key:"ssaUserData",value:JSON.stringify(s)},"setUserDataSuccess","setUserDataFailed")},function(e){d.reject(e)}):d.reject("Missing info to set user data."),d.promise()},getConfig:function(){return pe},getApplicationExternalConfig:function(){return d},isSupportedOsVersion:function(e){return null===M.getDeviceApiLevel().match(Me[e][pe.mobileSDKSettings.deviceOs])},isLimitedDeviceModel:function(){if(!pe.controllerConfig||-1===m.applicationsLimitations.indexOf(pe.controllerConfig.applicationKey))return!1;var e=decodeURIComponent(pe.mobileSDKSettings.deviceModel);return-1!==m.deviceLimitations.indexOf(e)},checkRequiredCallbackParams:function(e,t,n,i){return rt(e,t,n,i)},alert:function(e){var t,n=v("#ssaDialogText"),i=v(".dialogBox"),r=ni(),a=ei(r),o=ti(r),s=!1,d=v("#ssaDialogConfirmBtnText"),l=v("#ssaDialogCancelBtnText"),c=v("#ssaDialogBtns");Ft({name:"dialogBoxAboutToOpen"}),i.removeAttr("style"),i.css("display","block"),(!we||e&&e.alwaysClose)&&(E.hideLoader(),At(),s=!0),we||E.displayContainer(e);var u=b.getDisplayedAdFrame();if(u&&p.Msg.postMessage("hideFrame","*",u[0].contentWindow),c.removeClass("singleBtn"),"object"==typeof e&&(Ie.removeClass("hidden").removeAttr("style"),De.removeClass("hidden").removeAttr("style"),J.isDefined(e.close)?(t=e.close,d.text(e.yes),l.text(e.no),De.textWidth()>o.minDialogBtnWidth||Ie.textWidth()>o.minDialogBtnWidth?(Ie.css({width:o.maxDialogBtnWidth+"px",left:"20px"}),De.css({width:o.maxDialogBtnWidth+"px",right:"20px"})):(Ie.css({width:o.baseDialogBtnWidth+"px",left:"55px"}),De.css({width:o.baseDialogBtnWidth+"px",right:"55px"})),(De.textWidth()>o.maxDialogBtnTextWidth||Ie.textWidth()>o.maxDialogBtnTextWidth||-1!==v.inArray(" ",e.yes)||-1!==v.inArray(" ",e.no))&&(d.textfill2(a.buttonText),a.buttonText.parentContainer=Ie,l.textfill2(a.buttonText))):J.isDefined(e.message)?(t=e.message,J.isDefined(e.yes)&&d.text(e.yes),J.isDefined(e.no)&&l.text(e.no)):t=JSON.stringify(e),s&&(c.addClass("singleBtn"),Ie.addClass("hidden"),De[0]))){var f=De[0].offsetWidth/2;De.css("margin-left",-1*f+"px")}n.text(t),n.textfill2(a.dialogText),i.css("visibility","visible");var g=v("#ssaDialogBoxOverlay");g.fadeIn(100),g.bind("click",function(e){e.preventDefault()}),Ce.fadeIn(300)},log:n.log,logEvent:function(e,t){dn(e)},openUrl:function(e,t){Dt(e,t)},postAdUnitEvent:function(e,t){Ft(e,t)},initEventics:Pn,initBannerExternalService:function(){K.init(),B.init()},getFormattedDeviceData:Rn,shouldExtendApiDataWithDebugData:Kn,extendApiDataWithDebugParams:En,getSDKDebugParams:Mn,getNotchService:function(){return W},getTokenService:function(){return j},setAllowFileAccessFromFileURLs:kn,getDeviceId:function(){return _n(q.getConfig().mobileSDKSettings)},getSDKLimitationData:ai,addExternalAdViewIdAndSetStatus:function(e){K.addExternalAdViewIdAndSetStatus(e)},getExternalContainer:function(){return K},getAdViewContainer:function(e){return E.getAdViewByAd(e)},onAdVisible:Et,saveFileToCache:Jn,getSegmentationAllocator:function(){return x},environmentConfiguration:function(){return N},getLoadedCreatives:function(){return $},isBannerNoneLWS:Tt,isBannerAndLoadWhileShowSupported:function(e){return e===m.BN&&q.CompatibilityService.isFeatureSupportedInNativeSDK(O.bannerMultipleInstances)}};return q=bi,bi}e.exports=function(e){var t=Si("../../components/Constants.js"),n=Si("../Cache.js"),i=Si("../OfferWall/OfferWall.js"),r=Si("../BannerFactory.js"),a=Si("../../components/HTTPService.js"),o=Si("../../components/AdUtils"),s=Si("../../components/DemandUtils.js"),d=Si("../../components/SupplyConfigurations.js"),l=Si("../../components/storeKit/StoreKitService.js"),c=Si("../../components/ViewsManager.js"),u=Si("../../components/PixelTrackingService.js"),f=Si("../../components/OpenURLService.js"),g=Si("../../components/OMIDService.js"),p=Si("../../components/DeviceDataService.js"),v=Si("../../components/RingerSwitchService.js"),m=Si("../../components/OrientationService.js"),h=Si("../../components/GDPRservice.js"),b=Si("../../components/orientation/AppOrientationManager.js"),S=Si("../../components/PermissionService"),y=Si("./SDKLimitations"),A=Si("../../components/APIConfigurations.js"),C=Si("../../components/NativeLifeCycleEventsService.js"),D=Si("../../components/LastSeenCampaignService"),I=Si("../../components/AndroidNomediaFileHandler.js"),w=Si("../../components/ImpressionsCounterService.js"),P=Si("../DemandSource/FetchDemand/FetchDirect"),T=Si("../../components/ExtraOffers"),O=Si("../../components/CampaignsFilter.js"),F=Si("../../components/AdvertisingIdService.js"),x=Si("../../components/SKAdImpression/SKAdImpressionService"),L=Si("../../components/FeatureCompatibilityService"),N=Si("../Cache/AdsAssetsNativeCommunicator.js"),U=Si("../Cache/AdsAssetsManager.js"),V=Si("../../components/SKOverlay/SKOverlayManager.js"),M=Si("../../components/SKOverlay/SKOverlayEventDispatcher"),E=Si("../../components/AppUserIdService.js"),k=Si("./InstancesTimers.js"),K=Si("../../components/EventsManager"),B=new R(e,window.jQuery,t);return B.Cache=new n(e,B),B.SDKLimitations=new y(B),B.OfferWall=new i(e,B),B.BannerFactory=new r(e,B),B.HTTPService=new a(e,B),B.AdUtils=new o(e,B,window.jQuery),B.DemandUtils=new s(e,B,t),B.SupplyConfigurations=new d(B,t,window.jQuery),B.StoreKitService=new l(e,B,t),B.ViewsManager=new c(e),B.PixelTrackingService=new u(B),B.OpenURLService=new f(B),B.OMIDService=new g(e,B,window.jQuery),B.DeviceDataService=new p(e,B),B.RingerSwitchService=new v(e,B),B.OrientationService=new m(e,B,t),B.GDPRService=new h(e,B,t),B.AppOrientationManager=new b(e,B,t),B.PermissionService=new S(e,B),B.APIConfigurations=new A(B),B.NativeLifeCycleEventsService=new C(e,B,t),B.LastSeenCampaignService=new D(B,t),B.AndroidNomediaFileHandler=new I(B),B.ImpressionsCounterService=new w(t),B.FetchDirectService=new P(window.jQuery.ajax),B.ExtraOffers=new T(t,B.FetchDirectService,B.environmentConfiguration),B.CampaignsFilter=new O(e,B,t),B.AdvertisingIdService=new F(e,B,t),B.SKAdImpressionService=new x(e,B,t),B.CompatibilityService=new L(SuperSonicGlobalConfig.controllerConfig),B.AdsAssetsNativeCommunicator=new N(e,B),B.AdsAssetsManager=new U(e,B,B.AdsAssetsNativeCommunicator),B.SKOverlayManager=new V(e,B,t),B.SKOverlayEventDispatcher=new M(e,B,t),B.AppUserIdService=new E(e,B,t),B.InstancesTimers=new k,B.EventsManager=new K(B),B}},{"../../components/APIConfigurations.js":1,"../../components/AdOrientationManager":3,"../../components/AdUtils":4,"../../components/AdvertisingIdService.js":5,"../../components/AndroidNomediaFileHandler.js":8,"../../components/AppUserIdService.js":10,"../../components/BlacklistService":11,"../../components/CampaignsFilter.js":12,"../../components/Constants.js":13,"../../components/DemandUtils.js":14,"../../components/DeviceDataService.js":16,"../../components/DisplayedAdManager.js":17,"../../components/EventsManager":18,"../../components/ExternalConfig":19,"../../components/ExtraOffers":20,"../../components/FeatureCompatibilityService":21,"../../components/FrameHelper.js":25,"../../components/GDPRservice.js":27,"../../components/HTTPService.js":28,"../../components/IframeManager":29,"../../components/ImpressionsCounterService.js":30,"../../components/LastSeenCampaignService":32,"../../components/Logger.js":33,"../../components/NativeAPIAdapter.js":36,"../../components/NativeLifeCycleEventsConstants.js":37,"../../components/NativeLifeCycleEventsService.js":38,"../../components/NotchFactory.js":39,"../../components/OMIDService.js":42,"../../components/OpenURLService.js":46,"../../components/OrientationService.js":48,"../../components/PermissionService":50,"../../components/PixelTrackingService.js":52,"../../components/RingerSwitchService.js":55,"../../components/SKAdImpression/SKAdImpressionService":56,"../../components/SKOverlay/SKOverlayEventDispatcher":59,"../../components/SKOverlay/SKOverlayManager.js":60,"../../components/SupplyConfigurations.js":61,"../../components/ViewsManager.js":64,"../../components/containers/AdViewsManager.js":66,"../../components/containers/BackgroundController":67,"../../components/containers/BannerExternalAdViewService":68,"../../components/containers/BannerExternalContainer.js":69,"../../components/containers/NavigationModeView":75,"../../components/containers/WPADUtils":76,"../../components/containers/WebView":77,"../../components/containers/WebViewManager.js":78,"../../components/orientation/AppOrientationManager.js":80,"../../components/storeKit/StoreKitService.js":88,"../../components/token/TokenService.js":90,"../../constants/SDKFeatureNames":91,"../../modules/SDKController/EventCategories":142,"../../patches/PatchAppOrientation":166,"../../presenter/uiConfig.js":171,"../AdUnitManager/AdUnitGlobals.js":96,"../AdUnitManager/LibsManager.js":99,"../AdUnitUrl.js":100,"../BannerFactory.js":103,"../Cache.js":104,"../Cache/AdsAssetsManager.js":106,"../Cache/AdsAssetsNativeCommunicator.js":107,"../DemandSource/FetchDemand/FetchDirect":117,"../Environment/EnvironmentManager":124,"../OfferWall/OfferWall.js":131,"../ProductRouter.js":136,"../SDKInterface.js":154,"../UserSegmentation/SegmentationAllocator.js":156,"../UserSegmentation/SegmentationManager":158,"./ConfigurationHelper.js":141,"./InstancesTimers.js":143,"./LoadedCreatives":144,"./MessageHandler":146,"./SDKLimitations":148,"./mainConfig.js":150,"./nativeConfigHandler.js":151,"./sessionConfig":152,"./videoStateHandler.js":153}],148:[function(e,t,n){t.exports=function(n){var i=" is not supported";return{getLimitData:function(e){var t={errMsg:"",didSucceed:!0};return n.isSupportedOsVersion(e)?n.isLimitedDeviceModel()&&(t.errMsg="Device"+i,t.didSucceed=!1):(t.errMsg="Operating system version "+n.getApiData({deviceOSVersion:1}).deviceOSVersion+i,t.didSucceed=!1),t}}}},{}],149:[function(e,t,n){t.exports=function(s,t,d){var l={v:function(e){return e.match(/^[0-9]+?[.]?[0-9]+?[.]?[0-9]+$/)},appOrientation:function(e){var t=e;return"portrait"===(t=t.toLowerCase())||"landscape"===t||"none"===t},connectionType:function(e){var t=decodeURIComponent(e);return"wifi"===(t=t.toLowerCase())||t.match(/^mobile\[.+\]$/)||"3g"===t||"none"===t},iphoneAppOnIpadDevice:function(e){var t=parseInt(e);return 0===t||1===t},deviceOs:function(e){return e&&""!==e},SDKVersion:function(e){return e&&""!==e},deviceOSVersion:function(e){return e&&""!==e},deviceApiLevel:function(e){return e&&""!==e},bundleId:function(e){return e&&""!==e},"deviceIds[OpenUDID]":function(e){return s.isDefined(e)},"deviceIds[IFA]":function(e){return s.isDefined(e)},"deviceIds[SERIAL]":function(e){return s.isDefined(e)},"deviceIds[AndroidID]":function(e){return s.isDefined(e)},"deviceIds[IMEI]":function(e){return s.isDefined(e)},"deviceIds[AID]":function(e){return s.isDefined(e)},deviceScreenScale:function(){return!0},"deviceScreenSize[width]":function(){return!0},"deviceScreenSize[height]":function(){return!0},diskFreeSize:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},showDeliveryLimitationsLog:function(){return!0},country:function(e){return e&&""!==e},debug:function(e){return s.isDefined(t[e])},disableCache:function(e){var t=parseInt(e);return 0===t||1===t},disableSession:function(e){var t=parseInt(e);return 0===t||1===t},applicationKey:function(e){return e&&""!==e},applicationUserId:function(e){return e&&""!==e},applicationUserGender:function(e){return"unknown"===e||"female"===e||"females"===e||"male"===e||"males"===e||"both"===e},applicationUserAgeGroup:function(e){var t=parseInt(e);return 0<=t&&t<=9},applicationUserCreationDate:function(e){return e.match(/^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$/)},maxVideoLength:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},itemCount:function(e){var t=parseInt(e);return!isNaN(t)&&0<t},minimumOfferCommission:function(e){var t=parseFloat(e);return!isNaN(t)&&0<=t},demoCampaigns:function(e){var t=parseInt(e);return 0===t||1===t},numOfCampaigns:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},campaignId:function(e){var t=parseInt(e);return!isNaN(t)&&0<t},pageSize:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},landingId:function(e){var t=parseInt(e);return!isNaN(t)&&0<t},page:function(e){var t=parseInt(e);return!isNaN(t)&&0<t},admin:function(e){var t=parseInt(e);return 0===t||1===t},useClientSideCallbacks:function(e){var t=e.toString();return"true"===t||"false"===t},unLocked:function(e){var t=e.toString();return"true"===t||"false"===t},isLimitAdTrackingEnabled:function(e){return s.isDefined(e)},placementId:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},allowArbitraryLoads:function(e){var t=e.toString();return"true"===t||"false"===t},allowArbitraryLoadsInWebContent:function(e){var t=e.toString();return"true"===t||"false"===t}};return function(e,t){var n,i,r,a=!0,o=null;for(n in e){if(s.isDefined(l[n])&&!1===l[n](e[n])){o=d.invalid+n,a=!1;break}r=e[i=n],t[i]=r}return{didSucceed:a,errMsg:o}}}},{}],150:[function(e,t,n){t.exports=function(){return{deviceDataRequestObject:{deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceApiLevel:0}}}},{}],151:[function(i,e,t){function n(e,t){var n=i("../../components/Constants.js");return e.subscribe(n.CB+".nativeConfigSuccess",function(e){t.log("nativeConfig update successfully.",t.LogLevels.error)}),e.subscribe(n.CB+".nativeConfigFailed",function(e){t.log("nativeConfig failed to update.",t.LogLevels.error)}),{setNativeConfiguration:function(e){e&&t.callSDKFunction("setNativeConfiguration",e,"nativeConfigSuccess","nativeConfigFailed")}}}var r;e.exports=function(e,t){return r||(r=new n(e,t)),r}},{"../../components/Constants.js":13}],152:[function(e,t,n){t.exports=function(){return{native:{ios:{supportViewControllerFromAdapter:!0,allowOrientationFromAppDelegate:!0}}}}},{}],153:[function(o,e,t){function n(e,t){var n=o("../../components/Constants.js"),i=n.videoStates,r=n.RV,a=i.none;return e.subscribe("SDKController.AdStarted",function(){t.log("VideoStateHandler | AdStarted",t.LogLevels.verbose),a=i.play,t.callSDKFunction("onVideoStatusChanged",{status:"started",productType:r})}),e.subscribe("SDKController.AdPlaying",function(){t.log("VideoStateHandler | AdPlaying",t.LogLevels.verbose),a=i.play,t.callSDKFunction("onVideoStatusChanged",{status:"playing",productType:r})}),e.subscribe("SDKController.AdPaused",function(){t.log("VideoStateHandler | AdPaused",t.LogLevels.verbose),a=i.stop,t.callSDKFunction("onVideoStatusChanged",{status:"paused",productType:r})}),e.subscribe("SDKController.AdVideoEnded",function(){t.log("VideoStateHandler | AdVideoEnded",t.LogLevels.verbose),a=i.stop,t.callSDKFunction("onVideoStatusChanged",{status:"ended",productType:r})}),{handleOnEngageEnd:function(){t.log("VideoStateHandler | handleOnEngageEnd onVideoStatusChanged stopped from engaged end",t.LogLevels.verbose),a=i.none,t.callSDKFunction("onVideoStatusChanged",{status:"stopped",productType:r})},getState:function(){return a}}}var i;e.exports=function(e,t){return i||(i=new n(e,t)),i}},{"../../components/Constants.js":13}],154:[function(e,t,n){var o=e("./iOSSDKInterface.js"),s=e("./iOSSDKInterface_WK.js"),d=e("./androidSDKInterface.js");t.exports=function(e,t,n,i){"use strict";var r,a="undefined";switch(e.deviceOs){case t.deviceOs.android:r=new d(i,n,a);break;case t.deviceOs.ios:r="wk"===e.webviewType?new s(a):new o(a);break;default:r=new o(a)}return r}},{"./androidSDKInterface.js":162,"./iOSSDKInterface.js":163,"./iOSSDKInterface_WK.js":164}],155:[function(p,e,t){function v(i){var r,a,o={},s={},n=!1,d=function(t,e){var n=null;o=r.Utils,(s=r.PubSub).init(),o.isDefined(t.mobileSDKSettings)&&(n=(a=r.SDKController).init(t,e)),i.when(n).then(function(){t.products&&i.each(t.products,function(e){o.isDefined(e.init)&&e.init(t[e])})},function(){console.log("Failed to initiate controller")})},e={init:function(e,t){return r=this,d(e,t),n=!0},log:function(e,t){a&&a.log&&a.log(e,t||a.LogLevels.error)}};return e}e.exports=function(e,t,n,i){var r=p("../components/Utils.js"),a=p("../components/PubSub.js"),o=p("../components/Msg.js"),s=p("./AdAssets.js"),d=p("./VastUtils.js"),l=t.Eventics,c=new v(e),u={};c.Utils=new r(c,t,n,i),c.PubSub=new a(c),c.Msg=new o,c.AdAssets=new s,c.VastUtils=new d(c.AdAssets);var f,g=["KuduEventicsProvider"];return f=t.productionDebug||t.SuperSonicGlobalConfig&&t.SuperSonicGlobalConfig.mobileSDKSettings&&"www.supersonicads.com"!==t.SuperSonicGlobalConfig.mobileSDKSettings.domain?(g.push("QAEventicsProvider"),1):Math.random(),t.SuperSonicGlobalConfig&&t.SuperSonicGlobalConfig.mobileSDKSettings&&t.SuperSonicGlobalConfig.mobileSDKSettings.protocol&&(u.isSecured="https:"===t.SuperSonicGlobalConfig.mobileSDKSettings.protocol),c.Eventics=l(f),c.Eventics.setProvidersHandlers(g),c.Eventics.setProvidersConfig(u),c.PubSub.subscribe("updateEventsBaseData",function(e){e&&"object"!=typeof e||c.Eventics.updateBaseData(e)}),c}},{"../components/Msg.js":34,"../components/PubSub.js":53,"../components/Utils.js":62,"./AdAssets.js":93,"./VastUtils.js":160}],156:[function(e,t,n){t.exports=function(n){var i=e("./SegmentsRepository");function r(e,t){n.addSegment(e,t)}return{addCellularNetworkTypeSegment:function(e){var t,n=i.cellularNetworkType;-1===e?t=n.cellularNetworkTypeUnknown:"notReachable"===e?t=n.cellularNetworkTypeNotReachable:"wifi"===e?t=n.cellularNetworkTypeWifi:-1!==["CTRadioAccessTechnologyGPRS","CTRadioAccessTechnologyEdge","CTRadioAccessTechnologyCDMA1x"].indexOf(e)?t=n.cellularNetworkType2G:-1!==["CTRadioAccessTechnologyWCDMA","CTRadioAccessTechnologyHSDPA","CTRadioAccessTechnologyHSUPA","CTRadioAccessTechnologyCDMAEVDORev0","CTRadioAccessTechnologyCDMAEVDORevA","CTRadioAccessTechnologyCDMAEVDORevB","CTRadioAccessTechnologyeHRPD"].indexOf(e)?t=n.cellularNetworkType3G:"CTRadioAccessTechnologyLTE"===e&&(t=n.cellularNetworkType4G),r(t,n)},addIsSDCardAvailableSegment:function(e){var t,n=i.isSDCardAvailable;-1===e?t=n.isSDCardAvailableUnknown:"true"===e?t=n.isSDCardAvailableTrue:"false"===e&&(t=n.isSDCardAvailableFalse),r(t,n)},addTotalDeviceRAMSegment:function(e){var t=i.totalDeviceRAM,n=-1===e?e:parseInt(e)/1073741824;r(-1===e?t.totalDeviceRAMUnknown:n<1?t.totalDeviceRAMUnder1GB:n<2?t.totalDeviceRAMUnder2GB:n<3?t.totalDeviceRAMUnder3GB:n<4?t.totalDeviceRAMUnder4GB:n<6?t.totalDeviceRAMUnder6GB:n<8?t.totalDeviceRAMUnder8GB:n<12?t.totalDeviceRAMUnder12GB:t.totalDeviceRAM12GBAndAbove,t)},addIsChargingSegment:function(e){var t,n=i.isCharging;-1===e?t=n.isChargingUnknown:"true"===e?t=n.isChargingTrue:"false"===e&&(t=n.isChargingFalse),r(t,n)},addAirplaneModeSegment:function(e){var t,n=i.airplaneMode;-1===e?t=n.airplaneModeUnknown:"true"===e?t=n.airplaneModeTrue:"false"===e&&(t=n.airplaneModeFalse),r(t,n)},addChargingTypeSegment:function(e){var t=i.chargingType;r(-1===e?t.chargingTypeUnknown:"1"===e?t.chargingTypeAC:"2"===e?t.chargingTypeUSB:"4"===e?t.chargingTypeWireless:t.chargingTypeNone,t)},addStayOnWhenPluggedInSegment:function(e){var t,n=i.stayOnWhenPluggedIn;-1===e?t=n.stayOnWhenPluggedInUnknown:"true"===e?t=n.stayOnWhenPluggedInTrue:"false"===e&&(t=n.stayOnWhenPluggedInFalse),r(t,n)},addBatteryLevelSegment:function(e){var t,n=i.batteryLevel;void 0===e||e<0||(e<=20?t=n.batteryLowestFifth:e<=40?t=n.batterySecondFifth:e<=60?t=n.batteryThirdFifth:e<=80?t=n.batteryFourthFifth:e<=100&&(t=n.batteryHighestFifth)),r(t,n)},addAdLevelCacheSegment:function(e){r(e,i.adLevelCache)},addControllerSourceSegment:function(e){var t=i.controllerSourceStrategy;switch(e){case 0:r(t.fetchFromServerNoFallback,t);break;case 1:r(t.fetchFromServerWithLocalFallback,t);break;case 2:r(t.fetchForNextSessionLoadFromLocal,t)}}}}},{"./SegmentsRepository":159}],157:[function(e,t,n){t.exports={events:{receivedFromAdunit:{addSegment:"SDKController.addSegment",getSegments:"SDKController.getSegments",clearSegmentFromGroup:"SDKController.clearSegmentFromGroup"},sendToAdunit:{updateUserSegments:"updateUserSegments"}}}},{}],158:[function(d,e,t){e.exports=function(e,n){var i="SegmentationManager | ",t=d("./SegmentationConstants"),r=d("./SegmentsRepository"),l=[];function a(e,t){(function(e,t){if(isNaN(e)||(r=e,-1!==l.indexOf(r))||(n=e,!c(i=t)||!function(e,t){for(var n=Object.keys(t),i=0;i<n.length;i++){var r=t[n[i]];if(e===r)return!0}return!1}(n,i)))return!1;for(var n,i,r,a=Object.keys(t),o=0;o<a.length;o++)for(var s=t[a[o]],d=0;d<l.length;d++)if(l[d]===s)return l[d]=e,!0;return l.push(e),!0})(e,t)&&s()}function c(e){return e&&"object"==typeof e}function o(e){if(c(e))for(var t=Object.keys(e),n=0;n<l.length;n++)for(var i=0;i<t.length;i++){var r=e[t[i]];if(l[n]===r)return l.splice(n,1),void s()}}function s(){e.PubSub.publish("updateEventsBaseData",[{segments:l.toString()}]),n.postAdUnitEvent({name:t.events.sendToAdunit.updateUserSegments,segments:l},!0)}return{init:function(){e.PubSub.subscribe(t.events.receivedFromAdunit.addSegment,function(e){a(e.segment,e.segmentGroup)}),e.PubSub.subscribe(t.events.receivedFromAdunit.getSegments,function(e){if(n.log(i+" controller - getSegments received"),e.getSegmentsCallback){var t=e.getSegmentsCallback;n.log(i+"send back to adunit "+t+" with data: "+JSON.stringify(l)),n.postAdUnitEvent({name:t,segments:l},!0)}}),e.PubSub.subscribe(t.events.receivedFromAdunit.clearSegmentFromGroup,function(e){o(e.segmentGroup)})},addSegment:a,getUserSegmentsObjectsAsArray:function(){return l},clearSegmentFromGroup:o,segmentsRepository:r}}},{"./SegmentationConstants":157,"./SegmentsRepository":159}],159:[function(e,t,n){t.exports={batteryLevel:{batteryLowestFifth:101,batterySecondFifth:102,batteryThirdFifth:103,batteryFourthFifth:104,batteryHighestFifth:105},cellularNetworkType:{cellularNetworkTypeWifi:117,cellularNetworkType2G:118,cellularNetworkType3G:119,cellularNetworkType4G:120,cellularNetworkTypeNotReachable:121,cellularNetworkTypeUnknown:122},isCharging:{isChargingTrue:123,isChargingFalse:124,isChargingUnknown:125},airplaneMode:{airplaneModeTrue:126,airplaneModeFalse:127,airplaneModeUnknown:128},stayOnWhenPluggedIn:{stayOnWhenPluggedInTrue:129,stayOnWhenPluggedInFalse:130,stayOnWhenPluggedInUnknown:131},chargingType:{chargingTypeAC:132,chargingTypeUSB:133,chargingTypeWireless:134,chargingTypeNone:135,chargingTypeUnknown:136},totalDeviceRAM:{totalDeviceRAMUnder1GB:137,totalDeviceRAMUnder2GB:138,totalDeviceRAMUnder3GB:139,totalDeviceRAMUnder4GB:140,totalDeviceRAMUnder6GB:141,totalDeviceRAMUnder8GB:142,totalDeviceRAMUnder12GB:143,totalDeviceRAM12GBAndAbove:144,totalDeviceRAMUnknown:145},isSDCardAvailable:{isSDCardAvailableTrue:146,isSDCardAvailableFalse:147,isSDCardAvailableUnknown:148},adLevelCache:{adLevelCacheTimeoutControl:154,adLevelCacheTimeoutFiveMinutes:155,adLevelCacheTimeoutThirtySeconds:156},controllerSourceStrategy:{fetchFromServerNoFallback:151,fetchFromServerWithLocalFallback:152,fetchForNextSessionLoadFromLocal:153}}},{}],160:[function(e,t,n){t.exports=function(t){function n(e){if(e)return!e.controllerSpace||e.controllerSpace.viewCount}function i(e,t){return e&&(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=t),e}function r(e){return!!e&&(0<t.extractVastSource(e).length||e.ext&&e.ext.videoData&&!0===e.ext.videoData.isVast)}return{getVastViewCount:n,setVastViewCount:i,setMaxVastCount:function(e){e&&r(e)&&"number"==typeof e.ext.vastExhaustIndex&&0<e.ext.vastExhaustIndex&&i(e,e.ext.vastExhaustIndex)},isVastCampaign:r,isThereVastCampaign:function(e){if(!e||!jQuery.isArray(e))return!1;for(var t=!1,n=0;n<e.length;n++)if(r(e[n])){t=!0;break}return t},areAllCampaignTypesAreVast:function(e){if(!e||!jQuery.isArray(e)||0===e.length)return!1;for(var t=!0,n=0;n<e.length;n++)if(!r(e[n])){t=!1;break}return t},incrementVastViewCount:function(e){return e&&r(e)?(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=e.controllerSpace.viewCount?e.controllerSpace.viewCount+1:1,e.controllerSpace.viewCount):-1},isVastCanPlayAgain:function(e){return!!e&&r(e)&&e.ext.vastExhaustIndex&&n(e)<e.ext.vastExhaustIndex},getVastViewCountForEvent:function(e){return"number"==typeof e?e:-1}}}},{}],161:[function(r,e,t){(function(e){"use strict";var t=r("./SonicCore.js"),n=r("./SDKController/SDKController.js");var i=e.SonicCore=e.SSA_CORE=new t(e.jQuery,e,document,"undefined");i.SDKController=new n(i,"undefined"),"function"==typeof sonicAsyncInit&&sonicAsyncInit()})(window)},{"./SDKController/SDKController.js":147,"./SonicCore.js":155}],162:[function(e,t,n){function i(i,n,t){function r(e,t){var n=i.hashMessage(e,t);Android.messageHandler(e,JSON.stringify(t),n)}function a(e,t){Android[e](JSON.stringify(t))}function o(e,t){return void 0!==e&&e[t]}var s={postMessage:function(t,e){if(o(window.Android,i?"messageHandler":t))try{i?r(t,e):a(t,e)}catch(e){n.log("Error running function "+t+" error:"+JSON.stringify(e),n.LogLevels.error)}else n.log("Error calling SDK function "+t,n.LogLevels.error)}},e={postMessage:function(e){typeof e.eventName!==t&&typeof e.prefix!==t&&typeof e.parameters!==t&&("function"==typeof s[e.eventName]?s[e.eventName](e.parameters):s.postMessage(e.eventName,e.parameters))},acknowledgeMessage:function(){return!0}};return e}t.exports=i},{}],163:[function(e,t,n){function i(t){var i=function(e,t,n){var i,r=e+"://"+t+"?";jQuery.each(n,function(e,t){"object"==typeof t&&(n[e]=JSON.stringify(t))}),i=r+jQuery.param(n),a(i)},n=function(e){var t=document.createElement("IFRAME");t.setAttribute("src",e),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null},a=function(e){0===o.length?(o.push("1"),n(e)):o.push(e)},r={postMessage:function(e,t,n){i(e,t,n)}},o=[],e={postMessage:function(e){typeof e.eventName!==t&&typeof e.prefix!==t&&typeof e.parameters!==t&&("function"==typeof r[e.eventName]?r[e.eventName](e.parameters):r.postMessage(e.prefix,e.eventName,e.parameters))},acknowledgeMessage:function(){if(0!==o.length){var e=o.shift();"1"===e&&0!==o.length&&(e=o.shift()),void 0!==e&&"1"!==e&&n(e)}}};return e}t.exports=i},{}],164:[function(e,t,n){function i(t){var i=function(e,t,n){var i,r=e+"://"+t+"?";jQuery.each(n,function(e,t){"object"==typeof t&&(n[e]=JSON.stringify(t))}),i=r+jQuery.param(n),a(i)},n=function(e){void 0!==window.webkit.messageHandlers&&void 0!==window.webkit.messageHandlers.supersonicMainMsgHandler&&window.webkit.messageHandlers.supersonicMainMsgHandler.postMessage(e)},a=function(e){0===o.length?(o.push("1"),n(e)):o.push(e)},r={postMessage:function(e,t,n){i(e,t,n)}},o=[],e={postMessage:function(e){typeof e.eventName!==t&&typeof e.prefix!==t&&typeof e.parameters!==t&&("function"==typeof r[e.eventName]?r[e.eventName](e.parameters):r.postMessage(e.prefix,e.eventName,e.parameters))},acknowledgeMessage:function(){if(0!==o.length){var e=o.shift();"1"===e&&0!==o.length&&(e=o.shift()),void 0!==e&&"1"!==e&&n(e)}}};return e}t.exports=i},{}],165:[function(e,t,n){t.exports=function(n,t,i,r){var e=!1,a=!1,o=!1,s=!0,d=r.CB+".enterBackground",l=r.CB+".enterForeground",c=r.CB+".deviceStatusChanged",u="prdTaskManager | ";return{init:function(){e||(n.PubSub.subscribe(r.taskManager+".Engaged",function(e){n.Utils.isDefined(e.duringEngage)&&e.productType===i&&(a=e.duringEngage,t.log(u+"duringEngage "+a))}),n.PubSub.subscribe(d,function(){t.log(u+d),o=!0}),n.PubSub.subscribe(l,function(){t.log(u+l),o=!1}),n.PubSub.subscribe(c,function(e){n.Utils.isDefined(e.connectionType)&&(s="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),e=!0)},canEngage:function(){return!a&&s},isConnected:function(){return s},setConnection:function(e){s=e},canInitCallToApi:function(){var e=new jQuery.Deferred;return o?n.PubSub.subscribeOnce(l,function(){e.resolve()}):e.resolve(),e.promise()},getStatusMsg:function(){return"product TM - duringEngage:"+a+" appInBackground:"+o+" isConnected:"+s},getStatus:function(){return{duringEngage:a,appInBackground:o,isConnected:s}},publish:function(e,t){n.PubSub.publish(r.taskManager+"."+e,t)}}}},{}],166:[function(e,t,n){t.exports=function(e){return e&&"unknown"!==e?{appOrientation:e}:{appOrientation:"none",patch:!0}}},{}],167:[function(e,t,n){t.exports=function(t,n,i){var r="ios"===n.getConfig().mobileSDKSettings.deviceOs&&i;return r&&(n.log("PATCH | LoadAfterLoad | create listener for instance: "+JSON.stringify(i)),t.PubSub.subscribe("freeSDK5StateToAllowLoadAfterLoad",function(e){var t;t=e,n.log("PATCH | LoadAfterLoad | subscribe called for: "+JSON.stringify(i)+" , with params:"+JSON.stringify(t)),t&&i&&i.demandGroupName===t.demandGroupName&&i.productType===t.productType&&i.demandSourceName!==t.demandSourceName&&(n.log("PATCH | LoadAfterLoad | perform callSDKFunction with: "+JSON.stringify(e)),n.callSDKFunction("loadInterstitialFail",{demandSourceName:i.demandSourceName}))})),{onShowSuccess:function(e){r&&t.PubSub.publish("freeSDK5StateToAllowLoadAfterLoad",[{productType:e.productType,demandGroupName:e.demandGroupName,demandSourceName:e.demandSourceName}])}}}},{}],168:[function(e,t,n){t.exports=function(t,n){var i=e("../constants/SDKFeatureNames");return{shouldBlock:function(e){return(!n||!n.isFeatureSupportedInNativeSDK(i.storeKitDismissVCOnFinishCallback))&&0<=t.versionCompare(e,"13.2")}}}},{"../constants/SDKFeatureNames":91}],169:[function(e,t,n){t.exports=function(e,n,r){function i(){var e=decodeURIComponent(n.deviceModel);return-1!==r.iphoneXDeviceModels.indexOf(e)}function t(){var e=n.deviceWidthDP,t=n.deviceHeightDP;return i()&&function(e,t){var n=r.iphoneXDeviceResolution;for(var i in n)if(n.hasOwnProperty(i)&&n[i].width&&n[i].height&&(e===n[i].width&&t===n[i].height||e===n[i].height&&t===n[i].width))return!0;return!1}(e,t)}return{hasNotch:i,onEngageEnd:function(){t()},onSetConfig:function(e){return i()&&(t=e).settings&&t.settings.standaloneView;var t},className:"PatchesIphoneX"}}},{}],170:[function(e,t,n){t.exports=function(t){var n={android:/^\b[1][0-9]\b|\b[2][0]\b/,ios:/^[8|9]/},i=["6abeab6d","6863f09d","499b4845","4cbeec05","70fc4915"].concat(["6c982dc5","6c97f43d"]);return{shouldFail:function(e){return!(!e.controllerConfig||-1===i.indexOf(e.controllerConfig.applicationKey))&&null!==t.getDeviceApiLevel().match(n[e.mobileSDKSettings.deviceOs])}}}},{}],171:[function(e,t,n){t.exports={templates:{mainDefaultTemplate:'<div id="ssaLoaderWrap" class="hidden">                <div id="spin" class="container">                    <div class="spinner">                        <div class="bar1"></div>                        <div class="bar2"></div>                        <div class="bar3"></div>                        <div class="bar4"></div>                        <div class="bar5"></div>                        <div class="bar6"></div>                        <div class="bar7"></div>                        <div class="bar8"></div>                        <div class="bar9"></div>                        <div class="bar10"></div>                        <div class="bar11"></div>                        <div class="bar12"></div>                    </div>                </div>            </div>',defaultDialogBoxTemplate:'<div id="ssaDialogBoxOverlay"></div>            <div id="ssaDialogBox" class="dialogBox">            <div id="ssaDialogBoxTextContainer">            <div><p id="ssaDialogText">Are you sure you want to quit the offer?</p></div>            </div>        <footer id="ssaDialogBtns">            <a id="ssaDialogCancelBtn" class="dialogBtn"><span id="ssaDialogCancelBtnText">Cancel</span></a>            <a id="ssaDialogConfirmBtn1"" class="dialogBtn"><span id="ssaDialogConfirmBtnText">OK</span></a>        </footer>        </div>',defaultNavigationTemplate:'            <div id="ssaNavigator" class="defaultNavigation">                <ul class="ssaList">                    <li><div data-edge="top|left" id="ssaNavigatorBackButton" class="ssaNavigationBtn ssaControllerButton ssaBackButton"><div class="innerWrapper"></div></div></li>                    <li><div data-edge="top|right" id="ssaNavigatorCloseButton" class="ssaNavigationBtn ssaControllerButton ssaCloseButton"><div class="innerWrapper"></div></div></li>                </ul>            </div>',loaderOWTemplate:'<div class="loaderOW hidden">        <div class="header">        </div>        <div class="progressbarWrap">            <div class="progressbar"></div>        </div>        <div class="offers">        <div class="shine"></div>        </div>    </div>',loaderOWOfferTemplate:'<div class="offer">        <div class="offerWrap">        <div class="offerImg"></div>        <div class="offerDetails">        <div>        <span class="offerText">Loading Info...</span>        </div>        <div class="offerEarn">        <div class="badge"></div>        <div class="callToAction">Loading...</div>        </div>        </div>        <div class="offerBtn"></div>        </div>        </div>'},style:{forceCloseProperties:{androidNeutral:{width:25,height:25,position:"top-right"},androidInterstitial:{width:0,height:0,position:"top-right"},androidNavigation:{width:25,height:25,position:"top-right"},iosNeutral:{width:24,height:24,position:"top-right"},iosNavigation:{width:50,height:50,position:"top-right"},disable:{width:0,height:0,position:"top-right"}},backgroundColors:{transparent:"transparent",black:"#000000",darkGrey:"#1A1A1A",semiTransparent:"rgba(0,0,0,0.7)"},iconBGConfig:{},defaultControlFrames:[{width:28,height:28,position:"top-right"},{width:30,height:30,position:"top-left"}]},settings:{}}},{}]},{},[161]);
